"undefined"==typeof globalThis&&(window.globalThis=window);var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};
/*! @nrk/core-scroll v4.2.1 - Copyright (c) 2017-2021 NRK */function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function s(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function a(t,e,i){return(a=s()?Reflect.construct:function(t,e,i){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return i&&r(o,i.prototype),o}).apply(null,arguments)}function l(t){var e="function"==typeof Map?new Map:void 0;return(l=function(t){if(null===t||(i=t,-1===Function.toString.call(i).indexOf("[native code]")))return t;var i;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return a(t,arguments,o(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),r(n,t)})(t)}function c(t,e){if(e&&("object"==typeof e||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}var h="undefined"!=typeof window;h&&/(android)/i.test(navigator.userAgent),h&&/iPad|iPhone|iPod/.test(String(navigator.platform)),h||t.HTMLElement||(t.HTMLElement=function(){return function t(){i(this,t)}}());var d,u,f=(d="undefined"==typeof window?{}:window.Element.prototype,u=d.matches||d.msMatchesSelector||d.webkitMatchesSelector,d.closest?function(t,e){return t.closest(e)}:function(t,e){for(t.correspondingUseElement&&(t=t.correspondingUseElement);t;t=t.parentElement)if(u.call(t,e))return t;return null});function p(t,e){var i,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o="prevent_recursive_dispatch_maximum_callstack".concat(e);if(t[o])return!0;t[o]=!0,"function"==typeof window.CustomEvent?i=new window.CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n}):(i=document.createEvent("CustomEvent")).initCustomEvent(e,!0,!0,n);var r=t.dispatchEvent(i);return t[o]=null,r}function v(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;if(t){if(t.nodeType)return[t];if("string"==typeof t)return[].slice.call(e.querySelectorAll(t));if(t.length)return[].slice.call(t)}return[]}var g={},y={up:{y:-1,prop:"top"},down:{y:1,prop:"bottom"},left:{x:-1},right:{x:1}},m=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{window.addEventListener("test",null,{get passive(){t={passive:!0}}})}catch(t){}return t}(),b=h&&window.matchMedia&&window.matchMedia("(prefers-reduced-motion)").matches,w=h&&(window.requestAnimationFrame||window.setTimeout);function x(t){f(t.target,'[contenteditable="true"],input,select,textarea')||0===t.button&&(t.preventDefault(),g.pageX=t.pageX,g.pageY=t.pageY,g.diffSumX=0,g.diffSumY=0,g.animate=g.diffX=g.diffY=0,g.scrollX=this.scrollLeft,g.scrollY=this.scrollTop,g.target=this,document.body.style.cursor=this.style.cursor="-webkit-grabbing",document.body.style.cursor=this.style.cursor="grabbing",document.addEventListener("mousemove",E),document.addEventListener("mouseup",S))}function E(t){g.diffX=g.pageX-(g.pageX=t.pageX),g.diffY=g.pageY-(g.pageY=t.pageY),g.diffSumX+=g.diffX,g.diffSumY+=g.diffY,g.target.scrollLeft=g.scrollX+=g.diffX,g.target.scrollTop=g.scrollY+=g.diffY,Math.max(Math.abs(g.diffSumX),Math.abs(g.diffSumY))>10&&(g.target.style.pointerEvents="none")}function S(t){var e=Math.abs(g.diffX||g.diffY)>10?20:0;document.removeEventListener("mousemove",E),document.removeEventListener("mouseup",S),document.body.style.cursor="",e&&g.target.scroll({x:g.scrollX+g.diffX*e,y:g.scrollY+g.diffY*e}),g.target.style.pointerEvents="",g.target.style.cursor="-webkit-grab",g.target.style.cursor="grab",g.target=null}var L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}(L,l(HTMLElement));var a,h,d,u,E,S=(a=L,h=s(),function(){var t,e=o(a);if(h){var i=o(this).constructor;t=Reflect.construct(e,arguments,i)}else t=e.apply(this,arguments);return c(this,t)});function L(){return i(this,L),S.apply(this,arguments)}return d=L,(u=[{key:"connectedCallback",value:function(){var t,e,i,n,o=this;t=this.nodeName,e="\n      ".concat(this.nodeName,"{display:block}\n      ").concat(this.nodeName,"::-webkit-scrollbar{display:none}\n    "),i="style-".concat(t.toLowerCase()),n=e.replace(/\/\*[^!][^*]*\*\//g,"").replace(/\s*(^|[:;,{}]|$)\s*/g,"$1"),document.getElementById(i)||document.head.insertAdjacentHTML("afterbegin",'<style id="'.concat(i,'">').concat(n,"</style>")),this.style.overflow="scroll",this.style.webkitOverflowScrolling="touch";var r,s,a,l=this.offsetWidth-this.clientWidth,c=this.offsetHeight-this.clientHeight;this.style.marginRight="-".concat(l,"px"),this.style.marginBottom="-".concat(c,"px"),this.style.maxHeight="calc(100% + ".concat(c,"px)"),this._throttledEvent=(r=this.handleEvent.bind(this),s=500,function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];a||(a=setTimeout((function(){r.apply(this,e),a=null}),s))}),this.addEventListener("mousedown",this),this.addEventListener("wheel",this,m),this.addEventListener("scroll",this._throttledEvent,m),window.addEventListener("resize",this._throttledEvent,m),window.addEventListener("load",this),document.addEventListener("click",this),setTimeout((function(){return o.handleEvent()}))}},{key:"disconnectedCallback",value:function(){this._throttledEvent=null,this.removeEventListener("mousedown",this),this.removeEventListener("wheel",this,m),this.removeEventListener("scroll",this._throttledEvent,m),window.removeEventListener("resize",this._throttledEvent,m),window.removeEventListener("load",this),document.removeEventListener("click",this)}},{key:"handleEvent",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.parentNode&&!t.defaultPrevented)if("wheel"===t.type)g.animate=!1;else if("mousedown"===t.type)x.call(this,t);else if("click"===t.type){var e=this.id&&f(t.target,'[for="'.concat(this.id,'"],[data-for="').concat(this.id,'"]'));e&&p(this,"scroll.click",{move:e.value})&&this.scroll(e.value)}else{var i={up:Math.floor(this.scrollTop),right:Math.floor(this.scrollRight),down:Math.floor(this.scrollBottom),left:Math.floor(this.scrollLeft)},n=i.left||i.right||i.up||i.down?"grab":"";v(this.id&&'[for="'.concat(this.id,'"],[data-for="').concat(this.id,'"]')).forEach((function(t){return t.disabled=!i[t.value]})),p(this,"scroll.change"),t.type||(this.style.cursor="-webkit-".concat(n),this.style.cursor=n)}}},{key:"scroll",value:function(t){var i=this,n=function(t,i){var n="object"===e(i)?i:{move:i};if("number"!=typeof n.x&&(n.x=t.scrollLeft),"number"!=typeof n.y&&(n.y=t.scrollTop),n.move=y[n.move]){var o=n.move.x?"x":"y",r=n.move.x?"left":"top",s=t.getBoundingClientRect(),a=s[r]-t[n.move.x?"scrollLeft":"scrollTop"],l=s[r]+s[n.move.x?"width":"height"]*n.move[o];t.items.every((function(t){var e=t.getBoundingClientRect(),s=t.ownerDocument.defaultView.getComputedStyle(t)["margin-".concat(r)];return n[o]=e[r]-parseInt(s,10)-a,e[n.move.prop||i]<l}))}return{x:Math.max(0,Math.min(n.x,t.scrollWidth-t.clientWidth)),y:Math.max(0,Math.min(n.y,t.scrollHeight-t.clientHeight))}}(this,t),o=n.x,r=n.y,s=g.animate=Date.now().toString(36)+Math.random().toString(36).slice(2,5),a=this.friction,l=b?1:o-this.scrollLeft,c=b?1:r-this.scrollTop;!function t(){g.animate===s&&(Math.round(l)||Math.round(c))&&(i.scrollLeft=o-Math.round(l*=a),i.scrollTop=r-Math.round(c*=a),w(t))}()}},{key:"items",get:function(){return v(this.getAttribute("items")||this.children,this)},set:function(t){this.setAttribute("items",t||"")}},{key:"scrollRight",get:function(){return Math.max(0,this.scrollWidth-this.clientWidth-this.scrollLeft)}},{key:"scrollBottom",get:function(){return Math.max(0,this.scrollHeight-this.clientHeight-this.scrollTop)}},{key:"friction",get:function(){return Math.min(.99,this.getAttribute("friction"))||.8},set:function(t){this.setAttribute("friction",t)}}])&&n(d.prototype,u),E&&n(d,E),L}(),T=/^\s+|\s+$/g,k=/^[-+]0x[0-9a-f]+$/i,_=/^0b[01]+$/i,M=/^0o[0-7]+$/i,O=parseInt,A="object"==typeof t&&t&&t.Object===Object&&t,C="object"==typeof self&&self&&self.Object===Object&&self,P=A||C||Function("return this")(),j=Object.prototype.toString,N=Math.max,I=Math.min,W=function(){return P.Date.now()};function H(t,e,i){var n,o,r,s,a,l,c=0,h=!1,d=!1,u=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function f(e){var i=n,r=o;return n=o=void 0,c=e,s=t.apply(r,i)}function p(t){return c=t,a=setTimeout(g,e),h?f(t):s}function v(t){var i=t-l;return void 0===l||i>=e||i<0||d&&t-c>=r}function g(){var t=W();if(v(t))return y(t);a=setTimeout(g,function(t){var i=e-(t-l);return d?I(i,r-(t-c)):i}(t))}function y(t){return a=void 0,u&&n?f(t):(n=o=void 0,s)}function m(){var t=W(),i=v(t);if(n=arguments,o=this,l=t,i){if(void 0===a)return p(l);if(d)return a=setTimeout(g,e),f(l)}return void 0===a&&(a=setTimeout(g,e)),s}return e=X(e)||0,R(i)&&(h=!!i.leading,r=(d="maxWait"in i)?N(X(i.maxWait)||0,e):r,u="trailing"in i?!!i.trailing:u),m.cancel=function(){void 0!==a&&clearTimeout(a),c=0,n=l=o=a=void 0},m.flush=function(){return void 0===a?s:y(W())},m}function R(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function X(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||function(t){return!!t&&"object"==typeof t}(t)&&"[object Symbol]"==j.call(t)}(t))return NaN;if(R(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=R(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(T,"");var i=_.test(t);return i||M.test(t)?O(t.slice(2),i?2:8):k.test(t)?NaN:+t}var Y=function(t,e,i){var n=!0,o=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return R(i)&&(n="leading"in i?!!i.leading:n,o="trailing"in i?!!i.trailing:o),H(t,e,{leading:n,maxWait:e,trailing:o})};function V(){return(V=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t}).apply(this,arguments)}class B{constructor(t){this.initialTime=this.time=0,this.element=t,this.id=t.id,this.observer=new IntersectionObserver(this.onIntersection.bind(this),{root:null,threshold:0}),this.observer.observe(this.element)}onIntersection(t){var e=t[0];e.intersectionRatio>0&&(this.initialTime=this.time=performance.now(),this.observer.unobserve(e.target),this.sendEvent({eventAction:"inscreen-view",eventLabel:this.id,eventValue:Math.round(this.time)}))}onNavigation(t,e){if(this.initialTime&&(this.currentIndex=e||this.currentIndex,null!=t)){this.prevIndex=t;var i=performance.now(),n=Math.round(i-this.time);this.sendEvent({eventAction:"navigate",eventLabel:this.id+"-"+t,eventValue:n}),this.time=i}}sendEvent(t,e){void 0===e&&(e={});var{eventAction:i,eventCategory:n="nrk-explainer",eventLabel:o,eventValue:r}=t;globalThis.coreAnalytics&&globalThis.coreAnalytics("event",{ga:V({eventCategory:n,eventAction:i,eventLabel:o,eventValue:r},e)})}}class q extends HTMLElement{constructor(){super(),this.isReady=!1,this.isPreview=-1!==window.location.search.indexOf("sanity-preview")}static get observedAttributes(){return["index"]}connectedCallback(){this.isReady=!0,this.trackingAdapter=new B(this),this.coreScroll=this.querySelector("core-scroll"),this.cards=this.querySelectorAll(".explainer__card"),this.dots=this.querySelectorAll(".explainer__pagination-dot"),this.navButtons=this.querySelectorAll(".explainer__navigation-button"),this.pollButtons=this.querySelectorAll(".explainer__poll-button"),this.voteCount=this.querySelector(".explainer__vote-count"),this.srPaginationElement=this.querySelector(".explainer__pagination-sr"),this.appendInlineStyles=this.appendInlineStyles.bind(this),this.handleIOSScroll=this.handleIOSScroll.bind(this),this.handleNavigation=this.handleNavigation.bind(this),this.handlePagination=this.handlePagination.bind(this),this.onKeydown=this.onKeydown.bind(this),this.onPollClick=this.onPollClick.bind(this),this.onScroll=this.onScroll.bind(this),this.setViewportVariables=this.setViewportVariables.bind(this),this.setViewportVariables(),window.addEventListener("resize",Y(this.setViewportVariables,250,{leading:!1})),this.coreScroll.addEventListener("scroll",Y(this.onScroll,250,{leading:!1})),this.navButtons.forEach((t=>t.addEventListener("click",(()=>this.handleNavigation("right"===t.value))))),this.pollButtons.forEach((t=>t.addEventListener("click",this.onPollClick,{once:!0}))),document.addEventListener("keydown",this.onKeydown),this.hotkeyActions={37:()=>this.handleNavigation(!1),39:()=>this.handleNavigation(!0)}}async onPollClick(){if(!fetch)return setTimeout((()=>{this.classList.add("explainer--voted")}),250);try{var t=await fetch(window.explainer.config.server.apiOrigin+"/forklaringsmodul/api/vote",{method:"POST",mode:"cors",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({id:this.id,value:event.target.value})}),e=await t.json();e&&e.data&&this.updatePollPercentages(e.data),this.classList.add("explainer--voted")}catch(t){this.classList.add("explainer--voted")}}attributeChangedCallback(t,e,i){!1!==this.isReady&&e!==i&&(this.isPreview&&(this.cards=this.querySelectorAll(".explainer__card")),this.handlePagination(),this.trackingAdapter.onNavigation(e,i))}appendInlineStyles(){this.stickyTitleCard&&!this.hasAppendedStyles&&(this.hasAppendedStyles=!0,this.insertAdjacentHTML("beforeend",'<style id="'+this.id+'-styles">\n          .explainer[id="'+this.id+'"][index="'+(this.cards.length-1)+'"] .explainer__navigation-button[value="right"] {\n            display: none;\n            transform: scale(.5);\n            pointer-events: none;\n          }\n        </style>'))}handleIOSScroll(){var t=this.coreScroll.scrollLeft>=this.cardWidth;this.showFooter!==t&&(this.showFooter,this.footerElements=this.footerElements||this.querySelectorAll('.explainer__navigation-button[value="left"], .explainer__footer'),this.footerElements.forEach((e=>e[t?"removeAttribute":"setAttribute"]("hidden",""))))}handleNavigation(t){void 0===t&&(t=!1);var e=t?1:-1;this.stickyTitleCard&&e--;var i=this.cards[parseInt(this.index)+e];this.coreScroll.scroll({x:i?i.offsetLeft:t?this.coreScroll.scrollWidth:0})}handlePagination(){this.activeDot&&this.activeDot.classList.remove("explainer__pagination-dot--active"),this.activeDot=this.dots[parseInt(this.index,10)-1],this.activeDot&&this.activeDot.classList.add("explainer__pagination-dot--active"),this.srPaginationElement.innerHTML="Viser kort "+this.index+" av "+this.dots.length}onKeydown(t){var e=this.hotkeyActions[t.keyCode];if(e){var{top:i,height:n}=this.getBoundingClientRect();i<=(window.innerHeight||document.documentElement.clientHeight)&&i+n>=0&&e()}}onScroll(){this.isIOS&&!this.stickyTitleCard&&this.handleIOSScroll();for(var t=this.coreScroll.scrollLeft+this.scrollOffset,e=0;e<this.cards.length;e++)if(this.cards[e].offsetLeft>=t){this.index=e;break}}setViewportVariables(){this.updateWideExplainerClasses();var t=this.classList.contains("explainer--wide"),e=this.offsetWidth>=600;this.cardWidth=this.cards[0].offsetWidth,this.isIOS=/iPad|iPhone|iPod/.test(navigator.userAgent),this.stickyTitleCard=t&&e,this.scrollOffset=this.stickyTitleCard?this.offsetWidth/4:-Math.abs(this.offsetWidth/2),this.appendInlineStyles(),this.onScroll()}updateWideExplainerClasses(){var t=this.offsetWidth,e=t>=0,i=t>=600;this.classList.toggle("sm",e),this.classList.toggle("md",i),this.classList.toggle("explainer--wide",i)}updatePollPercentages(t){var e=Object.values(t).reduce(((t,e)=>t+e));if(!isNaN(e)){for(var i of Object.keys(t)){var n=this.querySelector(".explainer__bar-inner-"+i),o=this.querySelector(".explainer__bar-result-"+i);if(!isNaN(i)&&o&&n){var r=(t[i]||0)/e*100;o.innerHTML=r.toFixed(0)+"%",n.setAttribute("style","width: "+r+"%;")}}this.voteCount.innerHTML=e+" stemmer"}}get index(){return this.getAttribute("index")}set index(t){this.setAttribute("index",t)}}"undefined"==typeof globalThis&&(window.globalThis=window),function(){if(!globalThis.explainer||!globalThis.explainer.config){var t=document.getElementsByClassName("-explainer-config")[0];if(!t||!t.hasAttribute("data-config"))throw Error("explainer: no -explainer-config element with `data-config` found");var e=JSON.parse(t.getAttribute("data-config"));globalThis.explainer={config:e}}}(),window.customElements.get("core-scroll")||window.customElements.define("core-scroll",L),window.customElements.get("nrk-explainer")||window.customElements.define("nrk-explainer",q);
