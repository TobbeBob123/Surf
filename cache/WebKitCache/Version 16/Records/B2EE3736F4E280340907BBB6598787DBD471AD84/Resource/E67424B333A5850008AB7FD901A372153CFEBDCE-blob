"undefined"==typeof globalThis&&(window.globalThis=window);import{d as e,p as t,r as i,_ as n,g as a,a as r,b as s,c as o,e as l,f as u,A as c,P as d,h,i as g,j as p,C as v,k as f,l as m,W as y,m as b,L as T,n as k,E as S,o as E,v as P,q as C,s as I,t as w,u as R,w as A,x,y as D,z as L,B as _,D as M,F as N,T as O,G as U,S as B,H as F,I as V,J as W,K as H,M as j,R as q,N as G,O as K,Q as z,U as X,V as Y,X as Q,Y as $,Z as J,$ as Z,a0 as ee,a1 as te,a2 as ie,a3 as ne,a4 as ae,a5 as re,a6 as se,a7 as oe,a8 as le,a9 as ue,aa as ce,ab as de,ac as he,ad as ge,ae as pe,af as ve,ag as fe,ah as me,ai as ye,aj as be,ak as Te,al as ke,am as Se,an as Ee}from"./nrkno-player-define.mjs";var Pe={};Object.defineProperty(Pe,"__esModule",{value:!0});var Ce=e,Ie=t,we=i;class Re extends we.ReactiveElement{constructor(){super(...arguments),this.player=void 0,this.value=void 0}readyCallback(){this.player=Ce.getElementOfType(this),document.addEventListener("keydown",this)}disconnectedCallback(){document.removeEventListener("keydown",this),this.player=null}handleEvent(e){if(this.player.focusWithin&&!e.defaultPrevented){var t=e.which,i=e.metaKey||e.ctrlKey||e.altKey||e.shiftKey,n=e.target;switch(t){case 37:n&&"INPUT"===n.nodeName||(e.preventDefault(),this.emit(Ie.PlayerActions.SeekToRelativeTime,i?5*-this.player.seekableStep:-this.player.seekableStep));break;case 39:n&&"INPUT"===n.nodeName||(e.preventDefault(),this.emit(Ie.PlayerActions.SeekToRelativeTime,i?5*this.player.seekableStep:this.player.seekableStep))}if(!i)switch(t){case 13:case 32:"BUTTON"!==(null==n?void 0:n.nodeName)&&(e.preventDefault(),this.emit(Ie.PlayerActions.TogglePlay));break;case 75:e.preventDefault(),this.emit(Ie.PlayerActions.Play);break;case 74:e.preventDefault(),this.emit(Ie.PlayerActions.SeekToRelativeTime,-this.player.seekableStep);break;case 76:e.preventDefault(),this.emit(Ie.PlayerActions.SeekToRelativeTime,this.player.seekableStep);break;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:e.preventDefault(),this.emit(Ie.PlayerActions.SeekToPosition,(t-48)/10);break;case 36:e.preventDefault(),this.emit(Ie.PlayerActions.SeekToPosition,0);break;case 35:e.preventDefault(),this.emit(Ie.PlayerActions.SeekToPosition,1);break;case 38:n&&"INPUT"===n.nodeName||(e.preventDefault(),this.emit(Ie.PlayerActions.SetVolume,100*this.player.volume+10));break;case 40:n&&"INPUT"===n.nodeName||(e.preventDefault(),this.emit(Ie.PlayerActions.SetVolume,100*this.player.volume-10));break;case 70:break;case 77:e.preventDefault(),this.emit(Ie.PlayerActions.ToggleMute)}}}emit(e,t){this.value=t,this.setAttribute("action",e),this.dispatchEvent(new Event("change",{bubbles:!0}))}}var Ae=Pe.KeyboardElement=Re,xe={},De="[tabindex],a,button:not([disabled]),input:not([disabled]),select:not([disabled]),textarea:not([disabled])";function Le(e){return class extends e{static get reactiveAttributes(){return n({},super.reactiveAttributes,{autofocusable:Boolean})}constructor(){super(),this.autofocusable=!1}updated(e){var t;super.updated(e);var i=null==(t=this.active)||t,n=!this.hidden,a=i&&e.has("active"),r=this.autofocusable&&e.has("autofocusable"),s=e.has("isConnected"),o=n&&e.has("hidden");this.autofocusable&&this.isConnected&&i&&n&&(a||r||s||o)&&Promise.resolve().then((()=>{(function(e){if(document.activeElement&&e.contains(document.activeElement))return document.activeElement;var t=e.querySelector("[autofocus]");if(t)return t;var i=e.querySelectorAll(De);if(i.length)return i[0];return e})(this).focus({preventScroll:!0})}))}}}var _e=a(Object.freeze({__proto__:null,AutofocusMixin:Le})),Me={};function Ne(e,t,i,n){var a,r=!1,s=0;function o(){a&&clearTimeout(a)}function l(){for(var l=arguments.length,u=new Array(l),c=0;c<l;c++)u[c]=arguments[c];var d=this,h=Date.now()-s;function g(){s=Date.now(),i.apply(d,u)}function p(){a=void 0}r||(n&&!a&&g(),o(),void 0===n&&h>e?g():!0!==t&&(a=setTimeout(n?p:g,void 0===n?e-h:e)))}return"boolean"!=typeof t&&(n=i,i=t,t=void 0),l.cancel=function(){o(),r=!0},l}Object.defineProperty(Me,"__esModule",{value:!0}),Me.debounce=function(e,t,i){return void 0===i?Ne(e,t,!1):Ne(e,i,!1!==t)},Me.throttle=Ne,Object.defineProperty(xe,"__esModule",{value:!0});var Oe=e,Ue=i,Be=_e,Fe=t,Ve=Me;function We(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var He=We(r);class je extends(Be.AutofocusMixin(Ue.ReactiveElement)){static get reactiveAttributes(){return n({},super.reactiveAttributes,{active:Boolean})}static get reactiveProperties(){return n({},super.reactiveProperties,{fullscreenState:Object,isCurrentTimeLive:Boolean,isEnded:Boolean,isLive:Boolean,isPlaying:Boolean,remotePlaybackState:Object,subtitleState:Ue.ReactiveState,pipState:Object,isStarted:Boolean,muted:Boolean})}constructor(){super(),this.active=!1,this.fullscreenState=void 0,this.isCurrentTimeLive=!1,this.isEnded=!1,this.isLive=!1,this.isPlaying=!1,this.isStarted=!1,this.remotePlaybackState=void 0,this.subtitleState=void 0,this.pipState=void 0,this.muted=!1,this.action=Fe.PlayerActions.TogglePlay,this.hidden=!0,this.activatedAt=void 0,this.isHovering=!0,this.isPointerOutside=!1,this.isPressing=!1,this.player=void 0,this.deactivateTimeout=2e3,this._deactivateTimeoutId=void 0,this._throttledHandleEvent=Ve.throttle(60,this.handleEvent),this._unshadowProperties=void 0,this.deactivate=this.deactivate.bind(this)}readyCallback(){this.tabIndex=0,this.player=Oe.getElementOfType(this),this.addEventListener("click",this),this.addEventListener("focus",this,!0),this.addEventListener("blur",this,!0),this.addEventListener("touchstart",this.handleTouchStartHoverProxyEvent,He.default.supportsPassiveEvents?{passive:!0}:void 0),this.addEventListener(He.default.pointerEventTypes.enter,this),this.addEventListener(He.default.pointerEventTypes.down,this),this._unshadowProperties=this.player.shadowProperties(["fullscreenState","pipState","isCurrentTimeLive","isEnded","isLive","isPlaying","isStarted","muted","subtitleState"],this)}disconnectedCallback(){var e;this.removeEventListener("click",this),this.removeEventListener("focus",this,!0),this.removeEventListener("blur",this,!0),this.removeEventListener("touchstart",this.handleTouchStartHoverProxyEvent),this.removeEventListener(He.default.pointerEventTypes.enter,this),this.removeEventListener(He.default.pointerEventTypes.down,this),this.removeEventListener(He.default.pointerEventTypes.move,this._throttledHandleEvent),this.removeEventListener(He.default.pointerEventTypes.leave,this),document.removeEventListener(He.default.pointerEventTypes.up,this),null==(e=this._unshadowProperties)||e.call(this),this.player=null,super.disconnectedCallback()}updating(e,t){"isStarted"===e&&this.isStarted&&(this.hidden=!1)}handleEvent(e){var{target:t,type:i}=e;if("focus"===i)this.activate(!0,i);else if("blur"===i){var n=e.relatedTarget;!this.isPlaying||n&&this.contains(n)||this.activate(!1,i)}else if("click"===i){if(Oe.getActionElement(t)!==this)this.activate(!0,"click nested actionElement");else if(!this.isHovering){(new Date).getTime()-(this.activatedAt||0)>100&&this.activate(!this.active,i),e.preventDefault()}this.isHovering=!0}else this.handlePointerEvent(e)}handleTouchStartHoverProxyEvent(){this.isHovering=!1}handlePointerEvent(e){var{target:t,type:i}=e;if(i===He.default.pointerEventTypes.enter)this.isPointerOutside=!1,this.isPressing=!1,this.addEventListener(He.default.pointerEventTypes.move,this._throttledHandleEvent),this.addEventListener(He.default.pointerEventTypes.leave,this);else if(i===He.default.pointerEventTypes.move)this.isPointerOutside||this.activate(!0,i);else if(i===He.default.pointerEventTypes.down)this.isPressing=!0,this.removeEventListener(He.default.pointerEventTypes.move,this._throttledHandleEvent),this.removeEventListener(He.default.pointerEventTypes.leave,this),document.addEventListener(He.default.pointerEventTypes.up,this);else if(i===He.default.pointerEventTypes.up){this.isPressing=!1;var n=!this.contains(t);n?this.isHovering=!0:this.isHovering&&(this.addEventListener(He.default.pointerEventTypes.move,this._throttledHandleEvent),this.addEventListener(He.default.pointerEventTypes.leave,this)),(this.isHovering||this.player.isSeeking)&&this.activate(!n,i),document.removeEventListener(He.default.pointerEventTypes.up,this)}else i===He.default.pointerEventTypes.leave&&(this.isPointerOutside=!0,this.removeEventListener(He.default.pointerEventTypes.move,this._throttledHandleEvent),this.removeEventListener(He.default.pointerEventTypes.leave,this),this.activate(!this.isPlaying||this.player.focusVisible,i))}activate(e,t){window.clearTimeout(this._deactivateTimeoutId),this.active=e,this.active&&(this._deactivateTimeoutId=window.setTimeout(this.deactivate,this.deactivateTimeout),this.activatedAt=(new Date).getTime())}deactivate(){this.isPlaying&&!this.isPressing&&!this.player.focusVisible&&(this.active=!1)}}var qe=xe.ControlsElement=je,Ge={};Object.defineProperty(Ge,"__esModule",{value:!0});var Ke=i,ze=s,Xe=e;function Ye(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var Qe=Ye(r);class $e extends(ze.FocusWithinMixin(Ke.ReactiveElement)){constructor(){super(...arguments),this.muted=!1,this.volume=1,this.player=void 0,this._unshadowProperties=void 0}static get reactiveProperties(){return n({},super.reactiveProperties,{muted:Boolean,volume:Number})}readyCallback(){super.readyCallback(),this.player=Xe.getElementOfType(this),this._unshadowProperties=this.player.shadowProperties(["muted","volume"],this),this.addEventListener("wheel",this,Qe.default.supportsPassiveEvents?{passive:!1}:void 0),this.muted=this.player.muted,this.volume=this.player.volume}disconnectedCallback(){var e;this.removeEventListener("wheel",this),null==(e=this._unshadowProperties)||e.call(this),this.player=null,super.disconnectedCallback()}handleEvent(e){var t;if("wheel"===e.type&&"INPUT"===(null==(t=e.target)?void 0:t.nodeName)){e.preventDefault(),e.stopPropagation();var i=e.target,n=e;if(0==n.deltaY)return;var a=this.muted?0:this.volume,r=n.deltaY>0?-.1:.1,s=Math.max(Math.min(a+r,1),0);if(s===a)return;i.value=String(100*s),i.dispatchEvent(new Event("change",{cancelable:!0,bubbles:!0}))}}}var Je=Ge.VolumeElement=$e,Ze={},et={};Object.defineProperty(et,"__esModule",{value:!0});var tt=o,it=e;function nt(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var at=nt(r),rt="transform"in document.head.style?"transform":"webkitTransform";et.ScrubberRenderMixin=function(e){return class extends e{constructor(){super(...arguments),this.active=!1,this.endTime=0,this.isDragging=!1,this.isLive=!1,this.isRealtime=!1,this.isSeeking=!1,this.isTimeRunning=!1,this.playbackRate=1,this.playheadPosition=0,this.pointerPosition=void 0,this.seekableStep=1,this.startTime=0,this.width=0,this.epochStartTime=0,this.player=void 0,this._unshadowProperties=void 0,this._elPlayheadTime=null,this._elPlayheadTimeComputedStyles=void 0,this._elEndTime=null,this._elInputRange=null,this._elPlayhead=null,this._elPlayheadComputedStyles=void 0,this._elProgressBarPlayed=null,this._elProgressBarPlayedComputedStyles=void 0,this._elPointerTime=null,this._elStartTime=null,this._elIndexPoints=null}static get reactiveAttributes(){return n({},super.reactiveAttributes,{active:Boolean})}static get reactiveProperties(){return n({},super.reactiveProperties,{endTime:Number,isDragging:Boolean,isLive:Boolean,isRealtime:Boolean,isSeeking:Boolean,isTimeRunning:Boolean,playbackRate:Number,playheadPosition:Number,pointerPosition:Number,seekableStep:Number,startTime:Number,width:Number})}readyCallback(){this.player=it.getElementOfType(this),this.selectElements(),this.width=this.offsetWidth,this._unshadowProperties=this.player.shadowProperties(["isLive","isRealtime","isSeeking","isTimeRunning","playbackRate","seekableStep"],this)}updating(e,t){this.width!==this.offsetWidth&&(this.width=this.offsetWidth),"active"===e?this.active&&!this.width&&(this.width=this.offsetWidth):"isDragging"===e&&(this.isDragging||void 0===this.pointerPosition||(this.isTimeRunning=!1,this.playheadPosition=this.pointerPosition)),super.updating(e,t)}updated(e){if(super.updated(e),this.endTime){var t=this.endTime-this.startTime;if(e.has("pointerPosition")&&this.updatePointerTimeElement(t),e.has("active")||e.has("endTime")||e.has("startTime")||e.has("isTimeRunning")||e.has("playheadPosition")||e.has("playbackRate")||e.has("seekableStep")||e.has("width")){var i=t*this.playheadPosition,n=this.isRealtime?(this.epochStartTime+i)%86400:i%86400,a=tt.formatDuration(n),r=tt.formatDuration(t);if(this.updateInputRangeElement(a,r,i),!this.active)return;var s=Math.min(1,this.playheadPosition)*this.width,o=this.width?1e3*t*this.playbackRate/this.width:0,l=!this.isLive&&o>0&&!at.default.isIE&&o<=500,u=o*(this.width-s);this.isDragging||this.updateProgressBarPlayedElement(),this.updateIndexPointsElement(),this.updatePlayheadElement(l,u,s);var[c,d]=this.updatePlayheadTimeElement(a,s,l,u);this.updateStartTimeElement(c),this.updateEndTimeElement(i,d)}}}updateIndexPointsElement(){this._elIndexPoints&&(this._elIndexPoints.setAttribute("endtime",this.endTime.toString()),this._elIndexPoints.setAttribute("currenttime",((this.endTime-this.startTime)*this.playheadPosition).toString()))}updatePointerTimeElement(e){if(void 0!==this.pointerPosition){var t=this.pointerPosition*this.width,i=e*this.pointerPosition;if(this._elPointerTime){var n=this.isRealtime?(this.epochStartTime+i)%86400:i%86400;this._elPointerTime.innerText=tt.formatDuration(n);var a=this._elPointerTime.offsetWidth,r=a/2,s=this.width-a;this._elPointerTime.style.visibility="visible",this._elPointerTime.style[rt]="translateX("+Math.max(0,Math.min(t-r,s))+"px)"}this.isDragging&&(this._elPlayhead&&(this._elPlayhead.style[rt]="translateX("+t+"px)",this._elPlayhead.style.transitionDuration="unset"),this._elInputRange&&(this._elInputRange.value=""+i),this._elProgressBarPlayed&&(this._elProgressBarPlayed.style.width=100*Math.min(1,this.pointerPosition)+"%"))}else this._elPointerTime&&(this._elPointerTime.style.visibility="hidden")}updateInputRangeElement(e,t,i){this._elInputRange&&(this._elInputRange.setAttribute("step",""+this.seekableStep),this._elInputRange.setAttribute("min",""+this.startTime),this._elInputRange.setAttribute("max",""+this.endTime),this._elInputRange.setAttribute("aria-valuetext",this.isRealtime?e:e+" av "+t),this.isDragging||(this._elInputRange.value=""+i))}updateProgressBarPlayedElement(){this._elProgressBarPlayed&&(this._elProgressBarPlayed.style.width=100*Math.min(1,this.playheadPosition)+"%",this._elProgressBarPlayed.style.transitionDuration="unset")}updatePlayheadElement(e,t,i){!this.isDragging&&this._elPlayhead&&(this._elPlayhead.style[rt]="translateX("+i+"px)",this._elPlayhead.style.transitionDuration="unset",this.isTimeRunning&&e&&(this._elPlayheadComputedStyles[rt],this._elPlayhead.style[rt]="translateX("+this.width+"px)",this._elPlayhead.style.transitionDuration=t+"ms"))}updatePlayheadTimeElement(e,t,i,n){var a=0,r=0;if(this._elPlayheadTime){var s,o,l=this._elPlayheadTime.offsetWidth/2,u=l,c=this.width-(this._elPointerTime&&(null==(s=this._elPointerTime)?void 0:s.offsetWidth)/2>l?(null==(o=this._elPointerTime)?void 0:o.offsetWidth)/2:l),d=Math.min(Math.max(t,u),c),h=t<l||t>c;a=d-l-2,r=d+l+2,this._elPlayheadTime.innerText=e,this._elPlayheadTime.style.marginLeft="-"+l+"px",this._elPlayheadTime.style[rt]="translateX("+d+"px)",this._elPlayheadTime.style.transitionDuration="unset",!h&&this.isTimeRunning&&i&&(this._elPlayheadTimeComputedStyles[rt],this._elPlayheadTime.style[rt]="translateX("+this.width+"px)",this._elPlayheadTime.style.transitionDuration=n+"ms")}return[a,r]}updateStartTimeElement(e){if(this._elStartTime)if(this.isRealtime){var t=this.isRealtime?this.epochStartTime%86400:this.startTime;this._elStartTime.innerText=""+tt.formatDuration(t),this._elStartTime.style.visibility=e>this._elStartTime.offsetWidth?"visible":"hidden"}else this._elStartTime.style.visibility="hidden"}updateEndTimeElement(e,t){var i=this.endTime-this.startTime;if(this._elEndTime){var n=this.isRealtime?(this.epochStartTime+i)%86400:this.endTime,a=tt.formatDuration(this.isRealtime?n:e-this.endTime);this._elEndTime.innerText=(this.isRealtime?"":"-")+a,this._elEndTime.style.visibility=t<this.width-this._elEndTime.offsetWidth?"visible":"hidden"}}selectElements(){this._elPlayheadTime&&(this._elPlayheadTimeComputedStyles=getComputedStyle(this._elPlayheadTime)),this._elPlayhead&&(this._elPlayheadComputedStyles=getComputedStyle(this._elPlayhead)),this._elProgressBarPlayed&&(this._elProgressBarPlayedComputedStyles=getComputedStyle(this._elProgressBarPlayed))}disconnectedCallback(){var e;null==(e=this._unshadowProperties)||e.call(this),this.player=null,super.disconnectedCallback&&super.disconnectedCallback()}}},Object.defineProperty(Ze,"__esModule",{value:!0});var st=l,ot=i,lt=e,ut=et;function ct(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var dt=ct(r);class ht extends(ut.ScrubberRenderMixin(ot.ReactiveElement)){constructor(){super(...arguments),this.dimensions=void 0,this._unshadowAdditionalProperties=void 0}static get reactiveProperties(){return n({},super.reactiveProperties,{dimensions:(e,t)=>{e.width=e.offsetWidth}})}readyCallback(){var e;super.readyCallback(),this.addEventListener(dt.default.pointerEventTypes.enter,this),this.addEventListener(dt.default.pointerEventTypes.move,this),this.addEventListener(dt.default.pointerEventTypes.down,this),null==(e=this._elInputRange)||e.addEventListener("change",this),this.player.addEventListener(st.PlayerEvents.ScrubberUpdate,this),this._unshadowAdditionalProperties=this.player.shadowProperties(["dimensions"],this)}disconnectedCallback(){var e,t,i;this.removeEventListener(dt.default.pointerEventTypes.enter,this),this.removeEventListener(dt.default.pointerEventTypes.move,this),this.removeEventListener(dt.default.pointerEventTypes.down,this),this.removeEventListener(dt.default.pointerEventTypes.leave,this),document.removeEventListener(dt.default.pointerEventTypes.up,this),null==(e=this.player)||e.removeEventListener(st.PlayerEvents.ScrubberUpdate,this),null==(t=this._elInputRange)||t.removeEventListener("change",this),null==(i=this._unshadowAdditionalProperties)||i.call(this),super.disconnectedCallback()}updating(e,t){super.updating(e,t),"isDragging"===e&&(this.isDragging?this.classList.add("-scrubber--dragging"):this.classList.remove("-scrubber--dragging"))}handleEvent(e){var{type:t}=e;if(st.isPlayerEvent(e,st.PlayerEvents.ScrubberUpdate)){var{playheadPosition:i,endPosition:n,startPosition:a,startLiveTime:r}=e.detail;this.endTime=n,this.startTime=a,this.playheadPosition=(i-a)/(n-a),r&&(this.epochStartTime=(r.getTime()-6e4*r.getTimezoneOffset())/1e3)}else if(t===dt.default.pointerEventTypes.enter)this.addEventListener(dt.default.pointerEventTypes.leave,this);else if(t===dt.default.pointerEventTypes.move)this.pointerPosition=lt.getPositionFromEvent(this,e);else if(t===dt.default.pointerEventTypes.down)this.isDragging=!0,document.addEventListener(dt.default.pointerEventTypes.up,this);else if(t===dt.default.pointerEventTypes.up){var s=this.seekableStep;this.seekableStep=1,void 0===this.pointerPosition&&(this.pointerPosition=lt.getPositionFromEvent(this,e)),this.isDragging=!1,this.pointerPosition=void 0,document.removeEventListener(dt.default.pointerEventTypes.up,this),this.updateComplete.then((()=>{this._elInputRange&&(this.isSeeking||(this._elInputRange.value=""+((this.endTime-this.startTime)*this.playheadPosition+this.startTime),this._elInputRange.dispatchEvent(new Event("change",{cancelable:!0,bubbles:!0}))),this.seekableStep=s)}))}else"change"===t?this.isSeeking&&(e.preventDefault(),e.stopImmediatePropagation()):t===dt.default.pointerEventTypes.leave&&(this.removeEventListener(dt.default.pointerEventTypes.leave,this),this.pointerPosition=void 0)}selectElements(){this._elPlayheadTime=this.querySelector('[type="playhead-time"]'),this._elEndTime=this.querySelector('[type="end-time"]'),this._elInputRange=this.querySelector('input[type="range"]'),this._elPlayhead=this.querySelector('[type="playhead"]'),this._elProgressBarPlayed=this.querySelector('[type="progressbar-played"]'),this._elPointerTime=this.querySelector('[type="pointer-time"]'),this._elStartTime=this.querySelector('[type="start-time"]'),super.selectElements()}}var gt=Ze.ScrubberElement=ht;
/**
 * @license
 * Copyright (c) 2018 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at
 * http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at
 * http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at
 * http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at
 * http://polymer.github.io/PATENTS.txt
 */class pt{constructor(e){this.classes=new Set,this.changed=!1,this.element=e;var t=(e.getAttribute("class")||"").split(/\s+/);for(var i of t)this.classes.add(i)}add(e){this.classes.add(e),this.changed=!0}remove(e){this.classes.delete(e),this.changed=!0}commit(){if(this.changed){var e="";this.classes.forEach((t=>e+=t+" ")),this.element.setAttribute("class",e)}}}var vt=new WeakMap,ft=u((e=>t=>{if(!(t instanceof c)||t instanceof d||"class"!==t.committer.name||t.committer.parts.length>1)throw new Error("The `classMap` directive must be used in the `class` attribute and must be the only part in the attribute.");var{committer:i}=t,{element:n}=i,a=vt.get(t);void 0===a&&(n.setAttribute("class",i.strings.join(" ")),vt.set(t,a=new Set));var r=n.classList||new pt(n);for(var s in a.forEach((t=>{t in e||(r.remove(t),a.delete(t))})),e){var o=e[s];o!=a.has(s)&&(o?(r.add(s),a.add(s)):(r.remove(s),a.delete(s)))}"function"==typeof r.commit&&r.commit()})),mt=new WeakMap,yt=u((e=>t=>{if(!(t instanceof c)||t instanceof d||"style"!==t.committer.name||t.committer.parts.length>1)throw new Error("The `styleMap` directive must be used in the style attribute and must be the only part in the attribute.");var{committer:i}=t,{style:n}=i.element,a=mt.get(t);for(var r in void 0===a&&(n.cssText=i.strings.join(" "),mt.set(t,a=new Set)),a.forEach((t=>{t in e||(a.delete(t),-1===t.indexOf("-")?n[t]=null:n.removeProperty(t))})),e)a.add(r),-1===r.indexOf("-")?n[r]=e[r]:n.setProperty(r,e[r])})),bt={},Tt={};Object.defineProperty(Tt,"__esModule",{value:!0});function kt(e,t,i){return"auto"!==e?!t&&(e<0||e>100)?100-i:e:t?-1:100-i}function St(e,t,i){if("auto"!==e)return e;switch(t){case"left":return"line-left";case"right":return"line-right";case"start":return"ltr"===i?"line-left":"line-right";case"end":return"ltr"===i?"line-right":"line-left";default:return"center"}}Tt.computeCuePosition=function(e,t){var i,n,a={styles:{},insertLineBreaks:0,appendLineBreaks:0},r=null!=(i=null==t?void 0:t.textDirection)?i:"ltr",s=null!=(n=null==t?void 0:t.lineMargin)?n:5,{vertical:o,positionAlign:l,size:u}=e,{snapToLines:c,line:d,lineAlign:h,position:g,align:p}=e,v=kt(d,c,s),f=St(null!=l?l:"auto",p,r);if(c&&(c=!1,v>=0?(d=s,a.insertLineBreaks=v):(d=100-s,a.appendLineBreaks=-v-1),v=kt(d,c,s)),void 0!==h&&"start"!==h||(50===d?h="center":d>50&&(h="end")),null!=t&&t.defaultToIndentedStartAlignment&&"auto"===g&&(void 0===l||"auto"===l)){var m,y=null!=(m=null==t?void 0:t.indentation)?m:11.5;switch(f){case"line-left":g=y;break;case"center":g=y,p="start";break;case"line-right":g=100-y}f=St(null!=l?l:"auto",p,r)}var b,T,k=function(e,t){if("auto"!==e&&e>=0&&e<=100)return e;switch(t){case"left":return 0;case"right":return 100;default:return 50}}(g,p),S={"":"horizontal-tb",rl:"vertical-rl",lr:"vertical-lr"}[o],E=function(e,t){if("line-left"===t)return 100-e;if("line-right"===t)return e;if(e<=50)return 2*e;return 2*(100-e)}(k,f),P=Math.min(u,E),C=""===o?P+"%":"auto",I=""===o?"auto":P+"%",w=function(e,t,i){if("line-left"===t)return e;if("center"===t)return e-i/2;return e-i}(k,f,P);""===o?(b=w,T=c?0:v):(b=c?0:v,T=w);var R=b+"%",A=T+"%",x="none";c||(""===o?"center"===h?x="translateY(-50%)":"end"===h&&(x="translateY(-100%)"):"center"===h?x="translateX(-50%)":"end"===h&&(x="translateX(-100%)"));var D=function(e,t){if("start"===e)return"ltr"===t?"left":"right";if("end"===e)return"ltr"===t?"right":"left";return e}(p,r);return a.styles.writingMode=S,a.styles.top=A,a.styles.left=R,a.styles.width=C,a.styles.height=I,a.styles.transform=x,a.styles.textAlign=D,a},Object.defineProperty(bt,"__esModule",{value:!0});var Et=l,Pt=i,Ct=h,It=e,wt=Tt,Rt=t;class At extends(Ct.DimensionsMixin(Pt.ReactiveElement)){constructor(){super(...arguments),this.playerAspectRatio=void 0,this.videoAspectRatio=void 0,this.subtitleState=void 0,this.fullscreenState=void 0,this.pipState=void 0,this.remotePlaybackState=void 0,this.nativeRenderingEnabled=void 0,this.cueConfig={},this.action=Rt.PlayerActions.Speak,this.player=void 0,this.value=void 0,this.activeCuePositions=[],this._unshadowProperties=void 0}static get reactiveProperties(){return n({},super.reactiveProperties,{subtitleState:Pt.ReactiveState,fullscreenState:Object,pipState:Object,remotePlaybackState:Object})}connectedCallback(){super.connectedCallback(),this.player=It.getElementOfType(this),this.player.addEventListener(Et.PlayerEvents.QualityChange,this),this._unshadowProperties=this.player.shadowProperties(["subtitleState"],this)}disconnectedCallback(){var e,t;super.disconnectedCallback(),null==(e=this.player)||e.removeEventListener(Et.PlayerEvents.QualityChange,this),null==(t=this._unshadowProperties)||t.call(this),this.player=null}updated(e){if(super.updated(e),this.isConnected&&this.player){if(e.has("subtitleState")&&this.subtitleState){var t=this.subtitleState.activeCues,i=t.map((e=>e.text.replace(/<[/\w][^<]*>/g,""))).join(" ");i&&(this.value=i,this.dispatchEvent(new Event("change",{cancelable:!0,bubbles:!0}))),this.activeCuePositions=t.map((e=>wt.computeCuePosition(e,this.cueConfig)))}if(e.has("fullscreenState")){var n,a,r,s=(null==(n=this.fullscreenState)?void 0:n.isActive)&&this.fullscreenState.isNativeUI;if(this.nativeRenderingEnabled!==s)if(this.nativeRenderingEnabled=s,s)null==(a=this.player.activeSession)||a.enableNativeSubtitlesDisplay();else null==(r=this.player.activeSession)||r.disableNativeSubtitlesDisplay()}e.has("dimensions")&&(this.playerAspectRatio=this.player.clientWidth/this.player.clientHeight,this.updateRenderingArea())}}handleEvent(e){var t;if(Et.isPlayerEvent(e,Et.PlayerEvents.QualityChange)&&(!this.videoAspectRatio&&null!=(t=this.player.activeSession)&&t.getCurrentQuality())){var i=this.player.activeSession.getCurrentQuality();null!=i&&i.width&&i.height&&(this.playerAspectRatio=this.player.clientWidth/this.player.clientHeight,this.videoAspectRatio=i.width/i.height,this.updateRenderingArea())}}isRenderingEnabled(){var e,t;return!(this.nativeRenderingEnabled||null!=(e=this.pipState)&&e.isActive||null!=(t=this.remotePlaybackState)&&t.isActive)}updateRenderingArea(){var e,t,i,n,a=this.getBlackBars();this.style.top=null!=(e=a.top)?e:"0px",this.style.right=null!=(t=a.right)?t:"0px",this.style.bottom=null!=(i=a.bottom)?i:"0px",this.style.left=null!=(n=a.left)?n:"0px"}getBlackBars(){var e=this.playerAspectRatio,t=this.videoAspectRatio;if(void 0===e||void 0===t)return{};if(e===t||"contain"!==this.getObjectFit())return{};if(e>t){var i=(1-t/e)/2*100;return{right:i+"%",left:i+"%"}}var n=(1-e/t)/2*100;return{top:n+"%",bottom:n+"%"}}getObjectFit(){var e,t=null==(e=this.player)?void 0:e.querySelector("video");return t?getComputedStyle(t).objectFit:"contain"}}var xt,Dt=bt.SubtitlesElement=At,Lt={},_t=function(e,t){var i="000000000"+e;return i.substr(i.length-t)},Mt=_t,Nt="object"==typeof window?window:self,Ot=Object.keys(Nt).length,Ut=Mt(((navigator.mimeTypes?navigator.mimeTypes.length:0)+navigator.userAgent.length).toString(36)+Ot.toString(36),4),Bt="undefined"!=typeof window&&(window.crypto||window.msCrypto)||"undefined"!=typeof self&&self.crypto;if(Bt){var Ft=Math.pow(2,32)-1;xt=function(){return Math.abs(Bt.getRandomValues(new Uint32Array(1))[0]/Ft)}}else xt=Math.random;var Vt=function(){return Ut},Wt=_t,Ht=xt,jt=0,qt=Math.pow(36,4);function Gt(){return Wt((Ht()*qt<<0).toString(36),4)}function Kt(){return jt=jt<qt?jt:0,++jt-1}function zt(){return"c"+(new Date).getTime().toString(36)+Wt(Kt().toString(36),4)+Vt()+(Gt()+Gt())}zt.slug=function(){var e=(new Date).getTime().toString(36),t=Kt().toString(36).slice(-4),i=Vt().slice(0,1)+Vt().slice(-1),n=Gt().slice(-2);return e.slice(-2)+t+i+n},zt.isCuid=function(e){return"string"==typeof e&&!!e.startsWith("c")},zt.isSlug=function(e){if("string"!=typeof e)return!1;var t=e.length;return t>=7&&t<=10},zt.fingerprint=Vt;var Xt=zt,Yt="https://static.nrk.no/core-analytics/major/6";function Qt(e,t,i){if(i||2===arguments.length)for(var n,a=0,r=t.length;a<r;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}var $t="data-core-analytics",Jt=function e(){var t=[],i=[],n=Object.create(null),a=Object.create(null),r=Object.create(null),s=!1,o=function e(n,r){if(function(e){var t;return void 0!==(null===(t=e)||void 0===t?void 0:t.q)}(n))n.q.forEach((function(t){return e.apply(void 0,t)}));else if(function(e){return"function"==typeof e}(n)){var o=t.index>1?1-t.index:t.length;t.splice(o,0,n),s&&setTimeout((function(){return t.index||e.next()}))}else if("string"==typeof n){var l=function(){var t=a[n]||[];t.length||e.log("Missing handler for action "+n),i.push({type:n,args:r}),t.forEach((function(t){return t(r,e,n)}))};if("initialize"===n){if(s)return e("error",new Error("Tracker is already initialized"));s=!0,t.unshift(l),setTimeout(e.next)}else e(l),e((function(){return i.pop()}))}return e};return o.version="6.10.1",o.create=e,o.debug=!1,o.set=function(e,t){"object"==typeof e?Object.keys(e).forEach((function(t){return o.set(t,e[t])})):n[e]=t},o.get=function(e){return e?n[e]:n},o.on=function(e,t){(a[e]=a[e]||[]).push(t),i.forEach((function(i){return i.type===e&&t(i.args,o,e)}))},o.off=function(e,t){a[e]=(a[e]||[]).filter((function(e){return t&&e!==t}))},o.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];o.debug&&console.log.apply(console,Qt(["%c"+o.uuid+":","font-weight:bold"],e,!1))},o.load=function(e,t){r[t]||(r[t]=!0,o((function(){return function(e){var t=e.src,i=e.onload,n=void 0===i?Function.prototype:i,a=e.crossorigin,r=void 0===a||a,s=document.querySelector('script[src="'+t+'"]')||document.createElement("script"),o=s.queue=s.queue||[];o.length?o.push(n):s.parentNode?n(s):(o.push(n),s.async=!0,s.onload=function(){return o.splice(0).forEach((function(e){return e(s)}))},s.setAttribute("src",t),r&&-1===t.indexOf("//localhost")&&s.setAttribute("crossorigin","anonymous"),document.head.appendChild(s))}({src:e,onload:function(i){o.log("Loading "+e);var n=t.split("."),a=n[0],r=n[1],s=window[a]&&window[a][r];"function"==typeof s?s(o):o("error",new Error("Expected "+i.src+" to expose function at window."+t)),o.next()}}),!1})))},o.next=function(){var e=t.index=t.length,i=t.shift(),n=e&&i(o);"object"==typeof n&&null!==n&&"then"in n&&"function"==typeof n.then?n.then(o.next):e&&!1!==n&&o.next()},o.contains=function(e){for(var t=e;t;t=t.parentElement)if(t.hasAttribute($t))return t.hasAttribute(o.attr)&&e;return!1},o.uuid="",o.attr="",o.on("error",(function(e){return console.error("%c"+(o.uuid||"Core Analytics")+":","font-weight:bold",e.message)})),o.on("context",(function(e){return"userId"in e&&o.set("userId",e.userId)})),o.on("pageview",(function(e){void 0===e&&(e={}),e.tnsSection&&(o.load(Yt+"/statistics/unispring.min.js","CA6.statistics/unispring"),o.load(Yt+"/statistics/tns.min.js","CA6.statistics/tns"))})),o.on("recommendations",(function(){return o.load(Yt+"/recommendations/ecommerce.min.js","CA6.recommendations/ecommerce")})),o.on("optimize",(function(){return o.load(Yt+"/experiments/optimize.min.js","CA6.experiments/optimize")})),o.on("time-spent",(function(){return o.load(Yt+"/engagement/time-spent.min.js","CA6.engagement/time-spent")})),o.on("content-consumed",(function(){return o.load(Yt+"/engagement/content-consumed.min.js","CA6.engagement/content-consumed")})),o.on("initialize",(function(e){if(void 0===e&&(e={}),/\W/.test(e.trackerName||""))return o("error",new Error("trackerName can only contain alphanumeric characters"));var t=e.container||document.documentElement;o.uuid="ca_"+(e.trackerName||Math.round(Date.now()*Math.random()).toString(32)),o.attr=$t+"-"+o.uuid.replace(/[\W_]+/g,"-"),t.setAttribute($t,""),t.setAttribute(o.attr,""),o.set({userId:e.userId,parentId:e.parentId,clientId:e.clientId}),e.debug&&o.log("Debug:",o.debug=Boolean(e.debug)),e.ga&&o.load(Yt+"/statistics/analytics.min.js","CA6.statistics/analytics")})),o}(),Zt=2,ei=Object,ti=ei.prototype,ii=ei.assign,ni=ei.create,ai=ei.defineProperty,ri=ti.hasOwnProperty;function si(){return"undefined"!=typeof globalThis&&globalThis?globalThis:"undefined"!=typeof self&&self?self:"undefined"!=typeof window&&window?window:"undefined"!=typeof global&&global?global:null}function oi(e){throw new TypeError(e)}function li(e){if(ni)return ni(e);if(null==e)return{};var t=typeof e;function i(){}return"object"!==t&&"function"!==t&&oi("Object prototype may only be an Object:"+e),i.prototype=e,new i}(si()||{}).Symbol,(si()||{}).Reflect;var ui=ii||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var a in t=arguments[i])ti.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},ci=function(e,t){return(ci=ei.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)};function di(e,t){function i(){this.constructor=e}"function"!=typeof t&&null!==t&&oi("Class extends value "+String(t)+" is not a constructor or null"),ci(e,t),e.prototype=null===t?li(t):(i.prototype=t.prototype,new i)}function hi(e,t){for(var i=0,n=t.length,a=e.length;i<n;i++,a++)e[a]=t[i];return e}
/*!
 * Microsoft Dynamic Proto Utility, 1.1.4
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */var gi=Object,pi=gi.getPrototypeOf,vi=0;function fi(e,t){return e&&gi.prototype.hasOwnProperty.call(e,t)}function mi(e){return e&&(e===gi.prototype||e===Array.prototype)}function yi(e){return mi(e)||e===Function.prototype}function bi(e){if(e){if(pi)return pi(e);var t=e.__proto__||e.prototype||(e.constructor?e.constructor.prototype:null);if(t)return t}return null}function Ti(e,t){var i=[],n=gi.getOwnPropertyNames;if(n)i=n(e);else for(var a in e)"string"==typeof a&&fi(e,a)&&i.push(a);if(i&&i.length>0)for(var r=0;r<i.length;r++)t(i[r])}function ki(e,t,i){return"constructor"!==t&&"function"==typeof e[t]&&(i||fi(e,t))}function Si(e){throw new TypeError("DynamicProto: "+e)}function Ei(e,t){for(var i=e.length-1;i>=0;i--)if(e[i]===t)return!0;return!1}function Pi(e,t,i,n){var a=null;if(e&&fi(i,"_dynClass")){var r=e._dynInstFuncs||{};if((a=(r[i._dynClass]||{})[t])||Si("Missing ["+t+"] function"),!a._dynInstChk&&!1!==r._dynInstChk){for(var s=!fi(e,t),o=bi(e),l=[];s&&o&&!yi(o)&&!Ei(l,o);){var u=o[t];if(u){s=u===n;break}l.push(o),o=bi(o)}try{s&&(e[t]=a),a._dynInstChk=1}catch(e){r._dynInstChk=!1}}}return a}function Ci(e,t,i){var n=t[e];return n===i&&(n=bi(t)[e]),"function"!=typeof n&&Si("["+e+"] is not a function"),n}function Ii(e,t,i,n,a){if(!mi(e)){var r=i._dynInstFuncs=i._dynInstFuncs||{},s=r[t]=r[t]||{};!1!==r._dynInstChk&&(r._dynInstChk=!!a),Ti(i,(function(t){ki(i,t,!1)&&i[t]!==n[t]&&(s[t]=i[t],delete i[t],(!fi(e,t)||e[t]&&!e[t]._isDynProxy)&&(e[t]=function(e,t){var i=function i(){return(Pi(this,t,e,i)||Ci(t,e,i)).apply(this,arguments)};return i._isDynProxy=1,i}(e,t)))}))}}function wi(e,t){return fi(e,"prototype")?e.name||t||"_unknown_":((e||{}).constructor||{}).name||t||"_unknown_"}function Ri(e,t,i,n){fi(e,"prototype")||Si("theClass is an invalid class definition.");var a=e.prototype;(function(e,t){if(pi)for(var i=[],n=bi(t);n&&!yi(n)&&!Ei(i,n);){if(n===e)return!0;i.push(n),n=bi(n)}return!1})(a,t)||Si("["+wi(e)+"] is not in class hierarchy of ["+wi(t)+"]");var r=null;fi(a,"_dynClass")?r=a._dynClass:(r="_dynCls$"+wi(e,"_")+"$"+vi,vi++,a._dynClass=r);var s=Ri._dfOpts,o=!!s.useBaseInst;o&&n&&void 0!==n.useBaseInst&&(o=!!n.useBaseInst);var l=function(e){var t={};return Ti(e,(function(i){!t[i]&&ki(e,i,!1)&&(t[i]=e[i])})),t}(t);i(t,function(e,t,i,n){function a(e,t,i){var a=t[i];if(a._isDynProxy&&n){var r=e._dynInstFuncs||{};!1!==r._dynInstChk&&(a=(r[t._dynClass]||{})[i]||a)}return function(){return a.apply(e,arguments)}}var r={};Ti(i,(function(e){r[e]=a(t,i,e)}));for(var s=bi(e),o=[];s&&!yi(s)&&!Ei(o,s);)Ti(s,(function(e){!r[e]&&ki(s,e,!pi)&&(r[e]=a(t,s,e))})),o.push(s),s=bi(s);return r}(a,t,l,o));var u=!!pi&&!!s.setInstFuncs;u&&n&&(u=!!n.setInstFuncs),Ii(a,r,t,l,!1!==u)}var Ai;Ri._dfOpts={setInstFuncs:!0,useBaseInst:!0},function(e){e[e.CRITICAL=1]="CRITICAL",e[e.WARNING=2]="WARNING"}(Ai||(Ai={}));var xi=0,Di=1,Li=2,_i=3,Mi=4,Ni=5,Oi=6,Ui=7,Bi=8,Fi=9,Vi=10,Wi=11,Hi=12,ji=13,qi=14,Gi=15,Ki=16,zi=17,Xi=18,Yi=19,Qi=20,$i=22,Ji=23,Zi=24,en=25,tn=26,nn=27,an=28,rn=29,sn=30,on=31,ln=32,un=33,cn=35,dn=36,hn=37,gn=38,pn=39,vn=40,fn=41,mn=42,yn=43,bn=45,Tn=46,kn=47,Sn=48,En=49,Pn=50,Cn=52,In=54,wn=55,Rn=56,An=57,xn=58,Dn=60,Ln=61,_n=62,Mn=63,Nn=64,On=66,Un=67,Bn=68,Fn=69,Vn=70,Wn=71,Hn=72,jn=73,qn=74,Gn=100,Kn=104,zn=105,Xn=ai;function Yn(e){return ti.toString.call(e)}function Qn(e){return void 0===e||void 0===e}function $n(e){return null===e||Qn(e)}function Jn(e){return!$n(e)}function Zn(e,t){return e&&ri.call(e,t)}function ea(e){return"object"==typeof e}function ta(e){return"function"==typeof e}function ia(e,t,i,n){void 0===n&&(n=!1);var a=!1;if(!$n(e))try{$n(e.addEventListener)?$n(e.attachEvent)||(e.attachEvent("on"+t,i),a=!0):(e.addEventListener(t,i,n),a=!0)}catch(e){}return a}function na(e,t){if(e)for(var i in e)ri.call(e,i)&&t.call(e,i,e[i])}function aa(e,t){return!(!e||!t)&&-1!==e.indexOf(t)}function ra(e){return"[object Array]"===Yn(e)}function sa(e){return"[object Error]"===Yn(e)}function oa(e){return"string"==typeof e}function la(e){return"number"==typeof e}function ua(e){if("[object Date]"===Yn(e)){var t=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}function ca(e,t,i){var n=e.length;try{for(var a=0;a<n&&(!(a in e)||-1!==t.call(i||e,e[a],a,e));a++);}catch(e){}}function da(e,t,i){var n=e.length,a=i||0;try{for(var r=Math.max(a>=0?a:n-Math.abs(a),0);r<n;r++)if(r in e&&e[r]===t)return r}catch(e){}return-1}function ha(e,t,i){var n=e.length,a=i||e,r=new Array(n);try{for(var s=0;s<n;s++)s in e&&(r[s]=t.call(a,e[s],e))}catch(e){}return r}function ga(e){return"string"!=typeof e?e:e.replace(/^\s+|\s+$/g,"")}var pa=!{toString:null}.propertyIsEnumerable("toString"),va=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function fa(e){var t=typeof e;"function"===t||"object"===t&&null!==e||oi("objKeys called on non-object");var i=[];for(var n in e)e&&ri.call(e,n)&&i.push(n);if(pa)for(var a=va.length,r=0;r<a;r++)e&&ri.call(e,va[r])&&i.push(va[r]);return i}function ma(e,t,i,n){if(Xn)try{var a={enumerable:!0,configurable:!0};return i&&(a.get=i),n&&(a.set=n),Xn(e,t,a),!0}catch(e){}return!1}function ya(){var e=Date;return e.now?e.now():(new e).getTime()}function ba(e){return sa(e)?e.name:""}function Ta(e,t,i,n,a){var r=i;return e&&((r=e[t])===i||a&&!a(r)||n&&!n(i)||(r=i,e[t]=r)),r}function ka(e,t,i){var n;return e?!(n=e[t])&&$n(n)&&(n=Qn(i)?{}:i,e[t]=n):n=Qn(i)?{}:i,n}function Sa(e){return!e}function Ea(e){return!!e}function Pa(e){throw new Error(e)}function Ca(e){return e&&(e=ei(ii?ii({},e):e)),e}var Ia=null,wa=null,Ra=null,Aa=null;function xa(e,t){var i=!1;if(e){try{if(!(i=t in e)){var n=e.prototype;n&&(i=t in n)}}catch(e){}if(!i)try{i=!Qn((new e)[t])}catch(e){}}return i}function Da(e){var t=si();return t&&t[e]?t[e]:"window"===e&&La()?window:null}function La(){return Boolean("object"==typeof window&&window)}function _a(){return La()?window:Da("window")}function Ma(){return Boolean("object"==typeof document&&document)}function Na(){return Ma()?document:Da("document")}function Oa(){return Boolean("object"==typeof navigator&&navigator)}function Ua(){return Oa()?navigator:Da("navigator")}function Ba(){return Boolean("object"==typeof history&&history)?history:Da("history")}function Fa(e){return"object"==typeof location&&location?location:Da("location")}function Va(){return Da("performance")}function Wa(){return Boolean("object"==typeof JSON&&JSON||null!==Da("JSON"))}function Ha(){return Wa()?JSON||Da("JSON"):null}function ja(){var e=Ua();if(e&&(e.userAgent!==wa||null===Ia)){var t=((wa=e.userAgent)||"").toLowerCase();Ia=aa(t,"msie")||aa(t,"trident/")}return Ia}function qa(e){if(void 0===e&&(e=null),!e){var t=Ua()||{};e=t?(t.userAgent||"").toLowerCase():""}var i=(e||"").toLowerCase();if(aa(i,"msie"))return parseInt(i.split("msie")[1]);if(aa(i,"trident/")){var n=parseInt(i.split("trident/")[1]);if(n)return n+4}return null}function Ga(e){var t=Object.prototype.toString.call(e),i="";return"[object Error]"===t?i="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":Wa()&&(i=Ha().stringify(e)),t+i}function Ka(){return null===Aa&&(Aa=Oa()&&Boolean(Ua().sendBeacon)),Aa}function za(e){var t=!1;try{t=!!Da("fetch");var i=Da("Request");t&&e&&i&&(t=xa(i,"keepalive"))}catch(e){}return t}function Xa(){return null===Ra&&(Ra=void 0!==typeof XDomainRequest)&&Ya()&&(Ra=Ra&&!xa(Da("XMLHttpRequest"),"withCredentials")),Ra}function Ya(){var e=!1;try{e=!!Da("XMLHttpRequest")}catch(e){}return e}function Qa(e){return e?'"'+e.replace(/\"/g,"")+'"':""}function $a(e,t){var i="undefined"!=typeof console?console:Da("console");if(i){var n="log";i[e]&&(n=e),ta(i[n])&&i[n](t)}}var Ja=function(){function e(e,t,i,n){void 0===i&&(i=!1);var a=this;a.messageId=e,a.message=(i?"AI: ":"AI (Internal): ")+e;var r="";Wa()&&(r=Ha().stringify(n));var s=(t?" message:"+Qa(t):"")+(n?" props:"+Qa(r):"");a.message+=s}return e.dataType="MessageData",e}();function Za(e,t){return(e||{}).logger||new er(t)}var er=function e(t){this.identifier="DiagnosticLogger",this.queue=[];var i=0,n={};Ri(e,this,(function(e){function a(e,i){var n=t[e];return $n(n)?i:n}$n(t)&&(t={}),e.consoleLoggingLevel=function(){return a("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return a("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return a("maxMessageLimit",25)},e.enableDebugExceptions=function(){return a("enableDebugExceptions",!1)},e.throwInternal=function(t,i,a,r,s){void 0===s&&(s=!1);var o=new Ja(i,a,s,r);if(e.enableDebugExceptions())throw o;var l=t===Ai.CRITICAL?"errorToConsole":"warnToConsole";if(!Qn(o.message)){var u=e.consoleLoggingLevel();if(s){var c=+o.messageId;!n[c]&&u>=t&&(e[l](o.message),n[c]=!0)}else u>=t&&e[l](o.message);e.logInternalMessage(t,o)}},e.warnToConsole=function(e){$a("warn",e)},e.errorToConsole=function(e){$a("error",e)},e.resetInternalMessageCount=function(){i=0,n={}},e.logInternalMessage=function(t,a){if(!(i>=e.maxInternalMessageLimit())){var r=!0,s="AITR_"+a.messageId;if(n[s]?r=!1:n[s]=!0,r&&(t<=e.telemetryLoggingLevel()&&(e.queue.push(a),i++),i===e.maxInternalMessageLimit())){var o="Internal events throttle limit per PageView reached for this app.",l=new Ja(Ji,o,!1);e.queue.push(l),e.warnToConsole(o)}}}}))},tr=function(){function e(t,i,n){var a,r=this,s=!1;(r.start=ya(),r.name=t,r.isAsync=n,r.isChildEvt=function(){return!1},ta(i))&&(s=ma(r,"payload",(function(){return!a&&ta(i)&&(a=i(),i=null),a})));r.getCtx=function(t){return t?t===e.ParentContextKey||t===e.ChildrenContextKey?r[t]:(r.ctx||{})[t]:null},r.setCtx=function(t,i){if(t)if(t===e.ParentContextKey)r[t]||(r.isChildEvt=function(){return!0}),r[t]=i;else if(t===e.ChildrenContextKey)r[t]=i;else{(r.ctx=r.ctx||{})[t]=i}},r.complete=function(){var t=0,n=r.getCtx(e.ChildrenContextKey);if(ra(n))for(var a=0;a<n.length;a++){var o=n[a];o&&(t+=o.time)}r.time=ya()-r.start,r.exTime=r.time-t,r.complete=function(){},!s&&ta(i)&&(r.payload=i())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),ir=function e(t){this.ctx={},Ri(e,this,(function(e){e.create=function(e,t,i){return new tr(e,t,i)},e.fire=function(e){e&&(e.complete(),t&&ta(t.perfEvent)&&t.perfEvent(e))},e.setCtx=function(t,i){t&&((e.ctx=e.ctx||{})[t]=i)},e.getCtx=function(t){return(e.ctx||{})[t]}}))};function nr(e,t,i,n,a){if(e){var r=e;if(ta(r.getPerfMgr)&&(r=r.getPerfMgr()),r){var s=void 0,o=r.getCtx("CoreUtils.doPerf");try{if(s=r.create(t(),n,a)){if(o&&s.setCtx&&(s.setCtx(tr.ParentContextKey,o),o.getCtx&&o.setCtx)){var l=o.getCtx(tr.ChildrenContextKey);l||(l=[],o.setCtx(tr.ChildrenContextKey,l)),l.push(s)}return r.setCtx("CoreUtils.doPerf",s),i(s)}}catch(e){s&&s.setCtx&&s.setCtx("exception",e)}finally{s&&r.fire(s),r.setCtx("CoreUtils.doPerf",o)}}}return i()}var ar=function(e,t){var i=this,n=null,a=ta(e.processTelemetry),r=ta(e.setNextPlugin);i._hasRun=!1,i.getPlugin=function(){return e},i.getNext=function(){return n},i.setNext=function(e){n=e},i.processTelemetry=function(s,o){o||(o=t);var l=e?e.identifier:"TelemetryPluginChain";nr(o?o.core():null,(function(){return l+":processTelemetry"}),(function(){if(e&&a){i._hasRun=!0;try{o.setNext(n),r&&e.setNextPlugin(n),n&&(n._hasRun=!1),e.processTelemetry(s,o)}catch(i){var t=n&&n._hasRun;n&&t||o.diagLog().throwInternal(Ai.CRITICAL,jn,"Plugin ["+e.identifier+"] failed during processTelemetry - "+Ga(i)),n&&!t&&n.processTelemetry(s,o)}}else n&&(i._hasRun=!0,n.processTelemetry(s,o))}),(function(){return{item:s}}),!s.sync)}};function rr(e,t){var i=[];if(e&&e.length>0)for(var n=null,a=0;a<e.length;a++){var r=e[a];if(r&&ta(r.processTelemetry)){var s=new ar(r,t);i.push(s),n&&n.setNext(s),n=s}}return i.length>0?i[0]:null}var sr=function e(t,i,n,a){var r=this,s=null;null!==a&&(t&&ta(t.getPlugin)?s=function(e,t,i){var n=[],a=!i;if(e)for(;e;){var r=e.getPlugin();(a||r===i)&&(a=!0,n.push(r)),e=e.getNext()}return a||n.push(i),rr(n,t)}(t,r,a||t.getPlugin()):a?s=function(e,t,i){var n=e,a=!1;return i&&e&&(n=[],ca(e,(function(e){(a||e===i)&&(a=!0,n.push(e))}))),i&&!a&&(n||(n=[]),n.push(i)),rr(n,t)}(t,r,a):Qn(a)&&(s=rr(t,r))),r.core=function(){return n},r.diagLog=function(){return Za(n,i)},r.getCfg=function(){return i},r.getExtCfg=function(e,t){var n;if(void 0===t&&(t={}),i){var a=i.extensionConfig;a&&e&&(n=a[e])}return n||t},r.getConfig=function(e,t,n){var a;void 0===n&&(n=!1);var s=r.getExtCfg(e,null);return s&&!$n(s[t])?a=s[t]:i&&!$n(i[t])&&(a=i[t]),$n(a)?n:a},r.hasNext=function(){return null!=s},r.getNext=function(){return s},r.setNext=function(e){s=e},r.processNext=function(e){var t=s;t&&(s=t.getNext(),t.processTelemetry(e,r))},r.createNew=function(t,a){return void 0===t&&(t=null),new e(t||s,i,n,a)}},or=function(){function e(){var e=this,t=!1,i=null,n=null;e.core=null,e.diagLog=function(t){return e._getTelCtx(t).diagLog()},e.isInitialized=function(){return t},e.setInitialized=function(e){t=e},e.setNextPlugin=function(e){n=e},e.processNext=function(e,t){t?t.processNext(e):n&&ta(n.processTelemetry)&&n.processTelemetry(e,null)},e._getTelCtx=function(t){void 0===t&&(t=null);var a=t;if(!a){var r=i||new sr(null,{},e.core);a=n&&n.getPlugin?r.createNew(null,n.getPlugin):r.createNew(null,n)}return a},e._baseTelInit=function(a,r,s,o){a&&Ta(a,"extensionConfig",[],null,$n),!o&&r&&(o=r.getProcessTelContext().getNext());var l=n;n&&n.getPlugin&&(l=n.getPlugin()),e.core=r,i=new sr(o,a,r,l),t=!0}}return e.prototype.initialize=function(e,t,i,n){this._baseTelInit(e,t,i,n)},e}();function lr(e,t){for(var i=[],n=null,a=e.getNext();a;){var r=a.getPlugin();r&&(n&&ta(n.setNextPlugin)&&ta(r.processTelemetry)&&n.setNextPlugin(r),ta(r.isInitialized)&&r.isInitialized()||i.push(r),n=r,a=a.getNext())}ca(i,(function(i){i.initialize(e.getCfg(),e.core(),t,e.getNext())}))}function ur(e){return e.sort((function(e,t){var i=0,n=ta(t.processTelemetry);return ta(e.processTelemetry)?i=n?e.priority-t.priority:1:n&&(i=-1),i}))}var cr=function(e){function t(){var i,n=e.call(this)||this;function a(e){e&&e.length>0&&(function(e){ca(e,(function(e){e.priority<500&&Pa("Channel has invalid priority"+e.identifier)}))}(e=e.sort((function(e,t){return e.priority-t.priority}))),i.push(e))}return n.identifier="ChannelControllerPlugin",n.priority=500,Ri(t,n,(function(e,t){e.setNextPlugin=function(e){},e.processTelemetry=function(e,t){i&&ca(i,(function(i){i.length>0&&n._getTelCtx(t).createNew(i).processNext(e)}))},e.getChannelControls=function(){return i},e.initialize=function(n,r,s){e.isInitialized()||(t.initialize(n,r,s),function(e,t){i=[],e&&ca(e,(function(e){return a(e)}));if(t){var n=[];ca(t,(function(e){e.priority>500&&n.push(e)})),a(n)}}((n||{}).channels,s),ca(i,(function(e){return lr(new sr(e,n,r),s)})))}})),n}var i;return di(t,e),t._staticInit=(ma(i=t.prototype,"ChannelControls",i.getChannelControls),void ma(i,"channelQueue",i.getChannelControls)),t}(or),dr=null,hr=null,gr=null,pr=Na(),vr={},fr={};function mr(e){return!e||e.isEnabled()}function yr(e,t){var i;if(e)i=e.getCookieMgr();else if(t){var n=t.cookieCfg;i=n._ckMgr?n._ckMgr:br(t)}return i||(i=function(e,t){var i=br._ckMgr||fr._ckMgr;return i||(i=br._ckMgr=br(e,t),fr._ckMgr=i),i}(t,(e||{}).logger)),i}function br(e,t){var i=function(e){var t=e.cookieCfg=e.cookieCfg||{};if(Ta(t,"domain",e.cookieDomain,Jn,$n),Ta(t,"path",e.cookiePath||"/",null,$n),$n(t.enabled)){var i=void 0;Qn(e.isCookieUseDisabled)||(i=!e.isCookieUseDisabled),Qn(e.disableCookiesUsage)||(i=!e.disableCookiesUsage),t.enabled=i}return t}(e||fr),n=i.path||"/",a=i.domain,r=!1!==i.enabled,s={isEnabled:function(){var e=r&&Tr(t),i=fr._ckMgr;return e&&i&&s!==i&&(e=mr(i)),e},setEnabled:function(e){r=!1!==e},set:function(e,t,r,o,l){var u=!1;if(mr(s)){var c={},d=ga(t||""),h=d.indexOf(";");if(-1!==h&&(d=ga(t.substring(0,h)),c=kr(t.substring(h+1))),Ta(c,"domain",o||a,Ea,Qn),!$n(r)){var g=ja();if(Qn(c.expires)){var p=ya()+1e3*r;if(p>0){var v=new Date;v.setTime(p),Ta(c,"expires",Sr(v,g?"toGMTString":"toUTCString")||Sr(v,g?"toGMTString":"toUTCString")||"",Ea)}}g||Ta(c,"max-age",""+r,null,Qn)}var f=Fa();f&&"https:"===f.protocol&&(Ta(c,"secure",null,null,Qn),null===hr&&(hr=!function(e){if(!oa(e))return!1;if(aa(e,"CPU iPhone OS 12")||aa(e,"iPad; CPU OS 12"))return!0;if(aa(e,"Macintosh; Intel Mac OS X 10_14")&&aa(e,"Version/")&&aa(e,"Safari"))return!0;if(aa(e,"Macintosh; Intel Mac OS X 10_14")&&function(e,t){if(e&&t){var i=t.length,n=e.length;if(e===t)return!0;if(n>=i){for(var a=n-1,r=i-1;r>=0;r--){if(e[a]!=t[r])return!1;a--}return!0}}return!1}(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))return!0;if(aa(e,"Chrome/5")||aa(e,"Chrome/6"))return!0;if(aa(e,"UnrealEngine")&&!aa(e,"Chrome"))return!0;if(aa(e,"UCBrowser/12")||aa(e,"UCBrowser/11"))return!0;return!1}((Ua()||{}).userAgent)),hr&&Ta(c,"SameSite","None",null,Qn)),Ta(c,"path",l||n,null,Qn),(i.setCookie||Cr)(e,Er(d,c)),u=!0}return u},get:function(e){var t="";return mr(s)&&(t=(i.getCookie||Pr)(e)),t},del:function(e,t){var i=!1;return mr(s)&&(i=s.purge(e,t)),i},purge:function(e,n){var a,r=!1;if(Tr(t)){var s=((a={}).path=n||"/",a.expires="Thu, 01 Jan 1970 00:00:01 GMT",a);ja()||(s["max-age"]="0"),(i.delCookie||Cr)(e,Er("",s)),r=!0}return r}};return s._ckMgr=s,s}function Tr(e){if(null===dr){dr=!1;try{dr=void 0!==(pr||{}).cookie}catch(t){e&&e.throwInternal(Ai.WARNING,Bn,"Cannot access document.cookie - "+ba(t),{exception:Ga(t)})}}return dr}function kr(e){var t={};e&&e.length&&ca(ga(e).split(";"),(function(e){if(e=ga(e||"")){var i=e.indexOf("=");-1===i?t[e]=null:t[ga(e.substring(0,i))]=ga(e.substring(i+1))}}));return t}function Sr(e,t){return ta(e[t])?e[t]():null}function Er(e,t){var i=e||"";return na(t,(function(e,t){i+="; "+e+($n(t)?"":"="+t)})),i}function Pr(e){var t="";if(pr){var i=pr.cookie||"";gr!==i&&(vr=kr(i),gr=i),t=ga(vr[e]||"")}return t}function Cr(e,t){pr&&(pr.cookie=e+"="+t)}function Ir(e,t){return new ir(t)}var wr=function e(t){this.listeners=[];var i=!!(t||{}).perfEvtsSendAll;Ri(e,this,(function(e){e.addNotificationListener=function(t){e.listeners.push(t)},e.removeNotificationListener=function(t){for(var i=da(e.listeners,t);i>-1;)e.listeners.splice(i,1),i=da(e.listeners,t)},e.eventsSent=function(t){ca(e.listeners,(function(e){e&&e.eventsSent&&setTimeout((function(){return e.eventsSent(t)}),0)}))},e.eventsDiscarded=function(t,i){ca(e.listeners,(function(e){e&&e.eventsDiscarded&&setTimeout((function(){return e.eventsDiscarded(t,i)}),0)}))},e.eventsSendRequest=function(t,i){ca(e.listeners,(function(e){if(e&&e.eventsSendRequest)if(i)setTimeout((function(){return e.eventsSendRequest(t,i)}),0);else try{e.eventsSendRequest(t,i)}catch(e){}}))},e.perfEvent=function(t){t&&(!i&&t.isChildEvt()||ca(e.listeners,(function(e){if(e&&e.perfEvent)if(t.isAsync)setTimeout((function(){return e.perfEvent(t)}),0);else try{e.perfEvent(t)}catch(e){}})))}}))},Rr=function(e){function t(){var i=e.call(this)||this,n=0;return Ri(t,i,(function(e,t){function i(t){var i=e.getNotifyMgr();i&&i.eventsDiscarded([t],Zt)}e.initialize=function(e,i,n,a){t.initialize(e,i,n||new er(e),a||new wr(e))},e.track=function(n){nr(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){null===n&&(i(n),Pa("Invalid telemetry item")),function(e){if($n(e.name))throw i(e),Error("telemetry name required")}(n),t.track(n)}),(function(){return{item:n}}),!n.sync)},e.addNotificationListener=function(t){var i=e.getNotifyMgr();i&&i.addNotificationListener(t)},e.removeNotificationListener=function(t){var i=e.getNotifyMgr();i&&i.removeNotificationListener(t)},e.pollInternalLogs=function(t){var i=e.config.diagnosticLogInterval;return i&&i>0||(i=1e4),n&&e.stopPollingInternalLogs(),n=setInterval((function(){var i=e.logger?e.logger.queue:[];ca(i,(function(i){var n={name:t||"InternalMessageId: "+i.messageId,iKey:e.config.instrumentationKey,time:ua(new Date),baseType:Ja.dataType,baseData:{message:i.message}};e.track(n)})),i.length=0}),i)},e.stopPollingInternalLogs=function(){n&&(clearInterval(n),n=0)}})),i}return di(t,e),t}((function e(){var t,i,n,a,r,s=!1;Ri(e,this,(function(e){e._extensions=new Array,i=new cr,e.logger=new er({loggingLevelConsole:Ai.CRITICAL}),t=[],e.isInitialized=function(){return s},e.initialize=function(t,a,r,o){e.isInitialized()&&Pa("Core should not be initialized more than once"),t&&!$n(t.instrumentationKey)||Pa("Please provide instrumentation key"),n=o,e._notificationManager=o,e.config=t||{},e.config.enablePerfMgr&&Ta(e.config,"createPerfMgr",Ir),t.extensions=$n(t.extensions)?[]:t.extensions,ka(t,"extensionConfig").NotificationManager=o,r&&(e.logger=r);var l=[];l.push.apply(l,hi(hi([],a),t.extensions)),l=ur(l);var u=[],c={};ca(l,(function(e){($n(e)||$n(e.initialize))&&Pa("Extensions must provide callback to initialize");var t=e.priority,n=e.identifier;e&&t&&($n(c[t])?c[t]=n:r.warnToConsole("Two extensions have same priority #"+t+" - "+c[t]+", "+n)),(!t||t<i.priority)&&u.push(e)})),l.push(i),u.push(i),l=ur(l),e._extensions=l,lr(new sr([i],t,e),l),lr(new sr(u,t,e),l),e._extensions=u,0===e.getTransmissionControls().length&&Pa("No channels available"),s=!0,e.releaseQueue()},e.getTransmissionControls=function(){return i.getChannelControls()},e.track=function(i){Ta(i,"iKey",e.config.instrumentationKey,null,Sa),Ta(i,"time",ua(new Date),null,Sa),Ta(i,"ver","4.0",null,$n),e.isInitialized()?e.getProcessTelContext().processNext(i):t.push(i)},e.getProcessTelContext=function(){var t=e._extensions,n=t;return t&&0!==t.length||(n=[i]),new sr(n,e.config,e)},e.getNotifyMgr=function(){return n||(n=li({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,t){},eventsSendRequest:function(e,t){}}),e._notificationManager=n),n},e.getCookieMgr=function(){return r||(r=br(e.config,e.logger)),r},e.setCookieMgr=function(e){r=e},e.getPerfMgr=function(){return a||e.config&&e.config.enablePerfMgr&&ta(e.config.createPerfMgr)&&(a=e.config.createPerfMgr(e,e.getNotifyMgr())),a||null},e.setPerfMgr=function(e){a=e},e.eventCnt=function(){return t.length},e.releaseQueue=function(){t.length>0&&(ca(t,(function(t){e.getProcessTelContext().processNext(t)})),t=[])}}))})),Ar=!1,xr=123456789,Dr=987654321;function Lr(){try{var e=2147483647&ya();(t=(4294967296*Math.random()^e)+e)<0&&(t>>>=0),xr=123456789+t&4294967295,Dr=987654321-t&4294967295,Ar=!0}catch(e){}var t}function _r(e){var t,i=Da("crypto")||Da("msCrypto");return i&&i.getRandomValues?t=4294967295&i.getRandomValues(new Uint32Array(1))[0]:ja()?(Ar||Lr(),t=4294967295&function(e){var t=((Dr=36969*(65535&Dr)+(Dr>>16)&4294967295)<<16)+(65535&(xr=18e3*(65535&xr)+(xr>>16)&4294967295))>>>0&4294967295|0;e||(t>>>=0);return t}()):t=Math.floor(4294967296*Math.random()|0),e||(t>>>=0),t}function Mr(e,t){var i=!1,n=_a();n&&(i=ia(n,e,t),i=ia(n.body,e,t)||i);var a=Na();return a&&(i=ia(a,e,t)||i),i}function Nr(e,t,i){var n=!1;if(t&&e&&ra(e)){var a=[];ca(e,(function(e){oa(e)&&(i&&-1!==da(i,e)?a.push(e):n=Mr(e,t)||n)})),!n&&a.length>0&&(n=Nr(a,t))}return n}function Or(e,t){return Nr(["beforeunload","unload","pagehide"],e,t)}function Ur(e,t){var i=!1;return t&&-1!==da(t,"pagehide")||(i=Mr("pagehide",e)),t&&-1!==da(t,"visibilitychange")||(i=Mr("visibilitychange",(function(t){var i=Na();e&&i&&"hidden"===i.visibilityState&&e(t)}))||i),!i&&t&&(i=Ur(e)),i}function Br(e){void 0===e&&(e=22);for(var t=_r()>>>0,i=0,n="";n.length<e;)i++,n+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(63&t),t>>>=6,5===i&&(t=(_r()<<2&4294967295|3&t)>>>0,i=0);return n}function Fr(){for(var e,t=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],i="",n=0;n<4;n++)i+=t[15&(e=_r())]+t[e>>4&15]+t[e>>8&15]+t[e>>12&15]+t[e>>16&15]+t[e>>20&15]+t[e>>24&15]+t[e>>28&15];var a=t[8+(3&_r())|0];return i.substr(0,8)+i.substr(9,4)+"4"+i.substr(13,3)+a+i.substr(16,3)+i.substr(19,12)}var Vr=["req","rsp","hkErr","fnErr"];function Wr(e,t){if(e)for(var i=0;i<e.length&&!t(e[i],i);i++);}function Hr(e,t,i,n,a){a>=0&&a<=2&&Wr(e,(function(e,r){var s=e.cbks,o=s[Vr[a]];if(o){t.ctx=function(){return n[r]=n[r]||{}};try{o.apply(t.inst,i)}catch(e){var l=t.err;try{var u=s[Vr[2]];u&&(t.err=e,u.apply(t.inst,i))}catch(e){}finally{t.err=l}}}}))}var jr=Object.getPrototypeOf;function qr(e,t,i){var n=null;return e&&(Zn(e,t)?n=e:i&&(n=qr(function(e){if(e){if(jr)return jr(e);var t=e.__proto__||e.prototype||e.constructor;if(t)return t}return null}(e),t,!1))),n}function Gr(e,t,i,n){if(void 0===n&&(n=!0),e&&t&&i){var a=qr(e,t,n);if(a){var r=a[t];if("function"==typeof r){var s=r._aiHooks;if(!s){var o=(u=s={i:0,n:t,f:r,h:[]},function(){var e=this,t=arguments,i=u.h,n={name:u.n,inst:e,ctx:null,set:o},a=[],r=s([n],t);function s(e,t){return Wr(t,(function(t){e.push(t)})),e}function o(e,i){(t=s([],t))[e]=i,r=s([n],t)}Hr(i,n,r,a,0);var l=u.f;try{n.rslt=l.apply(e,t)}catch(e){throw n.err=e,Hr(i,n,r,a,3),e}return Hr(i,n,r,a,1),n.rslt});o._aiHooks=s,a[t]=o}var l={id:s.i,cbks:i,rm:function(){var e=this.id;Wr(s.h,(function(t,i){if(t.id===e)return s.h.splice(i,1),1}))}};return s.i++,s.h.push(l),l}}}var u;return null}var Kr="Request-Context",zr="appId",Xr="appId=cid-v1:",Yr="Request-Id",Qr="traceparent",$r="Sdk-Context",Jr="appId",Zr="request-context";function es(e,t,i){var n,a=t.length,r=function(e,t){var i;t&&(t=ga(t.toString())).length>150&&(i=t.substring(0,150),e&&e.throwInternal(Ai.WARNING,An,"name is too long.  It has been truncated to 150 characters.",{name:t},!0));return i||t}(e,t);if(r.length!==a){for(var s=0,o=r;void 0!==i[o];)s++,o=r.substring(0,147)+(n=void 0,(n="00"+s).substr(n.length-3));r=o}return r}function ts(e,t,i){var n;return void 0===i&&(i=1024),t&&(i=i||1024,(t=ga(t)).toString().length>i&&(n=t.toString().substring(0,i),e&&e.throwInternal(Ai.WARNING,Ln,"string value is too long. It has been truncated to "+i+" characters.",{value:t},!0))),n||t}function is(e,t){return ss(e,t,2048,On)}function ns(e,t){var i;return t&&t.length>32768&&(i=t.substring(0,32768),e&&e.throwInternal(Ai.WARNING,Rn,"message is too long, it has been truncated to 32768 characters.",{message:t},!0)),i||t}function as(e,t){if(t){var i={};na(t,(function(t,n){if(ea(n)&&Wa())try{n=Ha().stringify(n)}catch(t){e&&e.throwInternal(Ai.WARNING,En,"custom property is not valid",{exception:t},!0)}n=ts(e,n,8192),t=es(e,t,i),i[t]=n})),t=i}return t}function rs(e,t){if(t){var i={};na(t,(function(t,n){t=es(e,t,i),i[t]=n})),t=i}return t}function ss(e,t,i,n){var a;return t&&(t=ga(t)).length>i&&(a=t.substring(0,i),e&&e.throwInternal(Ai.WARNING,n,"input is too long, it has been truncated to "+i+" characters.",{data:t},!0)),a||t}function os(e){var t=null;if(ta(Event))t=new Event(e);else{var i=Na();i&&i.createEvent&&(t=i.createEvent("Event")).initEvent(e,!0,!0)}return t}function ls(e,t){return void 0===t&&(t=!1),null==e?t:"true"===e.toString().toLowerCase()}function us(e){(isNaN(e)||e<0)&&(e=0);var t=""+(e=Math.round(e))%1e3,i=""+Math.floor(e/1e3)%60,n=""+Math.floor(e/6e4)%60,a=""+Math.floor(e/36e5)%24,r=Math.floor(e/864e5);return t=1===t.length?"00"+t:2===t.length?"0"+t:t,i=i.length<2?"0"+i:i,n=n.length<2?"0"+n:n,(r>0?r+".":"")+(a=a.length<2?"0"+a:a)+":"+n+":"+i+"."+t}var cs,ds,hs="Microsoft_ApplicationInsights_BypassAjaxInstrumentation";!function(e){e[e.LocalStorage=0]="LocalStorage",e[e.SessionStorage=1]="SessionStorage"}(cs||(cs={})),function(e){e[e.AI=0]="AI",e[e.AI_AND_W3C=1]="AI_AND_W3C",e[e.W3C=2]="W3C"}(ds||(ds={}));var gs=void 0,ps=void 0;function vs(){return ys()?fs(cs.LocalStorage):null}function fs(e){try{if($n(si()))return null;var t=new Date,i=Da(e===cs.LocalStorage?"localStorage":"sessionStorage");i.setItem(t.toString(),t.toString());var n=i.getItem(t.toString())!==t.toString();if(i.removeItem(t.toString()),!n)return i}catch(e){}return null}function ms(){return bs()?fs(cs.SessionStorage):null}function ys(){return void 0===gs&&(gs=!!fs(cs.LocalStorage)),gs}function bs(){return void 0===ps&&(ps=!!fs(cs.SessionStorage)),ps}function Ts(e,t){var i=ms();if(null!==i)try{return i.getItem(t)}catch(t){ps=!1,e.throwInternal(Ai.WARNING,Li,"Browser failed read of session storage. "+ba(t),{exception:Ga(t)})}return null}function ks(e,t,i){var n=ms();if(null!==n)try{return n.setItem(t,i),!0}catch(t){ps=!1,e.throwInternal(Ai.WARNING,Mi,"Browser failed write to session storage. "+ba(t),{exception:Ga(t)})}return!1}var Ss=Na()||{},Es=0,Ps=[null,null,null,null,null];function Cs(e){var t=Es,i=Ps,n=i[t];return Ss.createElement?i[t]||(n=i[t]=Ss.createElement("a")):n={host:Is(e,!0)},n.href=e,++t>=i.length&&(t=0),Es=t,n}function Is(e,t){var i=ws(e,t)||"";if(i){var n=i.match(/(www[0-9]?\.)?(.[^/:]+)(\:[\d]+)?/i);if(null!=n&&n.length>3&&oa(n[2])&&n[2].length>0)return n[2]+(n[3]||"")}return i}function ws(e,t){var i=null;if(e){var n=e.match(/(\w*):\/\/(.[^/:]+)(\:[\d]+)?/i);if(null!=n&&n.length>2&&oa(n[2])&&n[2].length>0&&(i=n[2]||"",t&&n.length>2)){var a=(n[1]||"").toLowerCase(),r=n[3]||"";("http"===a&&":80"===r||"https"===a&&":443"===r)&&(r=""),i+=r}}return i}var Rs=["https://dc.services.visualstudio.com/v2/track","https://breeze.aimon.applicationinsights.io/v2/track","https://dc-int.services.visualstudio.com/v2/track"];function As(e){return-1!==Rs.indexOf(e.toLowerCase())}var xs={correlationIdPrefix:"cid-v1:",canIncludeCorrelationHeader:function(e,t,i){if(!t||e&&e.disableCorrelationHeaders)return!1;if(e&&e.correlationHeaderExcludePatterns)for(var n=0;n<e.correlationHeaderExcludePatterns.length;n++)if(e.correlationHeaderExcludePatterns[n].test(t))return!1;var a=Cs(t).host.toLowerCase();if(!a||-1===a.indexOf(":443")&&-1===a.indexOf(":80")||(a=(ws(t,!0)||"").toLowerCase()),(!e||!e.enableCorsCorrelation)&&a&&a!==i)return!1;var r,s=e&&e.correlationHeaderDomains;if(s&&(ca(s,(function(e){var t=new RegExp(e.toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*"));r=r||t.test(a)})),!r))return!1;var o=e&&e.correlationHeaderExcludedDomains;if(!o||0===o.length)return!0;for(n=0;n<o.length;n++){if(new RegExp(o[n].toLowerCase().replace(/\\/g,"\\\\").replace(/\./g,"\\.").replace(/\*/g,".*")).test(a))return!1}return a&&a.length>0},getCorrelationContext:function(e){if(e){var t=xs.getCorrelationContextValue(e,zr);if(t&&t!==xs.correlationIdPrefix)return t}},getCorrelationContextValue:function(e,t){if(e)for(var i=e.split(","),n=0;n<i.length;++n){var a=i[n].split("=");if(2===a.length&&a[0]===t)return a[1]}}};function Ds(){var e=Va();if(e&&e.now&&e.timing){var t=e.now()+e.timing.navigationStart;if(t>0)return t}return ya()}function Ls(e,t){var i=null;return 0===e||0===t||$n(e)||$n(t)||(i=t-e),i}var _s=function(e){function t(){return e.call(this)||this}return di(t,e),t}((function(){})),Ms=function(e){function t(t,i,n){var a=e.call(this)||this;return a.name=ts(t,n)||"not_specified",a.data=i,a.time=ua(new Date),a.aiDataContract={time:1,iKey:1,name:1,sampleRate:function(){return 100===a.sampleRate?4:1},tags:1,data:1},a}return di(t,e),t}((function(){this.ver=1,this.sampleRate=100,this.tags={}})),Ns=function(){this.ver=2,this.properties={},this.measurements={}},Os=function(e){function t(t,i,n,a){var r=e.call(this)||this;return r.aiDataContract={ver:1,name:1,properties:0,measurements:0},r.name=ts(t,i)||"not_specified",r.properties=as(t,n),r.measurements=rs(t,a),r}return di(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.Event",t.dataType="EventData",t}(Ns),Us=function(){},Bs=function(){this.hasFullStack=!0,this.parsedStack=[]};function Fs(e,t){var i=e;return i&&!oa(i)&&(JSON&&JSON.stringify?(i=JSON.stringify(e),!t||i&&"{}"!==i||(i=ta(e.toString)?e.toString():""+e)):i=e+" - (Missing JSON.stringify)"),i||""}function Vs(e,t){var i=e;return e&&(i&&!oa(i)&&(i=e.message||e.description||i),i&&!oa(i)&&(i=Fs(i,!0)),e.filename&&(i=i+" @"+(e.filename||"")+":"+(e.lineno||"?")+":"+(e.colno||"?"))),t&&"String"!==t&&"Object"!==t&&"Error"!==t&&-1===(i||"").indexOf(t)&&(i=t+": "+i),i||""}function Ws(e){return e&&e.src&&oa(e.src)&&e.obj&&ra(e.obj)}function Hs(e){var t=e||"";oa(t)||(t=oa(t.stack)?t.stack:""+t);var i=t.split("\n");return{src:t,obj:i}}function js(e){var t=null;if(e)try{if(e.stack)t=Hs(e.stack);else if(e.error&&e.error.stack)t=Hs(e.error.stack);else if(e.exception&&e.exception.stack)t=Hs(e.exception.stack);else if(Ws(e))t=e;else if(Ws(e.stackDetails))t=e.stackDetails;else if(window.opera&&e.message)t=function(e){for(var t=[],i=e.split("\n"),n=0;n<i.length;n++){var a=i[n];i[n+1]&&(a+="@"+i[n+1],n++),t.push(a)}return{src:e,obj:t}}(e.message);else if(oa(e))t=Hs(e);else{var i=e.message||e.description||"";oa(e.errorSrc)&&(i&&(i+="\n"),i+=" from "+e.errorSrc),i&&(t=Hs(i))}}catch(e){t=Hs(e)}return t||{src:"",obj:null}}function qs(e){var t="";if(e&&!(t=e.typeName||e.name||""))try{var i=/function (.{1,200})\(/.exec(e.constructor.toString());t=i&&i.length>1?i[1]:""}catch(e){}return t}function Gs(e){if(e)try{if(!oa(e)){var t=qs(e),i=Fs(e,!1);return i&&"{}"!==i||(e.error&&(t=qs(e=e.error)),i=Fs(e,!0)),0!==i.indexOf(t)&&"String"!==t?t+":"+i:i}}catch(e){}return""+(e||"")}var Ks,zs=function(e){function t(t,i,n,a,r,s){var o=e.call(this)||this;return o.aiDataContract={ver:1,exceptions:1,severityLevel:0,properties:0,measurements:0},!function(e){try{if(ea(e))return"ver"in e&&"exceptions"in e&&"properties"in e}catch(e){}return!1}(i)?(n||(n={}),o.exceptions=[new Xs(t,i,n)],o.properties=as(t,n),o.measurements=rs(t,a),r&&(o.severityLevel=r),s&&(o.id=s)):(o.exceptions=i.exceptions,o.properties=i.properties,o.measurements=i.measurements,i.severityLevel&&(o.severityLevel=i.severityLevel),i.id&&(o.id=i.id),i.problemGroup&&(o.problemGroup=i.problemGroup),o.ver=2,$n(i.isManual)||(o.isManual=i.isManual)),o}return di(t,e),t.CreateAutoException=function(e,t,i,n,a,r,s,o){var l=qs(a||r||e);return{message:Vs(e,l),url:t,lineNumber:i,columnNumber:n,error:Gs(a||r||e),evt:Gs(r||e),typeName:l,stackDetails:js(s||a||r),errorSrc:o}},t.CreateFromInterface=function(e,i,n,a){var r=i.exceptions&&ha(i.exceptions,(function(t){return Xs.CreateFromInterface(e,t)}));return new t(e,ui(ui({},i),{exceptions:r}),n,a)},t.prototype.toInterface=function(){var e=this,t=e.exceptions,i=e.properties,n=e.measurements,a=e.severityLevel;e.ver;var r=e.problemGroup,s=e.id,o=e.isManual;return{ver:"4.0",exceptions:t instanceof Array&&ha(t,(function(e){return e.toInterface()}))||void 0,severityLevel:a,properties:i,measurements:n,problemGroup:r,id:s,isManual:o}},t.CreateSimpleException=function(e,t,i,n,a,r){return{exceptions:[{hasFullStack:!0,message:e,stack:a,typeName:t}]}},t.envelopeType="Microsoft.ApplicationInsights.{0}.Exception",t.dataType="ExceptionData",t.formatError=Gs,t}((function(){this.ver=2,this.exceptions=[],this.properties={},this.measurements={}})),Xs=function(e){function t(t,i,n){var a=e.call(this)||this;if(a.aiDataContract={id:0,outerId:0,typeName:1,message:1,hasFullStack:0,stack:0,parsedStack:2},function(e){try{if(ea(e))return"hasFullStack"in e&&"typeName"in e}catch(e){}return!1}(i))a.typeName=i.typeName,a.message=i.message,a.stack=i.stack,a.parsedStack=i.parsedStack,a.hasFullStack=i.hasFullStack;else{var r=i,s=r&&r.evt;sa(r)||(r=r.error||s||r),a.typeName=ts(t,qs(r))||"not_specified",a.message=ns(t,Vs(i||r,a.typeName))||"not_specified";var o=i.stackDetails||js(i);a.parsedStack=function(e){var t,i=e.obj;if(i&&i.length>0){t=[];var n=0,a=0;if(ca(i,(function(e){var i=e.toString();if(Ys.regex.test(i)){var r=new Ys(i,n++);a+=r.sizeInBytes,t.push(r)}})),a>32768)for(var r=0,s=t.length-1,o=0,l=r,u=s;r<s;){if((o+=t[r].sizeInBytes+t[s].sizeInBytes)>32768){var c=u-l+1;t.splice(l,c);break}l=r,u=s,r++,s--}}return t}(o),a.stack=function(e,t){var i;if(t){var n=""+t;n.length>32768&&(i=n.substring(0,32768),e&&e.throwInternal(Ai.WARNING,Cn,"exception is too long, it has been truncated to 32768 characters.",{exception:t},!0))}return i||t}(t,function(e){var t="";return e&&(e.obj?ca(e.obj,(function(e){t+=e+"\n"})):t=e.src||""),t}(o)),a.hasFullStack=ra(a.parsedStack)&&a.parsedStack.length>0,n&&(n.typeName=n.typeName||a.typeName)}return a}return di(t,e),t.prototype.toInterface=function(){var e=this.parsedStack instanceof Array&&ha(this.parsedStack,(function(e){return e.toInterface()}));return{id:this.id,outerId:this.outerId,typeName:this.typeName,message:this.message,hasFullStack:this.hasFullStack,stack:this.stack,parsedStack:e||void 0}},t.CreateFromInterface=function(e,i){var n=i.parsedStack instanceof Array&&ha(i.parsedStack,(function(e){return Ys.CreateFromInterface(e)}))||i.parsedStack;return new t(e,ui(ui({},i),{parsedStack:n}))},t}(Bs),Ys=function(e){function t(i,n){var a=e.call(this)||this;if(a.sizeInBytes=0,a.aiDataContract={level:1,method:1,assembly:0,fileName:0,line:0},"string"==typeof i){var r=i;a.level=n,a.method="<no_method>",a.assembly=ga(r),a.fileName="",a.line=0;var s=r.match(t.regex);s&&s.length>=5&&(a.method=ga(s[2])||a.method,a.fileName=ga(s[4]),a.line=parseInt(s[5])||0)}else a.level=i.level,a.method=i.method,a.assembly=i.assembly,a.fileName=i.fileName,a.line=i.line,a.sizeInBytes=0;return a.sizeInBytes+=a.method.length,a.sizeInBytes+=a.fileName.length,a.sizeInBytes+=a.assembly.length,a.sizeInBytes+=t.baseSize,a.sizeInBytes+=a.level.toString().length,a.sizeInBytes+=a.line.toString().length,a}return di(t,e),t.CreateFromInterface=function(e){return new t(e,null)},t.prototype.toInterface=function(){return{level:this.level,method:this.method,assembly:this.assembly,fileName:this.fileName,line:this.line}},t.regex=/^([\s]+at)?[\s]{0,50}([^\@\()]+?)[\s]{0,50}(\@|\()([^\(\n]+):([0-9]+):([0-9]+)(\)?)$/,t.baseSize=58,t}(Us),Qs=function(){this.ver=2,this.metrics=[],this.properties={},this.measurements={}};!function(e){e[e.Measurement=0]="Measurement",e[e.Aggregation=1]="Aggregation"}(Ks||(Ks={}));var $s,Js=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.aiDataContract={name:1,kind:0,value:1,count:0,min:0,max:0,stdDev:0},t}return di(t,e),t}((function(){this.kind=Ks.Measurement})),Zs=function(e){function t(t,i,n,a,r,s,o,l,u){var c=e.call(this)||this;c.aiDataContract={ver:1,metrics:1,properties:0};var d=new Js;return d.count=a>0?a:void 0,d.max=isNaN(s)||null===s?void 0:s,d.min=isNaN(r)||null===r?void 0:r,d.name=ts(t,i)||"not_specified",d.value=n,d.stdDev=isNaN(o)||null===o?void 0:o,c.metrics=[d],c.properties=as(t,l),c.measurements=rs(t,u),c}return di(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.Metric",t.dataType="MetricData",t}(Qs),eo=function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return di(t,e),t}(Ns),to=function(e){function t(t,i,n,a,r,s,o){var l=e.call(this)||this;return l.aiDataContract={ver:1,name:0,url:0,duration:0,properties:0,measurements:0,id:0},l.id=function(e,t){return t?ss(e,t,128,Fn).toString():t}(t,o),l.url=is(t,n),l.name=ts(t,i)||"not_specified",isNaN(a)||(l.duration=us(a)),l.properties=as(t,r),l.measurements=rs(t,s),l}return di(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.Pageview",t.dataType="PageviewData",t}(eo),io=function(e){function t(t,i,n,a,r,s,o,l,u,c,d,h){void 0===u&&(u="Ajax");var g=e.call(this)||this;g.aiDataContract={id:1,ver:1,name:0,resultCode:0,duration:0,success:0,data:0,target:0,type:0,properties:0,measurements:0,kind:0,value:0,count:0,min:0,max:0,stdDev:0,dependencyKind:0,dependencySource:0,commandName:0,dependencyTypeName:0},g.id=i,g.duration=us(r),g.success=s,g.resultCode=o+"",g.type=ts(t,u);var p=function(e,t,i,n){var a,r=n,s=n;if(t&&t.length>0){var o=Cs(t);if(a=o.host,!r)if(null!=o.pathname){var l=0===o.pathname.length?"/":o.pathname;"/"!==l.charAt(0)&&(l="/"+l),s=o.pathname,r=ts(e,i?i+" "+l:l)}else r=ts(e,t)}else a=n,r=n;return{target:a,name:r,data:s}}(t,n,l,a);return g.data=is(t,a)||p.data,g.target=ts(t,p.target),c&&(g.target=g.target+" | "+c),g.name=ts(t,p.name),g.properties=as(t,d),g.measurements=rs(t,h),g}return di(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.RemoteDependency",t.dataType="RemoteDependencyData",t}((function(){this.ver=2,this.success=!0,this.properties={},this.measurements={}})),no=function(e){function t(t,i,n,a,r){var s=e.call(this)||this;return s.aiDataContract={ver:1,message:1,severityLevel:0,properties:0},i=i||"not_specified",s.message=ns(t,i),s.properties=as(t,a),s.measurements=rs(t,r),n&&(s.severityLevel=n),s}return di(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.Message",t.dataType="MessageData",t}((function(){this.ver=2,this.properties={},this.measurements={}})),ao=function(e){function t(t,i,n,a,r,s,o){var l=e.call(this)||this;return l.aiDataContract={ver:1,name:0,url:0,duration:0,perfTotal:0,networkConnect:0,sentRequest:0,receivedResponse:0,domProcessing:0,properties:0,measurements:0},l.url=is(t,n),l.name=ts(t,i)||"not_specified",l.properties=as(t,r),l.measurements=rs(t,s),o&&(l.domProcessing=o.domProcessing,l.duration=o.duration,l.networkConnect=o.networkConnect,l.perfTotal=o.perfTotal,l.receivedResponse=o.receivedResponse,l.sentRequest=o.sentRequest),l}return di(t,e),t.envelopeType="Microsoft.ApplicationInsights.{0}.PageviewPerformance",t.dataType="PageviewPerformanceData",t}(function(e){function t(){var t=e.call(this)||this;return t.ver=2,t.properties={},t.measurements={},t}return di(t,e),t}(eo)),ro=function(e){function t(t,i){var n=e.call(this)||this;return n.aiDataContract={baseType:1,baseData:1},n.baseType=t,n.baseData=i,n}return di(t,e),t}(_s);function so(e){var t="ai."+e+".";return function(e){return t+e}}!function(e){e[e.Verbose=0]="Verbose",e[e.Information=1]="Information",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e[e.Critical=4]="Critical"}($s||($s={}));var oo,lo=so("application"),uo=so("device"),co=so("location"),ho=so("operation"),go=so("session"),po=so("user"),vo=so("cloud"),fo=so("internal"),mo=function(e){function t(){return e.call(this)||this}return di(t,e),t}((oo={applicationVersion:lo("ver"),applicationBuild:lo("build"),applicationTypeId:lo("typeId"),applicationId:lo("applicationId"),applicationLayer:lo("layer"),deviceId:uo("id"),deviceIp:uo("ip"),deviceLanguage:uo("language"),deviceLocale:uo("locale"),deviceModel:uo("model"),deviceFriendlyName:uo("friendlyName"),deviceNetwork:uo("network"),deviceNetworkName:uo("networkName"),deviceOEMName:uo("oemName"),deviceOS:uo("os"),deviceOSVersion:uo("osVersion"),deviceRoleInstance:uo("roleInstance"),deviceRoleName:uo("roleName"),deviceScreenResolution:uo("screenResolution"),deviceType:uo("type"),deviceMachineName:uo("machineName"),deviceVMName:uo("vmName"),deviceBrowser:uo("browser"),deviceBrowserVersion:uo("browserVersion"),locationIp:co("ip"),locationCountry:co("country"),locationProvince:co("province"),locationCity:co("city"),operationId:ho("id"),operationName:ho("name"),operationParentId:ho("parentId"),operationRootId:ho("rootId"),operationSyntheticSource:ho("syntheticSource"),operationCorrelationVector:ho("correlationVector"),sessionId:go("id"),sessionIsFirst:go("isFirst"),sessionIsNew:go("isNew"),userAccountAcquisitionDate:po("accountAcquisitionDate"),userAccountId:po("accountId"),userAgent:po("userAgent"),userId:po("id"),userStoreRegion:po("storeRegion"),userAuthUserId:po("authUserId"),userAnonymousUserAcquisitionDate:po("anonUserAcquisitionDate"),userAuthenticatedUserAcquisitionDate:po("authUserAcquisitionDate"),cloudName:vo("name"),cloudRole:vo("role"),cloudRoleVer:vo("roleVer"),cloudRoleInstance:vo("roleInstance"),cloudEnvironment:vo("environment"),cloudLocation:vo("location"),cloudDeploymentUnit:vo("deploymentUnit"),internalNodeName:fo("nodeName"),internalSdkVersion:fo("sdkVersion"),internalAgentVersion:fo("agentVersion"),internalSnippet:fo("snippet"),internalSdkSrc:fo("sdkSrc")},function(){var e=this;oo&&na(oo,(function(t,i){e[t]=i}))})),yo=function(){function e(){}return e.create=function(e,t,i,n,a,r){if(i=ts(n,i)||"not_specified",$n(e)||$n(t)||$n(i))throw Error("Input doesn't contain all required fields");var s="";e.iKey&&(s=e.iKey,delete e.iKey);var o={name:i,time:ua(new Date),iKey:s,ext:r||{},tags:[],data:{},baseType:t,baseData:e};return $n(a)||na(a,(function(e,t){o.data[e]=t})),o},e}(),bo="user",To="device",ko="trace",So="web",Eo="app",Po="os",Co=new mo,Io=function e(t,i,n,a){Ri(e,this,(function(e){var r,s=null,o=[],l=!1;function u(){n&&ca(n.getTransmissionControls(),(function(e){ca(e,(function(e){return e.flush(!0)}))}))}n&&(r=n.logger),e.trackPageView=function(e,n){var c=e.name;if($n(c)||"string"!=typeof c){var d=Na();c=e.name=d&&d.title||""}var h=e.uri;if($n(h)||"string"!=typeof h){var g=Fa();h=e.uri=g&&g.href||""}if(!a.isPerformanceTimingSupported())return t.sendPageViewInternal(e,n),u(),void r.throwInternal(Ai.WARNING,en,"trackPageView: navigation timing API used for calculation of page duration is not supported in this browser. This page view will be collected without duration and timing info.");var p,v,f,m=!1,y=a.getPerformanceTiming().navigationStart;y>0&&(p=Ls(y,+new Date),a.shouldCollectDuration(p)||(p=void 0)),$n(n)||$n(n.duration)||(v=n.duration),!i&&isNaN(v)||(isNaN(v)&&(n||(n={}),n.duration=p),t.sendPageViewInternal(e,n),u(),m=!0),n||(n={}),f=function(){var i=!1;try{if(a.isPerformanceTimingDataReady()){i=!0;var s={name:c,uri:h};a.populatePageViewPerformanceEvent(s),s.isValid||m?(m||(n.duration=s.durationMs,t.sendPageViewInternal(e,n)),l||(t.sendPageViewPerformanceInternal(s,n),l=!0)):(n.duration=p,t.sendPageViewInternal(e,n))}else y>0&&Ls(y,+new Date)>6e4&&(i=!0,m||(n.duration=6e4,t.sendPageViewInternal(e,n)))}catch(e){r.throwInternal(Ai.CRITICAL,gn,"trackPageView failed on page load calculation: "+ba(e),{exception:Ga(e)})}return i},o.push(f),s||(s=setInterval((function(){var e=o.slice(0),t=!1;o=[],ca(e,(function(e){e()?t=!0:o.push(e)})),0===o.length&&(clearInterval(s),s=null),t&&u()}),100))}}))},wo=function(){function e(e,t){this.prevPageVisitDataKeyName="prevPageVisitData",this.pageVisitTimeTrackingHandler=t,this._logger=e}return e.prototype.trackPreviousPageVisit=function(e,t){try{var i=this.restartPageVisitTimer(e,t);i&&this.pageVisitTimeTrackingHandler(i.pageName,i.pageUrl,i.pageVisitTime)}catch(e){this._logger.warnToConsole("Auto track page visit time failed, metric will not be collected: "+Ga(e))}},e.prototype.restartPageVisitTimer=function(e,t){try{var i=this.stopPageVisitTimer();return this.startPageVisitTimer(e,t),i}catch(e){return this._logger.warnToConsole("Call to restart failed: "+Ga(e)),null}},e.prototype.startPageVisitTimer=function(e,t){try{if(bs()){null!=Ts(this._logger,this.prevPageVisitDataKeyName)&&Pa("Cannot call startPageVisit consecutively without first calling stopPageVisit");var i=new Ro(e,t),n=Ha().stringify(i);ks(this._logger,this.prevPageVisitDataKeyName,n)}}catch(e){this._logger.warnToConsole("Call to start failed: "+Ga(e))}},e.prototype.stopPageVisitTimer=function(){try{if(bs()){var e=ya(),t=Ts(this._logger,this.prevPageVisitDataKeyName);if(t&&Wa()){var i=Ha().parse(t);return i.pageVisitTime=e-i.pageVisitStartTime,function(e,t){var i=ms();if(null!==i)try{return i.removeItem(t),!0}catch(t){ps=!1,e.throwInternal(Ai.WARNING,Oi,"Browser failed removal of session storage item. "+ba(t),{exception:Ga(t)})}}(this._logger,this.prevPageVisitDataKeyName),i}return null}return null}catch(e){return this._logger.warnToConsole("Stop page visit timer failed: "+Ga(e)),null}},e}(),Ro=function(e,t){this.pageVisitStartTime=ya(),this.pageName=e,this.pageUrl=t},Ao=function(){function e(e){this.MAX_DURATION_ALLOWED=36e5,e&&(this._logger=e.logger)}return e.prototype.populatePageViewPerformanceEvent=function(e){e.isValid=!1;var t=this.getPerformanceNavigationTiming(),i=this.getPerformanceTiming(),n=0,a=0,r=0,s=0,o=0;(t||i)&&(t?(n=t.duration,a=0===t.startTime?t.connectEnd:Ls(t.startTime,t.connectEnd),r=Ls(t.requestStart,t.responseStart),s=Ls(t.responseStart,t.responseEnd),o=Ls(t.responseEnd,t.loadEventEnd)):(n=Ls(i.navigationStart,i.loadEventEnd),a=Ls(i.navigationStart,i.connectEnd),r=Ls(i.requestStart,i.responseStart),s=Ls(i.responseStart,i.responseEnd),o=Ls(i.responseEnd,i.loadEventEnd)),0===n?this._logger.throwInternal(Ai.WARNING,Vi,"error calculating page view performance.",{total:n,network:a,request:r,response:s,dom:o}):this.shouldCollectDuration(n,a,r,s,o)?n<Math.floor(a)+Math.floor(r)+Math.floor(s)+Math.floor(o)?this._logger.throwInternal(Ai.WARNING,Bi,"client performance math error.",{total:n,network:a,request:r,response:s,dom:o}):(e.durationMs=n,e.perfTotal=e.duration=us(n),e.networkConnect=us(a),e.sentRequest=us(r),e.receivedResponse=us(s),e.domProcessing=us(o),e.isValid=!0):this._logger.throwInternal(Ai.WARNING,bn,"Invalid page load duration value. Browser perf data won't be sent.",{total:n,network:a,request:r,response:s,dom:o}))},e.prototype.getPerformanceTiming=function(){return this.isPerformanceTimingSupported()?Va().timing:null},e.prototype.getPerformanceNavigationTiming=function(){return this.isPerformanceNavigationTimingSupported()?Va().getEntriesByType("navigation")[0]:null},e.prototype.isPerformanceNavigationTimingSupported=function(){var e=Va();return e&&e.getEntriesByType&&e.getEntriesByType("navigation").length>0},e.prototype.isPerformanceTimingSupported=function(){var e=Va();return e&&e.timing},e.prototype.isPerformanceTimingDataReady=function(){var e=Va(),t=e?e.timing:0;return t&&t.domainLookupStart>0&&t.navigationStart>0&&t.responseStart>0&&t.requestStart>0&&t.loadEventEnd>0&&t.responseEnd>0&&t.connectEnd>0&&t.domLoading>0},e.prototype.shouldCollectDuration=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var i=Ua()||{},n=["googlebot","adsbot-google","apis-google","mediapartners-google"],a=i.userAgent,r=!1;if(a)for(var s=0;s<n.length;s++)r=r||-1!==a.toLowerCase().indexOf(n[s]);if(r)return!1;for(s=0;s<e.length;s++)if(e[s]<0||e[s]>=this.MAX_DURATION_ALLOWED)return!1;return!0},e}();function xo(e,t){e&&e.dispatchEvent&&t&&e.dispatchEvent(t)}var Do=function(e){function t(){var i,n,a,r,s,o=e.call(this)||this;return o.identifier="ApplicationInsightsAnalytics",o.priority=180,o.autoRoutePVDelay=500,Ri(t,o,(function(e,l){var u=Fa();r=u&&u.href||"",e.getCookieMgr=function(){return yr(e.core)},e.processTelemetry=function(t,i){nr(e.core,(function(){return e.identifier+":processTelemetry"}),(function(){var n=!1,a=e._telemetryInitializers.length;i=e._getTelCtx(i);for(var r=0;r<a;++r){var s=e._telemetryInitializers[r];if(s)try{if(!1===s.apply(null,[t])){n=!0;break}}catch(e){i.diagLog().throwInternal(Ai.CRITICAL,Nn,"One of telemetry initializers failed, telemetry item will not be sent: "+ba(e),{exception:Ga(e)},!0)}}n||e.processNext(t,i)}),(function(){return{item:t}}),!t.sync)},e.trackEvent=function(t,i){try{var n=yo.create(t,Os.dataType,Os.envelopeType,e.diagLog(),i);e.core.track(n)}catch(t){e.diagLog().throwInternal(Ai.WARNING,pn,"trackTrace failed, trace will not be collected: "+ba(t),{exception:Ga(t)})}},e.startTrackEvent=function(t){try{i.start(t)}catch(t){e.diagLog().throwInternal(Ai.CRITICAL,rn,"startTrackEvent failed, event will not be collected: "+ba(t),{exception:Ga(t)})}},e.stopTrackEvent=function(t,n,a){try{i.stop(t,void 0,n)}catch(t){e.diagLog().throwInternal(Ai.CRITICAL,sn,"stopTrackEvent failed, event will not be collected: "+ba(t),{exception:Ga(t)})}},e.trackTrace=function(t,i){try{var n=yo.create(t,no.dataType,no.envelopeType,e.diagLog(),i);e.core.track(n)}catch(t){e.diagLog().throwInternal(Ai.WARNING,pn,"trackTrace failed, trace will not be collected: "+ba(t),{exception:Ga(t)})}},e.trackMetric=function(t,i){try{var n=yo.create(t,Zs.dataType,Zs.envelopeType,e.diagLog(),i);e.core.track(n)}catch(t){e.diagLog().throwInternal(Ai.CRITICAL,dn,"trackMetric failed, metric will not be collected: "+ba(t),{exception:Ga(t)})}},e.trackPageView=function(t,i){try{var n=t||{};e._pageViewManager.trackPageView(n,ui(ui(ui({},n.properties),n.measurements),i)),e.config.autoTrackPageVisitTime&&e._pageVisitTimeManager.trackPreviousPageVisit(n.name,n.uri)}catch(t){e.diagLog().throwInternal(Ai.CRITICAL,hn,"trackPageView failed, page view will not be collected: "+ba(t),{exception:Ga(t)})}},e.sendPageViewInternal=function(t,i,n){var a=Na();a&&(t.refUri=void 0===t.refUri?a.referrer:t.refUri);var r=yo.create(t,to.dataType,to.envelopeType,e.diagLog(),i,n);e.core.track(r)},e.sendPageViewPerformanceInternal=function(t,i,n){var a=yo.create(t,ao.dataType,ao.envelopeType,e.diagLog(),i,n);e.core.track(a)},e.trackPageViewPerformance=function(t,i){try{e._pageViewPerformanceManager.populatePageViewPerformanceEvent(t),e.sendPageViewPerformanceInternal(t,i)}catch(t){e.diagLog().throwInternal(Ai.CRITICAL,hn,"trackPageViewPerformance failed, page view will not be collected: "+ba(t),{exception:Ga(t)})}},e.startTrackPage=function(t){try{if("string"!=typeof t){var i=Na();t=i&&i.title||""}n.start(t)}catch(t){e.diagLog().throwInternal(Ai.CRITICAL,on,"startTrackPage failed, page view may not be collected: "+ba(t),{exception:Ga(t)})}},e.stopTrackPage=function(t,i,a,r){try{if("string"!=typeof t){var s=Na();t=s&&s.title||""}if("string"!=typeof i){var o=Fa();i=o&&o.href||""}n.stop(t,i,a,r),e.config.autoTrackPageVisitTime&&e._pageVisitTimeManager.trackPreviousPageVisit(t,i)}catch(t){e.diagLog().throwInternal(Ai.CRITICAL,ln,"stopTrackPage failed, page view will not be collected: "+ba(t),{exception:Ga(t)})}},e.sendExceptionInternal=function(t,i,n){var a=t.exception||t.error||new Error("not_specified"),r=new zs(e.diagLog(),a,t.properties||i,t.measurements,t.severityLevel,t.id).toInterface(),s=yo.create(r,zs.dataType,zs.envelopeType,e.diagLog(),i,n);e.core.track(s)},e.trackException=function(t,i){try{e.sendExceptionInternal(t,i)}catch(t){e.diagLog().throwInternal(Ai.CRITICAL,cn,"trackException failed, exception will not be collected: "+ba(t),{exception:Ga(t)})}},e._onerror=function(t){var i=t&&t.error,n=t&&t.evt;try{if(!n){var a=_a();a&&(n=a.event)}var r=t&&t.url||(Na()||{}).URL,s=t.errorSrc||"window.onerror@"+r+":"+(t.lineNumber||0)+":"+(t.columnNumber||0),o={errorSrc:s,url:r,lineNumber:t.lineNumber||0,columnNumber:t.columnNumber||0,message:t.message};!function(e,t,i,n,a){return!a&&oa(e)&&("Script error."===e||"Script error"===e)}(t.message,t.url,t.lineNumber,t.columnNumber,t.error)?(t.errorSrc||(t.errorSrc=s),e.trackException({exception:t,severityLevel:$s.Error},o)):function(t,i){var n=yo.create(t,zs.dataType,zs.envelopeType,e.diagLog(),i);e.core.track(n)}(zs.CreateAutoException("Script error: The browser's same-origin policy prevents us from getting the details of this exception. Consider using the 'crossorigin' attribute.",r,t.lineNumber||0,t.columnNumber||0,i,n,null,s),o)}catch(t){var l=i?i.name+", "+i.message:"null";e.diagLog().throwInternal(Ai.CRITICAL,Wi,"_onError threw exception while logging error, error will not be collected: "+ba(t),{exception:Ga(t),errorString:l})}},e.addTelemetryInitializer=function(t){e._telemetryInitializers.push(t)},e.initialize=function(u,c,d,h){if(!e.isInitialized()){if($n(c))throw Error("Error initializing");l.initialize(u,c,d,h),e.setInitialized(!1);var g=e._getTelCtx(),p=e.identifier;e.config=g.getExtCfg(p);var v=t.getDefaultConfig(u);void 0!==v&&na(v,(function(t,i){e.config[t]=g.getConfig(p,t,i),void 0===e.config[t]&&(e.config[t]=i)})),e.config.isStorageUseDisabled&&(gs=!1,ps=!1);var f={instrumentationKey:function(){return u.instrumentationKey},accountId:function(){return e.config.accountId||u.accountId},sessionRenewalMs:function(){return e.config.sessionRenewalMs||u.sessionRenewalMs},sessionExpirationMs:function(){return e.config.sessionExpirationMs||u.sessionExpirationMs},sampleRate:function(){return e.config.samplingPercentage||u.samplingPercentage},sdkExtension:function(){return e.config.sdkExtension||u.sdkExtension},isBrowserLinkTrackingEnabled:function(){return e.config.isBrowserLinkTrackingEnabled||u.isBrowserLinkTrackingEnabled},appId:function(){return e.config.appId||u.appId}};e._pageViewPerformanceManager=new Ao(e.core),e._pageViewManager=new Io(o,e.config.overridePageViewDuration,e.core,e._pageViewPerformanceManager),e._pageVisitTimeManager=new wo(e.diagLog(),(function(t,i,n){return function(t,i,n){var a={PageName:t,PageUrl:i};e.trackMetric({name:"PageVisitTime",average:n,max:n,min:n,sampleCount:1},a)}(t,i,n)})),e._telemetryInitializers=e._telemetryInitializers||[],function(t){if(!t.isBrowserLinkTrackingEnabled()){var i=["/browserLinkSignalR/","/__browserLink/"];n=function(e){if(e.baseType===io.dataType){var t=e.baseData;if(t)for(var n=0;n<i.length;n++)if(t.target&&t.target.indexOf(i[n])>=0)return!1}return!0},e._telemetryInitializers.push(n)}var n}(f),(i=new Lo(e.diagLog(),"trackEvent")).action=function(t,i,n,a){a||(a={}),a.duration=n.toString(),e.trackEvent({name:t,properties:a})},(n=new Lo(e.diagLog(),"trackPageView")).action=function(t,i,n,a,r){$n(a)&&(a={}),a.duration=n.toString();var s={name:t,uri:i,properties:a,measurements:r};e.sendPageViewInternal(s,a)};var m,y=_a(),b=Ba(),T=Fa(),k=o;if(!1===e.config.disableExceptionTracking&&!e.config.autoExceptionInstrumented&&y){var S=y.onerror;y.onerror=function(e,t,i,n,a){var r=y.event,s=S&&S(e,t,i,n,a);return!0!==s&&k._onerror(zs.CreateAutoException(e,t,i,n,a,r)),s},e.config.autoExceptionInstrumented=!0}if(!1===e.config.disableExceptionTracking&&!0===e.config.enableUnhandledPromiseRejectionTracking&&!e.config.autoUnhandledPromiseInstrumented&&y){var E=y.onunhandledrejection;y.onunhandledrejection=function(e){var t=y.event,i=E&&E.call(y,e);return!0!==i&&k._onerror(zs.CreateAutoException(function(e){if(e&&e.reason){var t=e.reason;return!oa(t)&&ta(t.toString)?t.toString():Ga(t)}return e||""}(e),T?T.href:"",0,0,e,t)),i},e.config.autoUnhandledPromiseInstrumented=!0}if(!0===e.config.enableAutoRouteTracking&&b&&ta(b.pushState)&&ta(b.replaceState)&&y&&"undefined"!=typeof Event){var P=o;ca(d,(function(e){"AppInsightsPropertiesPlugin"===e.identifier&&(a=e)})),b.pushState=(m=b.pushState,function(){var e=m.apply(this,arguments);return xo(y,os(P.config.namePrefix+"pushState")),xo(y,os(P.config.namePrefix+"locationchange")),e}),b.replaceState=function(e){return function(){var t=e.apply(this,arguments);return xo(y,os(P.config.namePrefix+"replaceState")),xo(y,os(P.config.namePrefix+"locationchange")),t}}(b.replaceState),y.addEventListener&&(y.addEventListener(P.config.namePrefix+"popstate",(function(){xo(y,os(P.config.namePrefix+"locationchange"))})),y.addEventListener(P.config.namePrefix+"locationchange",(function(){if(a&&a.context&&a.context.telemetryTrace){a.context.telemetryTrace.traceID=Fr();var e="_unknown_";T&&T.pathname&&(e=T.pathname+(T.hash||"")),a.context.telemetryTrace.name=ts(P.diagLog(),e)}s?(r=s,s=T&&T.href||""):s=T&&T.href||"",setTimeout(function(e){P.trackPageView({refUri:e,properties:{duration:0}})}.bind(o,r),P.autoRoutePVDelay)})))}e.setInitialized(!0)}}})),o}return di(t,e),t.getDefaultConfig=function(e){return e||(e={}),e.sessionRenewalMs=18e5,e.sessionExpirationMs=864e5,e.disableExceptionTracking=ls(e.disableExceptionTracking),e.autoTrackPageVisitTime=ls(e.autoTrackPageVisitTime),e.overridePageViewDuration=ls(e.overridePageViewDuration),e.enableUnhandledPromiseRejectionTracking=ls(e.enableUnhandledPromiseRejectionTracking),(isNaN(e.samplingPercentage)||e.samplingPercentage<=0||e.samplingPercentage>=100)&&(e.samplingPercentage=100),e.isStorageUseDisabled=ls(e.isStorageUseDisabled),e.isBrowserLinkTrackingEnabled=ls(e.isBrowserLinkTrackingEnabled),e.enableAutoRouteTracking=ls(e.enableAutoRouteTracking),e.namePrefix=e.namePrefix||"",e.enableDebug=ls(e.enableDebug),e.disableFlushOnBeforeUnload=ls(e.disableFlushOnBeforeUnload),e.disableFlushOnUnload=ls(e.disableFlushOnUnload,e.disableFlushOnBeforeUnload),e},t.Version="2.7.1",t}(or),Lo=function(e,t){var i=this,n={};i.start=function(t){void 0!==n[t]&&e.throwInternal(Ai.WARNING,_n,"start was called more than once for this event without calling stop.",{name:t,key:t},!0),n[t]=+new Date},i.stop=function(t,a,r,s){var o=n[t];if(isNaN(o))e.throwInternal(Ai.WARNING,Mn,"stop was called without a corresponding start.",{name:t,key:t},!0);else{var l=Ls(o,+new Date);i.action(t,a,l,r,s)}delete n[t],n[t]=void 0}},_o=function e(t,i){var n=[],a=!1;this._get=function(){return n},this._set=function(e){return n=e},Ri(e,this,(function(e){e.enqueue=function(r){e.count()>=i.eventsLimitInMem()?a||(t.throwInternal(Ai.WARNING,zn,"Maximum in-memory buffer size reached: "+e.count(),!0),a=!0):n.push(r)},e.count=function(){return n.length},e.size=function(){for(var e=n.length,t=0;t<n.length;t++)e+=n[t].length;return i.emitLineDelimitedJson()||(e+=2),e},e.clear=function(){n=[],a=!1},e.getItems=function(){return n.slice(0)},e.batchPayloads=function(e){return e&&e.length>0?i.emitLineDelimitedJson()?e.join("\n"):"["+e.join(",")+"]":null}}))},Mo=function(e){function t(i,n){var a=e.call(this,i,n)||this;return Ri(t,a,(function(e,t){e.markAsSent=function(e){t.clear()},e.clearSent=function(e){}})),a}return di(t,e),t}(_o),No=function(e){function t(i,n){var a=e.call(this,i,n)||this,r=!1;return Ri(t,a,(function(e,a){var s=c(t.BUFFER_KEY),o=c(t.SENT_BUFFER_KEY),l=e._set(s.concat(o));function u(e,t){var i=[];return ca(t,(function(t){ta(t)||-1!==da(e,t)||i.push(t)})),i}function c(e){var t=e;try{t=n.namePrefix&&n.namePrefix()?n.namePrefix()+"_"+t:t;var a=Ts(i,t);if(a){var r=Ha().parse(a);if(oa(r)&&(r=Ha().parse(r)),r&&ra(r))return r}}catch(e){i.throwInternal(Ai.CRITICAL,mn," storage key: "+t+", "+ba(e),{exception:Ga(e)})}return[]}function d(e,t){var a=e;try{a=n.namePrefix&&n.namePrefix()?n.namePrefix()+"_"+a:a;var r=JSON.stringify(t);ks(i,a,r)}catch(e){ks(i,a,JSON.stringify([])),i.throwInternal(Ai.WARNING,fn," storage key: "+a+", "+ba(e)+". Buffer cleared",{exception:Ga(e)})}}l.length>t.MAX_BUFFER_SIZE&&(l.length=t.MAX_BUFFER_SIZE),d(t.SENT_BUFFER_KEY,[]),d(t.BUFFER_KEY,l),e.enqueue=function(n){e.count()>=t.MAX_BUFFER_SIZE?r||(i.throwInternal(Ai.WARNING,Un,"Maximum buffer size reached: "+e.count(),!0),r=!0):(a.enqueue(n),d(t.BUFFER_KEY,e._get()))},e.clear=function(){a.clear(),d(t.BUFFER_KEY,e._get()),d(t.SENT_BUFFER_KEY,[]),r=!1},e.markAsSent=function(n){d(t.BUFFER_KEY,e._set(u(n,e._get())));var a=c(t.SENT_BUFFER_KEY);a instanceof Array&&n instanceof Array&&((a=a.concat(n)).length>t.MAX_BUFFER_SIZE&&(i.throwInternal(Ai.CRITICAL,Un,"Sent buffer reached its maximum size: "+a.length,!0),a.length=t.MAX_BUFFER_SIZE),d(t.SENT_BUFFER_KEY,a))},e.clearSent=function(e){var i=c(t.SENT_BUFFER_KEY);i=u(e,i),d(t.SENT_BUFFER_KEY,i)}})),a}return di(t,e),t.BUFFER_KEY="AI_buffer",t.SENT_BUFFER_KEY="AI_sentBuffer",t.MAX_BUFFER_SIZE=2e3,t}(_o);function Oo(e,t,i){return Ta(e,t,i,Ea)}function Uo(e,t,i){$n(e)||na(e,(function(e,n){la(n)?i[e]=n:oa(n)?t[e]=n:Wa()&&(t[e]=Ha().stringify(n))}))}function Bo(e,t){$n(e)||na(e,(function(i,n){e[i]=n||t}))}function Fo(e,t,i,n){var a=new Ms(e,n,t);Oo(a,"sampleRate",i.sampleRate),(i.baseData||{}).startTime&&(a.time=ua(i.baseData.startTime)),a.iKey=i.iKey;var r=i.iKey.replace(/-/g,"");return a.name=a.name.replace("{0}",r),function(e,t,i){var n=i.tags=i.tags||{},a=t.ext=t.ext||{},r=t.tags=t.tags||[],s=a.user;s&&(Oo(n,Co.userAuthUserId,s.authId),Oo(n,Co.userId,s.id||s.localId));var o=a.app;o&&Oo(n,Co.sessionId,o.sesId);var l=a.device;l&&(Oo(n,Co.deviceId,l.id||l.localId),Oo(n,Co.deviceType,l.deviceClass),Oo(n,Co.deviceIp,l.ip),Oo(n,Co.deviceModel,l.model),Oo(n,Co.deviceType,l.deviceType));var u=t.ext.web;if(u){Oo(n,Co.deviceLanguage,u.browserLang),Oo(n,Co.deviceBrowserVersion,u.browserVer),Oo(n,Co.deviceBrowser,u.browser);var c=i.data=i.data||{},d=c.baseData=c.baseData||{},h=d.properties=d.properties||{};Oo(h,"domain",u.domain),Oo(h,"isManual",u.isManual?"true":null),Oo(h,"screenRes",u.screenRes),Oo(h,"userConsent",u.userConsent?"true":null)}var g=a.os;g&&Oo(n,Co.deviceOS,g.name);var p=a.trace;p&&(Oo(n,Co.operationParentId,p.parentID),Oo(n,Co.operationName,ts(e,p.name)),Oo(n,Co.operationId,p.traceID));for(var v={},f=r.length-1;f>=0;f--)na(r[f],(function(e,t){v[e]=t})),r.splice(f,1);na(r,(function(e,t){v[e]=t}));var m=ui(ui({},n),v);m[Co.internalSdkVersion]||(m[Co.internalSdkVersion]="javascript:"+Wo.Version),i.tags=Ca(m)}(e,i,a),i.tags=i.tags||[],Ca(a)}function Vo(e,t){$n(t.baseData)&&e.throwInternal(Ai.CRITICAL,Tn,"telemetryItem.baseData cannot be null.")}var Wo={Version:"2.7.1"};function Ho(e,t,i){Vo(e,t);var n={},a={};t.baseType!==Os.dataType&&(n.baseTypeSource=t.baseType),t.baseType===Os.dataType?(n=t.baseData.properties||{},a=t.baseData.measurements||{}):t.baseData&&Uo(t.baseData,n,a),Uo(t.data,n,a),$n(i)||Bo(n,i);var r=t.baseData.name,s=new Os(e,r,n,a),o=new ro(Os.dataType,s);return Fo(e,Os.envelopeType,t,o)}var jo,qo=function e(t){Ri(e,this,(function(e){function i(e,r){var s={};if(!e)return t.throwInternal(Ai.CRITICAL,Sn,"cannot serialize object because it is null or undefined",{name:r},!0),s;if(e.__aiCircularRefCheck)return t.throwInternal(Ai.WARNING,Pn,"Circular reference detected while serializing object",{name:r},!0),s;if(!e.aiDataContract){if("measurements"===r)s=a(e,"number",r);else if("properties"===r)s=a(e,"string",r);else if("tags"===r)s=a(e,"string",r);else if(ra(e))s=n(e,r);else{t.throwInternal(Ai.WARNING,En,"Attempting to serialize an object which does not implement ISerializable",{name:r},!0);try{Ha().stringify(e),s=e}catch(e){t.throwInternal(Ai.CRITICAL,Sn,e&&ta(e.toString)?e.toString():"Error serializing object",null,!0)}}return s}return e.__aiCircularRefCheck=!0,na(e.aiDataContract,(function(a,o){var l=ta(o)?1&o():1&o,u=ta(o)?4&o():4&o,c=2&o,d=void 0!==e[a],h=ea(e[a])&&null!==e[a];if(!l||d||c){if(!u){var g=void 0;void 0!==(g=h?c?n(e[a],a):i(e[a],a):e[a])&&(s[a]=g)}}else t.throwInternal(Ai.CRITICAL,Zi,"Missing required field specification. The field is required but not present on source",{field:a,name:r})})),delete e.__aiCircularRefCheck,s}function n(e,n){var a;if(e)if(ra(e)){a=[];for(var r=0;r<e.length;r++){var s=i(e[r],n+"["+r+"]");a.push(s)}}else t.throwInternal(Ai.CRITICAL,In,"This field was specified as an array in the contract but the item is not an array.\r\n",{name:n},!0);return a}function a(e,i,n){var a;return e&&(a={},na(e,(function(e,r){if("string"===i)void 0===r?a[e]="undefined":null===r?a[e]="null":r.toString?a[e]=r.toString():a[e]="invalid field: toString() is not defined.";else if("number"===i)if(void 0===r)a[e]="undefined";else if(null===r)a[e]="null";else{var s=parseFloat(r);isNaN(s)?a[e]="NaN":a[e]=s}else a[e]="invalid field: "+n+" is of unknown type.",t.throwInternal(Ai.CRITICAL,a[e],null,!0)}))),a}e.serialize=function(e){var n=i(e,"root");try{return Ha().stringify(n)}catch(e){t.throwInternal(Ai.CRITICAL,Sn,e&&ta(e.toString)?e.toString():"Error serializing object",null,!0)}}}))},Go=function(){function e(){var t=_a(),i=Na(),n=!1,a=!0;Ri(e,this,(function(e){try{if(t&&ia(t,"online",o)&&(ia(t,"offline",l),n=!0),i){var r=i.body||i;Qn(r.ononline)||(r.ononline=o,r.onoffline=l,n=!0)}if(n){var s=Ua();s&&!$n(s.onLine)&&(a=s.onLine)}}catch(e){n=!1}function o(){a=!0}function l(){a=!1}e.isListening=n,e.isOnline=function(){var e=!0,t=Ua();return n?e=a:t&&!$n(t.onLine)&&(e=t.onLine),e},e.isOffline=function(){return!e.isOnline()}}))}return e.Offline=new e,e}().Offline,Ko=function(){function e(){}return e.prototype.getHashCodeScore=function(t){return 100*(this.getHashCode(t)/e.INT_MAX_VALUE)},e.prototype.getHashCode=function(e){if(""===e)return 0;for(;e.length<8;)e=e.concat(e);for(var t=5381,i=0;i<e.length;++i)t=(t<<5)+t+e.charCodeAt(i),t&=t;return Math.abs(t)},e.INT_MAX_VALUE=2147483647,e}(),zo=function(){var e=new Ko,t=new mo;this.getSamplingScore=function(i){return i.tags&&i.tags[t.userId]?e.getHashCodeScore(i.tags[t.userId]):i.ext&&i.ext.user&&i.ext.user.id?e.getHashCodeScore(i.ext.user.id):i.tags&&i.tags[t.operationId]?e.getHashCodeScore(i.tags[t.operationId]):i.ext&&i.ext.telemetryTrace&&i.ext.telemetryTrace.traceID?e.getHashCodeScore(i.ext.telemetryTrace.traceID):100*Math.random()}},Xo=function(){function e(e,t){this.INT_MAX_VALUE=2147483647;var i=t||Za(null);(e>100||e<0)&&(i.throwInternal(Ai.WARNING,xn,"Sampling rate is out of range (0..100). Sampling will be disabled, you may be sending too much data which may affect your AI service level.",{samplingRate:e},!0),e=100),this.sampleRate=e,this.samplingScoreGenerator=new zo}return e.prototype.isSampledIn=function(e){var t=this.sampleRate;return null==t||t>=100||(e.baseType===Zs.dataType||this.samplingScoreGenerator.getSamplingScore(e)<t)},e}();function Yo(e){try{return e.responseText}catch(e){}return null}var Qo=((jo={})[Os.dataType]=Ho,jo[no.dataType]=function(e,t,i){Vo(e,t);var n=t.baseData.message,a=t.baseData.severityLevel,r=t.baseData.properties||{},s=t.baseData.measurements||{};Uo(t.data,r,s),$n(i)||Bo(r,i);var o=new no(e,n,a,r,s),l=new ro(no.dataType,o);return Fo(e,no.envelopeType,t,l)},jo[to.dataType]=function(e,t,i){Vo(e,t);var n,a=t.baseData;$n(a)||$n(a.properties)||$n(a.properties.duration)?$n(t.data)||$n(t.data.duration)||(n=t.data.duration,delete t.data.duration):(n=a.properties.duration,delete a.properties.duration);var r,s=t.baseData;((t.ext||{}).trace||{}).traceID&&(r=t.ext.trace.traceID);var o=s.id||r,l=s.name,u=s.uri,c=s.properties||{},d=s.measurements||{};$n(s.refUri)||(c.refUri=s.refUri),$n(s.pageType)||(c.pageType=s.pageType),$n(s.isLoggedIn)||(c.isLoggedIn=s.isLoggedIn.toString()),$n(s.properties)||na(s.properties,(function(e,t){c[e]=t})),Uo(t.data,c,d),$n(i)||Bo(c,i);var h=new to(e,l,u,n,c,d,o),g=new ro(to.dataType,h);return Fo(e,to.envelopeType,t,g)},jo[ao.dataType]=function(e,t,i){Vo(e,t);var n=t.baseData,a=n.name,r=n.uri||n.url,s=n.properties||{},o=n.measurements||{};Uo(t.data,s,o),$n(i)||Bo(s,i);var l=new ao(e,a,r,void 0,s,o,n),u=new ro(ao.dataType,l);return Fo(e,ao.envelopeType,t,u)},jo[zs.dataType]=function(e,t,i){Vo(e,t);var n=t.baseData.measurements||{},a=t.baseData.properties||{};Uo(t.data,a,n),$n(i)||Bo(a,i);var r=t.baseData,s=zs.CreateFromInterface(e,r,a,n),o=new ro(zs.dataType,s);return Fo(e,zs.envelopeType,t,o)},jo[Zs.dataType]=function(e,t,i){Vo(e,t);var n=t.baseData,a=n.properties||{},r=n.measurements||{};Uo(t.data,a,r),$n(i)||Bo(a,i);var s=new Zs(e,n.name,n.average,n.sampleCount,n.min,n.max,a,r),o=new ro(Zs.dataType,s);return Fo(e,Zs.envelopeType,t,o)},jo[io.dataType]=function(e,t,i){Vo(e,t);var n=t.baseData.measurements||{},a=t.baseData.properties||{};Uo(t.data,a,n),$n(i)||Bo(a,i);var r=t.baseData;if($n(r))return e.warnToConsole("Invalid input for dependency data"),null;var s=r.properties&&r.properties["http.method"]?r.properties["http.method"]:"GET",o=new io(e,r.id,r.target,r.name,r.duration,r.success,r.responseCode,s,r.type,r.correlationContext,a,n),l=new ro(io.dataType,o);return Fo(e,io.envelopeType,t,l)},jo),$o=function(e){function t(){var i,n,a=e.call(this)||this;a.priority=1001,a.identifier="AppInsightsChannelPlugin";var r,s,o,l,u,c=!1,d={},h=0;return a._senderConfig={endpointUrl:function(){return"https://dc.services.visualstudio.com/v2/track"},emitLineDelimitedJson:function(){return!1},maxBatchInterval:function(){return 15e3},maxBatchSizeInBytes:function(){return 102400},disableTelemetry:function(){return!1},enableSessionStorageBuffer:function(){return!0},isRetryDisabled:function(){return!1},isBeaconApiDisabled:function(){return!0},disableXhr:function(){return!1},onunloadDisableFetch:function(){return!1},onunloadDisableBeacon:function(){return!1},instrumentationKey:function(){},namePrefix:function(){},samplingPercentage:function(){return 100},customHeaders:function(){},convertUndefined:function(){},eventsLimitInMem:function(){return 1e4}},Ri(t,a,(function(e,g){function p(t,n,a,r,s,o){var l=null;if(e._appId||(l=E(o))&&l.appId&&(e._appId=l.appId),(t<200||t>=300)&&0!==t){if((301===t||307===t||308===t)&&!v(a))return void e._onError(n,s);!e._senderConfig.isRetryDisabled()&&w(t)?(P(n),e.diagLog().throwInternal(Ai.WARNING,vn,". Response code "+t+". Will retry to send "+n.length+" items.")):e._onError(n,s)}else if(Go.isOffline()){if(!e._senderConfig.isRetryDisabled()){P(n,10),e.diagLog().throwInternal(Ai.WARNING,vn,". Offline - Response Code: "+t+". Offline status: "+Go.isOffline()+". Will retry to send "+n.length+" items.")}}else v(a),206===t?(l||(l=E(o)),l&&!e._senderConfig.isRetryDisabled()?e._onPartialSuccess(n,l):e._onError(n,s)):(i=0,e._onSuccess(n,r))}function v(t){return!(o>=10)&&(!$n(t)&&""!==t&&t!==e._senderConfig.endpointUrl()&&(e._senderConfig.endpointUrl=function(){return t},++o,!0))}function f(e,t){u?u(e,!1):y(e)}function m(t){var i=Ua(),n=e._buffer,a=e._senderConfig.endpointUrl(),r=e._buffer.batchPayloads(t),s=new Blob([r],{type:"text/plain;charset=UTF-8"}),o=i.sendBeacon(a,s);return o&&(n.markAsSent(t),e._onSuccess(t,t.length)),o}function y(t,i){if(ra(t)&&t.length>0&&!m(t)){for(var n=[],a=0;a<t.length;a++){var r=t[a];m([r])||n.push(r)}n.length>0&&(l(n,!0),e.diagLog().throwInternal(Ai.WARNING,vn,". Failed to send telemetry with Beacon API, retried with normal sender."))}}function b(t,i){var n=new XMLHttpRequest,a=e._senderConfig.endpointUrl();try{n[hs]=!0}catch(e){}n.open("POST",a,i),n.setRequestHeader("Content-type","application/json"),As(a)&&n.setRequestHeader($r,Jr),ca(fa(d),(function(e){n.setRequestHeader(e,d[e])})),n.onreadystatechange=function(){return e._xhrReadyStateChange(n,t,t.length)},n.onerror=function(i){return e._onError(t,R(n),i)};var r=e._buffer.batchPayloads(t);n.send(r),e._buffer.markAsSent(t)}function T(t,i){if(ra(t)){for(var n=t.length,a=0;a<t.length;a++)n+=t[a].length;h+n<=65e3?S(t,!1):Ka()?y(t):(l&&l(t,!0),e.diagLog().throwInternal(Ai.WARNING,vn,". Failed to send telemetry with Beacon API, retried with xhrSender."))}}function k(e,t){S(e,!0)}function S(t,i){var n,a=e._senderConfig.endpointUrl(),r=e._buffer.batchPayloads(t),s=new Blob([r],{type:"application/json"}),o=new Headers,l=r.length;As(a)&&o.append($r,Jr),ca(fa(d),(function(e){o.append(e,d[e])}));var u=((n={method:"POST",headers:o,body:s})[hs]=!0,n);i||(u.keepalive=!0,h+=l);var c=new Request(a,u);try{c[hs]=!0}catch(e){}fetch(c).then((function(n){i||(h-=l,l=0),n.ok?n.text().then((function(e){p(n.status,t,n.url,t.length,n.statusText,e)})):e._onError(t,n.statusText)})).catch((function(n){i||(h-=l,l=0),e._onError(t,n.message)})),e._buffer.markAsSent(t)}function E(t){try{if(t&&""!==t){var i=Ha().parse(t);if(i&&i.itemsReceived&&i.itemsReceived>=i.itemsAccepted&&i.itemsReceived-i.itemsAccepted===i.errors.length)return i}}catch(i){e.diagLog().throwInternal(Ai.CRITICAL,yn,"Cannot parse the response. "+ba(i),{response:t})}return null}function P(t,a){if(void 0===a&&(a=1),t&&0!==t.length){var r=e._buffer;r.clearSent(t),i++;for(var s=0,o=t;s<o.length;s++){var l=o[s];r.enqueue(l)}!function(e){var t,a=10;if(i<=1)t=a;else{var r=(Math.pow(2,i)-1)/2,s=Math.floor(Math.random()*r*a)+1;s*=e,t=Math.max(Math.min(s,3600),a)}var o=ya()+1e3*t;n=o}(a),C()}}function C(){if(!r&&!c){var t=n?Math.max(0,n-ya()):0,i=Math.max(e._senderConfig.maxBatchInterval(),t);r=setTimeout((function(){r=null,e.triggerSend(!0,null,1)}),i)}}function I(){clearTimeout(r),r=null,n=null}function w(e){return 408===e||429===e||500===e||503===e}function R(e,t){return e?"XMLHttpRequest,Status:"+e.status+",Response:"+Yo(e)||e.response||"":t}function A(t,i){var n=e._buffer,a=_a(),r=new XDomainRequest;r.onload=function(){return e._xdrOnLoad(r,t)},r.onerror=function(i){return e._onError(t,x(r),i)};var s=a&&a.location&&a.location.protocol||"";if(0!==e._senderConfig.endpointUrl().lastIndexOf(s,0))return e.diagLog().throwInternal(Ai.WARNING,vn,". Cannot send XDomain request. The endpoint URL protocol doesn't match the hosting page protocol."),void n.clear();var o=e._senderConfig.endpointUrl().replace(/^(https?:)/,"");r.open("POST",o);var l=n.batchPayloads(t);r.send(l),n.markAsSent(t)}function x(e,t){return e?"XDomainRequest,Response:"+Yo(e)||"":t}e.pause=function(){I(),c=!0},e.resume=function(){c&&(c=!1,n=null,e._buffer.size()>e._senderConfig.maxBatchSizeInBytes()&&e.triggerSend(!0,null,10),C())},e.flush=function(){if(!c){I();try{e.triggerSend(!0,null,1)}catch(t){e.diagLog().throwInternal(Ai.CRITICAL,$i,"flush failed, telemetry will not be collected: "+ba(t),{exception:Ga(t)})}}},e.onunloadFlush=function(){if(!c)if(!1!==e._senderConfig.onunloadDisableBeacon()&&!1!==e._senderConfig.isBeaconApiDisabled()||!Ka())e.flush();else try{e.triggerSend(!0,f,2)}catch(t){e.diagLog().throwInternal(Ai.CRITICAL,Qi,"failed to flush with beacon sender on page unload, telemetry will not be collected: "+ba(t),{exception:Ga(t)})}},e.teardown=function(){Pa("Method not implemented.")},e.addHeader=function(e,t){d[e]=t},e.initialize=function(t,r,c,d){g.initialize(t,r,c,d);var h=e._getTelCtx(),p=e.identifier;s=new qo(r.logger),i=0,n=null,0,e._sender=null,o=0;var v=e.diagLog();na({endpointUrl:function(){return"https://dc.services.visualstudio.com/v2/track"},emitLineDelimitedJson:function(){return!1},maxBatchInterval:function(){return 15e3},maxBatchSizeInBytes:function(){return 102400},disableTelemetry:function(){return!1},enableSessionStorageBuffer:function(){return!0},isRetryDisabled:function(){return!1},isBeaconApiDisabled:function(){return!0},disableXhr:function(){return!1},onunloadDisableFetch:function(){return!1},onunloadDisableBeacon:function(){return!1},instrumentationKey:function(){},namePrefix:function(){},samplingPercentage:function(){return 100},customHeaders:function(){},convertUndefined:function(){},eventsLimitInMem:function(){return 1e4}},(function(t,i){e._senderConfig[t]=function(){return h.getConfig(p,t,i())}})),e._buffer=e._senderConfig.enableSessionStorageBuffer()&&bs()?new No(v,e._senderConfig):new Mo(v,e._senderConfig),e._sample=new Xo(e._senderConfig.samplingPercentage(),v),function(e){if(!$n(e.disableInstrumentationKeyValidation)&&e.disableInstrumentationKeyValidation)return!0;return new RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(e.instrumentationKey)}(t)||v.throwInternal(Ai.CRITICAL,Gn,"Invalid Instrumentation key "+t.instrumentationKey),!As(e._senderConfig.endpointUrl())&&e._senderConfig.customHeaders()&&e._senderConfig.customHeaders().length>0&&ca(e._senderConfig.customHeaders(),(function(e){a.addHeader(e.header,e.value)}));var f=e._senderConfig,m=null;!f.disableXhr()&&Xa()?m=A:!f.disableXhr()&&Ya()&&(m=b),!m&&za()&&(m=k),l=m||b,!f.isBeaconApiDisabled()&&Ka()&&(m=y),e._sender=m||b,u=!f.onunloadDisableFetch()&&za(!0)?T:Ka()?y:!f.disableXhr()&&Xa()?A:!f.disableXhr()&&Ya()?b:l},e.processTelemetry=function(i,n){n=e._getTelCtx(n);try{if(e._senderConfig.disableTelemetry())return;if(!i)return void n.diagLog().throwInternal(Ai.CRITICAL,Ui,"Cannot send empty telemetry");if(i.baseData&&!i.baseType)return void n.diagLog().throwInternal(Ai.CRITICAL,Vn,"Cannot send telemetry without baseData and baseType");if(i.baseType||(i.baseType="EventData"),!e._sender)return void n.diagLog().throwInternal(Ai.CRITICAL,an,"Sender was not initialized");if(d=i,!e._sample.isSampledIn(d))return void n.diagLog().throwInternal(Ai.WARNING,un,"Telemetry item was sampled out and not sent",{SampleRate:e._sample.sampleRate});i.sampleRate=e._sample.sampleRate;var a=e._senderConfig.convertUndefined()||void 0,r=i.iKey||e._senderConfig.instrumentationKey(),o=t.constructEnvelope(i,r,n.diagLog(),a);if(!o)return void n.diagLog().throwInternal(Ai.CRITICAL,kn,"Unable to create an AppInsights envelope");var l=!1;if(i.tags&&i.tags.ProcessLegacy&&(ca(i.tags.ProcessLegacy,(function(e){try{e&&!1===e(o)&&(l=!0,n.diagLog().warnToConsole("Telemetry processor check returns false"))}catch(e){n.diagLog().throwInternal(Ai.CRITICAL,Nn,"One of telemetry initializers failed, telemetry item will not be sent: "+ba(e),{exception:Ga(e)},!0)}})),delete i.tags.ProcessLegacy),l)return;var u=s.serialize(o),c=e._buffer;c.size()+u.length>e._senderConfig.maxBatchSizeInBytes()&&e.triggerSend(!0,null,10),c.enqueue(u),C()}catch(e){n.diagLog().throwInternal(Ai.WARNING,Hi,"Failed adding telemetry to the sender's buffer, some telemetry will be lost: "+ba(e),{exception:Ga(e)})}var d;e.processNext(i,n)},e._xhrReadyStateChange=function(e,t,i){4===e.readyState&&p(e.status,t,e.responseURL,i,R(e),Yo(e)||e.response)},e.triggerSend=function(t,i,n){if(void 0===t&&(t=!0),!c)try{var r=e._buffer;if(e._senderConfig.disableTelemetry())r.clear();else{if(r.count()>0){var s=r.getItems();!function(t,i){var n=function(){var t="getNotifyMgr";if(e.core[t])return e.core[t]();return e.core._notificationManager}();if(n&&n.eventsSendRequest)try{n.eventsSendRequest(t,i)}catch(t){e.diagLog().throwInternal(Ai.CRITICAL,qn,"send request notification failed: "+ba(t),{exception:Ga(t)})}}(n||0,t),i?i.call(a,s,t):e._sender(s,t)}+new Date}I()}catch(t){var o=qa();(!o||o>9)&&e.diagLog().throwInternal(Ai.CRITICAL,vn,"Telemetry transmission failed, some telemetry will be lost: "+ba(t),{exception:Ga(t)})}},e._onError=function(t,i,n){e.diagLog().throwInternal(Ai.WARNING,tn,"Failed to send telemetry.",{message:i}),e._buffer.clearSent(t)},e._onPartialSuccess=function(t,i){for(var n=[],a=[],r=0,s=i.errors.reverse();r<s.length;r++){var o=s[r],l=t.splice(o.index,1)[0];w(o.statusCode)?a.push(l):n.push(l)}t.length>0&&e._onSuccess(t,i.itemsAccepted),n.length>0&&e._onError(n,R(null,["partial success",i.itemsAccepted,"of",i.itemsReceived].join(" "))),a.length>0&&(P(a),e.diagLog().throwInternal(Ai.WARNING,vn,"Partial success. Delivered: "+t.length+", Failed: "+n.length+". Will retry to send "+a.length+" our of "+i.itemsReceived+" items"))},e._onSuccess=function(t,i){e._buffer.clearSent(t)},e._xdrOnLoad=function(t,n){var a=Yo(t);if(!t||a+""!="200"&&""!==a){var r=E(a);r&&r.itemsReceived&&r.itemsReceived>r.itemsAccepted&&!e._senderConfig.isRetryDisabled()?e._onPartialSuccess(n,r):e._onError(n,x(t))}else i=0,e._onSuccess(n,0)}})),a}return di(t,e),t.constructEnvelope=function(e,t,i,n){var a;return a=t===e.iKey||$n(t)?e:ui(ui({},e),{iKey:t}),(Qo[a.baseType]||Ho)(i,a,n)},t}(or),Jo=function(){},Zo=function(){function e(t,i){var n,a,r=Za(i),s=yr(i);Ri(e,this,(function(i){t||(t={}),ta(t.sessionExpirationMs)||(t.sessionExpirationMs=function(){return e.acquisitionSpan}),ta(t.sessionRenewalMs)||(t.sessionRenewalMs=function(){return e.renewalSpan}),i.config=t;var o=i.config.sessionCookiePostfix&&i.config.sessionCookiePostfix()?i.config.sessionCookiePostfix():i.config.namePrefix&&i.config.namePrefix()?i.config.namePrefix():"";function l(e,t){var i=!1,n=", session will be reset",a=t.split("|");if(a.length>=2)try{var s=+a[1]||0,o=+a[2]||0;isNaN(s)||s<=0?r.throwInternal(Ai.WARNING,nn,"AI session acquisition date is 0"+n):isNaN(o)||o<=0?r.throwInternal(Ai.WARNING,nn,"AI session renewal date is 0"+n):a[0]&&(e.id=a[0],e.acquisitionDate=s,e.renewalDate=o,i=!0)}catch(e){r.throwInternal(Ai.CRITICAL,Fi,"Error parsing ai_session value ["+(t||"")+"]"+n+" - "+ba(e),{exception:Ga(e)})}return i}function u(e,t){var r=e.acquisitionDate;e.renewalDate=t;var o=i.config,l=o.sessionRenewalMs(),u=r+o.sessionExpirationMs()-t,c=[e.id,r,t],d=0;d=u<l?u/1e3:l/1e3;var h=o.cookieDomain?o.cookieDomain():null;s.set(n(),c.join("|"),o.sessionExpirationMs()>0?d:null,h),a=t}n=function(){return"ai_session"+o},i.automaticSession=new Jo,i.update=function(){var t=ya(),o=!1,c=i.automaticSession;c.id||(o=!function(e,t){var i=!1,a=s.get(n());if(a&&ta(a.split))i=l(e,a);else{var o=function(e,t){var i=vs();if(null!==i)try{return i.getItem(t)}catch(t){gs=!1,e.throwInternal(Ai.WARNING,Di,"Browser failed read of local storage. "+ba(t),{exception:Ga(t)})}return null}(r,n());o&&(i=l(e,o))}return i||!!e.id}(c));var d=i.config.sessionExpirationMs();if(!o&&d>0){var h=i.config.sessionRenewalMs(),g=t-c.acquisitionDate,p=t-c.renewalDate;o=(o=(o=g<0||p<0)||g>d)||p>h}o?function(e){var t=i.config||{},n=(t.getNewId?t.getNewId():null)||Br;i.automaticSession.id=n(t.idLength?t.idLength():22),i.automaticSession.acquisitionDate=e,u(i.automaticSession,e),ys()||r.throwInternal(Ai.WARNING,xi,"Browser does not support local storage. Session durations will be inaccurate.")}(t):(!a||t-a>e.cookieUpdateInterval)&&u(c,t)},i.backup=function(){var e,t,a,s=i.automaticSession;e=s.id,t=s.acquisitionDate,a=s.renewalDate,function(e,t,i){var n=vs();if(null!==n)try{n.setItem(t,i)}catch(t){gs=!1,e.throwInternal(Ai.WARNING,_i,"Browser failed write to local storage. "+ba(t),{exception:Ga(t)})}}(r,n(),[e,t,a].join("|"))}}))}return e.acquisitionSpan=864e5,e.renewalSpan=18e5,e.cookieUpdateInterval=6e4,e}(),el=function(){},tl=function(){this.id="browser",this.deviceClass="Browser"},il=function(e){this.sdkVersion=(e.sdkExtension&&e.sdkExtension()?e.sdkExtension()+"_":"")+"javascript:2.7.1"};function nl(e){return!("string"!=typeof e||!e||e.match(/,|;|=| |\|/))}var al=function(){function e(t,i){this.isNewUser=!1,this.isUserCookieSet=!1;var n,a=Za(i),r=yr(i);Ri(e,this,(function(i){i.config=t;var s=i.config.userCookiePostfix&&i.config.userCookiePostfix()?i.config.userCookiePostfix():"";n=function(){return e.userCookieName+s};var o=r.get(n());if(o){i.isNewUser=!1;var l=o.split(e.cookieSeparator);l.length>0&&(i.id=l[0],i.isUserCookieSet=!!i.id)}function u(){var e=t||{};return((e.getNewId?e.getNewId():null)||Br)(e.idLength?t.idLength():22)}function c(e){var t=ua(new Date);return i.accountAcquisitionDate=t,i.isNewUser=!0,[e,t]}function d(e){i.isUserCookieSet=r.set(n(),e,31536e3)}if(!i.id){i.id=u(),d(c(i.id).join(e.cookieSeparator));var h=t.namePrefix&&t.namePrefix()?t.namePrefix()+"ai_session":"ai_session";!function(e,t){var i=vs();if(null!==i)try{return i.removeItem(t),!0}catch(t){gs=!1,e.throwInternal(Ai.WARNING,Ni,"Browser failed removal of local storage item. "+ba(t),{exception:Ga(t)})}}(a,h)}i.accountId=t.accountId?t.accountId():void 0;var g=r.get(e.authUserCookieName);if(g){var p=(g=decodeURI(g)).split(e.cookieSeparator);p[0]&&(i.authenticatedId=p[0]),p.length>1&&p[1]&&(i.accountId=p[1])}i.setAuthenticatedUserContext=function(t,n,s){if(void 0===s&&(s=!1),!nl(t)||n&&!nl(n))a.throwInternal(Ai.WARNING,Dn,"Setting auth user context failed. User auth/account id should be of type string, and not contain commas, semi-colons, equal signs, spaces, or vertical-bars.",!0);else{i.authenticatedId=t;var o=i.authenticatedId;n&&(i.accountId=n,o=[i.authenticatedId,i.accountId].join(e.cookieSeparator)),s&&r.set(e.authUserCookieName,encodeURI(o))}},i.clearAuthenticatedUserContext=function(){i.authenticatedId=null,i.accountId=null,r.del(e.authUserCookieName)},i.update=function(t){i.id===t&&i.isUserCookieSet||d(c(t||u()).join(e.cookieSeparator))}}))}return e.cookieSeparator="|",e.userCookieName="ai_user",e.authUserCookieName="ai_authUser",e}(),rl=function(){},sl=function(e,t,i,n){var a=this;a.traceID=e||Fr(),a.parentID=t,a.name=i;var r=Fa();!i&&r&&r.pathname&&(a.name=r.pathname),a.name=ts(n,a.name)};function ol(e,t){e&&e[t]&&0===fa(e[t]).length&&delete e[t]}var ll=function e(t,i){var n=this,a=t.logger;this.appId=function(){return null},this.getSessionId=function(){return null},Ri(e,this,(function(e){e.application=new el,e.internal=new il(i),La()&&(e.sessionManager=new Zo(i,t),e.device=new tl,e.location=new rl,e.user=new al(i,t),e.telemetryTrace=new sl(void 0,void 0,void 0,a),e.session=new Jo),e.getSessionId=function(){var t=e.session,i=null;if(t&&oa(t.id))i=t.id;else{var n=(e.sessionManager||{}).automaticSession;i=n&&oa(n.id)?n.id:null}return i},e.applySessionContext=function(t,i){Ta(ka(t.ext,Eo),"sesId",e.getSessionId(),oa)},e.applyOperatingSystemContxt=function(t,i){Ta(t.ext,Po,e.os)},e.applyApplicationContext=function(t,i){var n=e.application;if(n){var a=ka(t,"tags");Ta(a,Co.applicationVersion,n.ver,oa),Ta(a,Co.applicationBuild,n.build,oa)}},e.applyDeviceContext=function(t,i){var n=e.device;if(n){var a=ka(ka(t,"ext"),To);Ta(a,"localId",n.id,oa),Ta(a,"ip",n.ip,oa),Ta(a,"model",n.model,oa),Ta(a,"deviceClass",n.deviceClass,oa)}},e.applyInternalContext=function(t,i){var n=e.internal;if(n){var a=ka(t,"tags");Ta(a,Co.internalAgentVersion,n.agentVersion,oa),Ta(a,Co.internalSdkVersion,n.sdkVersion,oa),t.baseType!==Ja.dataType&&t.baseType!==to.dataType||(Ta(a,Co.internalSnippet,n.snippetVer,oa),Ta(a,Co.internalSdkSrc,n.sdkSrc,oa))}},e.applyLocationContext=function(e,t){var i=n.location;i&&Ta(ka(e,"tags",[]),Co.locationIp,i.ip,oa)},e.applyOperationContext=function(t,i){var n=e.telemetryTrace;if(n){var a=ka(ka(t,"ext"),ko,{traceID:void 0,parentID:void 0});Ta(a,"traceID",n.traceID,oa),Ta(a,"name",n.name,oa),Ta(a,"parentID",n.parentID,oa)}},e.applyWebContext=function(e,t){var i=n.web;i&&Ta(ka(e,"ext"),So,i)},e.applyUserContext=function(t,i){var n=e.user;if(n){Ta(ka(t,"tags",[]),Co.userAccountId,n.accountId,oa);var a=ka(ka(t,"ext"),bo);Ta(a,"id",n.id,oa),Ta(a,"authId",n.authenticatedId,oa)}},e.cleanUp=function(e,t){var i=e.ext;i&&(ol(i,To),ol(i,bo),ol(i,So),ol(i,Po),ol(i,Eo),ol(i,ko))}}))},ul=function(e){function t(){var i,n,a=e.call(this)||this;return a.priority=110,a.identifier="AppInsightsPropertiesPlugin",Ri(t,a,(function(e,a){e.initialize=function(r,s,o,l){a.initialize(r,s,o,l);var u=e._getTelCtx(),c=e.identifier,d=t.getDefaultConfig();n=n||{},na(d,(function(e,t){n[e]=function(){return u.getConfig(c,e,t())}})),e.context=new ll(s,n),i=function(e,t){var i=null;return ca(e,(function(e){if(e.identifier===t)return i=e,-1})),i}(o,"AppInsightsChannelPlugin"),e.context.appId=function(){return i?i._appId:null},e._extConfig=n},e.processTelemetry=function(t,i){if($n(t));else{i=e._getTelCtx(i),t.name===to.envelopeType&&i.diagLog().resetInternalMessageCount();var n=e.context||{};n.session&&"string"!=typeof e.context.session.id&&n.sessionManager&&n.sessionManager.update();var a=n.user;if(a&&!a.isUserCookieSet&&a.update(n.user.id),function(t,i){ka(t,"tags",[]),ka(t,"ext",{});var n=e.context;n.applySessionContext(t,i),n.applyApplicationContext(t,i),n.applyDeviceContext(t,i),n.applyOperationContext(t,i),n.applyUserContext(t,i),n.applyOperatingSystemContxt(t,i),n.applyWebContext(t,i),n.applyLocationContext(t,i),n.applyInternalContext(t,i),n.cleanUp(t,i)}(t,i),a&&a.isNewUser){a.isNewUser=!1;var r=new Ja(Hn,(Ua()||{}).userAgent||"");i.diagLog().logInternalMessage(Ai.CRITICAL,r)}e.processNext(t,i)}}})),a}return di(t,e),t.getDefaultConfig=function(){return{instrumentationKey:function(){},accountId:function(){return null},sessionRenewalMs:function(){return 18e5},samplingPercentage:function(){return 100},sessionExpirationMs:function(){return 864e5},cookieDomain:function(){return null},sdkExtension:function(){return null},isBrowserLinkTrackingEnabled:function(){return!1},appId:function(){return null},getSessionId:function(){return null},namePrefix:function(){},sessionCookiePostfix:function(){},userCookiePostfix:function(){},idLength:function(){return 22},getNewId:function(){return null}}},t}(or);function cl(e,t,i){var n=0,a=e[t],r=e[i];return a&&r&&(n=Ls(a,r)),n}function dl(e,t,i,n,a){var r=0,s=cl(i,n,a);return s&&(r=hl(e,t,us(s))),r}function hl(e,t,i){var n=0;e&&t&&i&&((e.ajaxPerf=e.ajaxPerf||{})[t]=i,n=1);return n}var gl=function(){var e=this;e.openDone=!1,e.setRequestHeaderDone=!1,e.sendDone=!1,e.abortDone=!1,e.stateChangeAttached=!1},pl=function e(t,i,n){var a=this,r=n;a.perfMark=null,a.completed=!1,a.requestHeadersSize=null,a.requestHeaders=null,a.responseReceivingDuration=null,a.callbackDuration=null,a.ajaxTotalDuration=null,a.aborted=0,a.pageUrl=null,a.requestUrl=null,a.requestSize=0,a.method=null,a.status=null,a.requestSentTime=null,a.responseStartedTime=null,a.responseFinishedTime=null,a.callbackFinishedTime=null,a.endTime=null,a.xhrMonitoringState=new gl,a.clientFailure=0,a.traceID=t,a.spanID=i,Ri(e,a,(function(e){e.getAbsoluteUrl=function(){return e.requestUrl?(t=e.requestUrl,(n=Cs(t))&&(i=n.href),i):null;var t,i,n},e.getPathName=function(){return e.requestUrl?is(r,(t=e.method,i=e.requestUrl,t?t.toUpperCase()+" "+i:i)):null;var t,i},e.CreateTrackItem=function(t,i,n){var a;if(e.ajaxTotalDuration=Math.round(1e3*Ls(e.requestSentTime,e.responseFinishedTime))/1e3,e.ajaxTotalDuration<0)return null;var r=((a={id:"|"+e.traceID+"."+e.spanID,target:e.getAbsoluteUrl(),name:e.getPathName(),type:t,startTime:null,duration:e.ajaxTotalDuration,success:+e.status>=200&&+e.status<400,responseCode:+e.status,method:e.method}).properties={HttpMethod:e.method},a);if(e.requestSentTime&&(r.startTime=new Date,r.startTime.setTime(e.requestSentTime)),function(e,t){var i=e.perfTiming,n=t.properties||{},a=0,r="name",s="domainLookup",o="connect",l="redirect",u="request",c="response",d="duration",h="startTime",g="connectEnd",p="requestStart",v="responseEnd",f=l+"Start",m=l="End",y="transferSize",b="encodedBodySize",T="decodedBodySize",k="serverTiming";if(i){a|=dl(n,l,i,f,m),a|=dl(n,s,i,"domainLookupStart","domainLookupEnd"),a|=dl(n,o,i,"connectStart",g),a|=dl(n,u,i,p,"requestEnd"),a|=dl(n,c,i,"responseStart",v),a|=dl(n,"networkConnect",i,h,g),a|=dl(n,"sentRequest",i,p,v);var S=i.duration;S||(S=cl(i,h,v)||0),a|=hl(n,d,S),a|=hl(n,"perfTotal",S);var E=i.serverTiming;if(E){var P={};ca(E,(function(e,t){var i=function(e){var t=e,i=/([^\w\d_$])/g;return i.test(e)&&(t=e.replace(i,"_")),t}(e.name||""+t),n=P[i]||{};na(e,(function(e,t){(e!==r&&oa(t)||la(t))&&(n[e]&&(t=n[e]+";"+t),!t&&oa(t)||(n[e]=t))})),P[i]=n})),a|=hl(n,k,P)}a|=hl(n,y,i.transferSize),a|=hl(n,b,i.encodedBodySize),a|=hl(n,T,i.decodedBodySize)}else e.perfMark&&(a|=hl(n,"missing",e.perfAttempts));a&&(t.properties=n)}(e,r),i&&fa(e.requestHeaders).length>0&&(r.properties=r.properties||{},r.properties.requestHeaders=e.requestHeaders),n){var s=n();if(s){var o=s.correlationContext;if(o&&(r.correlationContext=o),s.headerMap&&fa(s.headerMap).length>0&&(r.properties=r.properties||{},r.properties.responseHeaders=s.headerMap),e.errorStatusText&&e.status>=400){var l=s.type;r.properties=r.properties||{},""!==l&&"text"!==l||(r.properties.responseText=s.responseText?s.statusText+" - "+s.responseText:s.statusText),"json"===l&&(r.properties.responseText=s.response?s.statusText+" - "+JSON.stringify(s.response):s.statusText)}}}return r}}))},vl=function(){function e(t,i){var n=this;n.traceFlag=e.DEFAULT_TRACE_FLAG,n.version=e.DEFAULT_VERSION,t&&e.isValidTraceId(t)?n.traceId=t:n.traceId=Fr(),i&&e.isValidSpanId(i)?n.spanId=i:n.spanId=Fr().substr(0,16)}return e.isValidTraceId=function(e){return e.match(/^[0-9a-f]{32}$/)&&"00000000000000000000000000000000"!==e},e.isValidSpanId=function(e){return e.match(/^[0-9a-f]{16}$/)&&"0000000000000000"!==e},e.prototype.toString=function(){var e=this;return e.version+"-"+e.traceId+"-"+e.spanId+"-"+e.traceFlag},e.DEFAULT_TRACE_FLAG="01",e.DEFAULT_VERSION="00",e}(),fl=0;function ml(e){var t="";try{$n(e)||$n(e.ajaxData)||$n(e.ajaxData.requestUrl)||(t+="(url: '"+e.ajaxData.requestUrl+"')")}catch(e){}return t}function yl(e,t,i,n,a){e.diagLog().throwInternal(Ai.CRITICAL,t,i,n,a)}function bl(e,t,i,n,a){e.diagLog().throwInternal(Ai.WARNING,t,i,n,a)}function Tl(e,t,i){return function(n){yl(e,t,i,{ajaxDiagnosticsMessage:ml(n.inst),exception:Ga(n.err)})}}function kl(e,t){return e&&t?e.indexOf(t):-1}var Sl,El=function(e){function t(){var i=e.call(this)||this;i.identifier=t.identifier,i.priority=120;var n,a,r,s,o,l,u=Fa(),c=!1,d=!1,h=u&&u.host&&u.host.toLowerCase(),g=t.getEmptyConfig(),p=!1,v=!1,f=0,m=!1,y=0,b=!1,T=[],k={};return Ri(t,i,(function(e,i){function u(e){var t=!0;return(e||g.ignoreHeaders)&&ca(g.ignoreHeaders,(function(i){if(i.toLowerCase()===e.toLowerCase())return t=!1,-1})),t}function S(e,t,i){T.push(function(e,t,i){return e?Gr(e.prototype,t,i,!1):null}(e,t,i))}function E(e,t,i){var n=!1,a=((oa(t)?t:(t||{}).url||"")||"").toLowerCase();if(ca(o,(function(e){var t=e;oa(e)&&(t=new RegExp(e)),n||(n=t.test(a))})),n)return n;var r=kl(a,"?"),s=kl(a,"#");return(-1===r||-1!==s&&s<r)&&(r=s),-1!==r&&(a=a.substring(0,r)),$n(e)?$n(t)||(n="object"==typeof t&&!0===t[hs]||!!i&&!0===i[hs]):n=!0===e[hs]||!0===a[hs],!n&&a&&As(a)&&(n=!0),n?k[a]||(k[a]=1):k[a]&&(n=!0),n}function P(e,t){var i=!0,n=d;return $n(e)||(i=!0===t||!$n(e.ajaxData)),n&&i}function C(e){try{var t=e.responseType;if(""===t||"text"===t)return e.responseText}catch(e){}return null}function I(t){try{var i=t.getAllResponseHeaders();if(null!==i)if(-1!==kl(i.toLowerCase(),Zr)){var n=t.getResponseHeader(Kr);return xs.getCorrelationContext(n)}}catch(i){bl(e,Xi,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{ajaxDiagnosticsMessage:ml(t),exception:Ga(i)})}}function w(e,t){if(t.requestUrl&&s&&m){var i=Va();if(i&&ta(i.mark)){fl++;var n=s+e+"#"+fl;i.mark(n);var a=i.getEntriesByName(n);a&&1===a.length&&(t.perfMark=a[0])}}}function R(e,t,i,n){var a=t.perfMark,r=Va(),s=g.maxAjaxPerfLookupAttempts,o=g.ajaxPerfLookupDelay,l=t.requestUrl,u=0;!function c(){try{if(r&&a){u++;for(var d=null,h=r.getEntries(),g=h.length-1;g>=0;g--){var p=h[g];if(p){if("resource"===p.entryType)p.initiatorType!==e||-1===kl(p.name,l)&&-1===kl(l,p.name)||(d=p);else if("mark"===p.entryType&&p.name===a.name){t.perfTiming=d;break}if(p.startTime<a.startTime-1e3)break}}}!a||t.perfTiming||u>=s||!1===t.async?(a&&ta(r.clearMarks)&&r.clearMarks(a.name),t.perfAttempts=u,i()):setTimeout(c,o)}catch(e){n(e)}}()}function A(t){var i="";try{$n(t)||(i+="string"==typeof t?"(url: '"+t+"')":"(url: '"+t.url+"')")}catch(t){yl(e,Gi,"Failed to grab failed fetch diagnostics message",{exception:Ga(t)})}return i}function x(t,i,n,a,r,s,o){function u(t,i,a){var r=a||{};r.fetchDiagnosticsMessage=A(n),i&&(r.exception=Ga(i)),bl(e,t,"Failed to calculate the duration of the fetch call, monitoring data for this fetch call won't be sent.",r)}r&&(r.responseFinishedTime=Ds(),r.status=i,R("fetch",r,(function(){var t,o=r.CreateTrackItem("Fetch",p,s);try{l&&(t=l({status:i,request:n,response:a}))}catch(t){bl(e,Kn,"Failed to add custom defined request context as configured call back may missing a null check.")}o?(void 0!==t&&(o.properties=ui(ui({},o.properties),t)),e.trackDependencyDataInternal(o)):u(qi,null,{requestSentTime:r.requestSentTime,responseFinishedTime:r.responseFinishedTime})}),(function(e){u(Xi,e,null)})))}function D(t){if(t&&t.headers)try{var i=t.headers.get(Kr);return xs.getCorrelationContext(i)}catch(i){bl(e,Xi,"Failed to get Request-Context correlation header as it may be not included in the response or not accessible.",{fetchDiagnosticsMessage:A(t),exception:Ga(i)})}}e.initialize=function(h,f,k,A){if(!e.isInitialized()){i.initialize(h,f,k,A);var L=e._getTelCtx();na(t.getDefaultConfig(),(function(e,i){g[e]=L.getConfig(t.identifier,e,i)}));var _=g.distributedTracingMode;if(p=g.enableRequestHeaderTracking,v=g.enableAjaxErrorStatusText,m=g.enableAjaxPerfTracking,y=g.maxAjaxCallsPerView,b=g.enableResponseHeaderTracking,o=g.excludeRequestFromAutoTrackingPatterns,l=g.addRequestContext,r=_===ds.AI||_===ds.AI_AND_W3C,a=_===ds.AI_AND_W3C||_===ds.W3C,m){var M=h.instrumentationKey||"unkwn";s=M.length>5?"ai.ajxmn."+M.substring(M.length-5)+".":"ai.ajxmn."+M+"."}if(!1===g.disableAjaxTracking&&function(e){var t=!1;if(Ya()){var i=XMLHttpRequest.prototype;t=!($n(i)||$n(i.open)||$n(i.send)||$n(i.abort))}var n=qa();if(n&&n<9&&(t=!1),t)try{(new XMLHttpRequest).ajaxData={};var a=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=a}catch(i){t=!1,yl(e,Gi,"Failed to enable XMLHttpRequest monitoring, extension is not supported",{exception:Ga(i)})}return t}(e)&&!d&&(S(XMLHttpRequest,"open",{req:function(t,i,a,r){var s=t.inst,o=s.ajaxData;!E(s,a)&&P(s,!0)&&(o&&o.xhrMonitoringState.openDone||function(t,i,a,r){var s=n&&n.telemetryTrace&&n.telemetryTrace.traceID||Fr(),o=Fr().substr(0,16),l=new pl(s,o,e.diagLog());l.method=i,l.requestUrl=a,l.xhrMonitoringState.openDone=!0,l.requestHeaders={},l.async=r,l.errorStatusText=v,t.ajaxData=l}(s,i,a,r),function(t){t.ajaxData.xhrMonitoringState.stateChangeAttached=ia(t,"readystatechange",(function(){try{t&&4===t.readyState&&P(t)&&function(t){var i=t.ajaxData;function n(i,n){var a=n||{};a.ajaxDiagnosticsMessage=ml(t),i&&(a.exception=Ga(i)),bl(e,qi,"Failed to calculate the duration of the ajax call, monitoring data for this ajax call won't be sent.",a)}i.responseFinishedTime=Ds(),i.status=t.status,R("xmlhttprequest",i,(function(){try{var a=i.CreateTrackItem("Ajax",p,(function(){var e={statusText:t.statusText,headerMap:null,correlationContext:I(t),type:t.responseType,responseText:C(t),response:t.response};if(b){var i=t.getAllResponseHeaders();if(i){var n=ga(i).split(/[\r\n]+/),a={};ca(n,(function(e){var t=e.split(": "),i=t.shift(),n=t.join(": ");u(i)&&(a[i]=n)})),e.headerMap=a}}return e})),r=void 0;try{l&&(r=l({status:t.status,xhr:t}))}catch(t){bl(e,Kn,"Failed to add custom defined request context as configured call back may missing a null check.")}a?(void 0!==r&&(a.properties=ui(ui({},a.properties),r)),e.trackDependencyDataInternal(a)):n(null,{requestSentTime:i.requestSentTime,responseFinishedTime:i.responseFinishedTime})}finally{try{t.ajaxData=null}catch(e){}}}),(function(e){n(e,null)}))}(t)}catch(n){var i=Ga(n);i&&-1!==kl(i.toLowerCase(),"c00c023f")||yl(e,Ki,"Failed to monitor XMLHttpRequest 'readystatechange' event handler, monitoring data for this ajax call may be incorrect.",{ajaxDiagnosticsMessage:ml(t),exception:i})}}))}(s))},hkErr:Tl(e,Gi,"Failed to monitor XMLHttpRequest.open, monitoring data for this ajax call may be incorrect.")}),S(XMLHttpRequest,"send",{req:function(t,i){var n=t.inst,a=n.ajaxData;P(n)&&!a.xhrMonitoringState.sendDone&&(w("xhr",a),a.requestSentTime=Ds(),e.includeCorrelationHeaders(a,void 0,void 0,n),a.xhrMonitoringState.sendDone=!0)},hkErr:Tl(e,zi,"Failed to monitor XMLHttpRequest, monitoring data for this ajax call may be incorrect.")}),S(XMLHttpRequest,"abort",{req:function(e){var t=e.inst,i=t.ajaxData;P(t)&&!i.xhrMonitoringState.abortDone&&(i.aborted=1,i.xhrMonitoringState.abortDone=!0)},hkErr:Tl(e,ji,"Failed to monitor XMLHttpRequest.abort, monitoring data for this ajax call may be incorrect.")}),p&&S(XMLHttpRequest,"setRequestHeader",{req:function(e,t,i){var n=e.inst;P(n)&&u(t)&&(n.ajaxData.requestHeaders[t]=i)},hkErr:Tl(e,Wn,"Failed to monitor XMLHttpRequest.setRequestHeader, monitoring data for this ajax call may be incorrect.")}),d=!0),function(){var t=(i=si(),!i||$n(i.Request)||$n(i.Request.prototype)||$n(i.fetch)?null:i.fetch);var i;if(!t)return;var a=si(),r=t.polyfill;!1===g.disableFetchTracking?(T.push(Gr(a,"fetch",{req:function(t,i,a){var s;if(c&&!E(null,i,a)&&(!r||!d)){var o=t.ctx();s=function(t,i){var a=n&&n.telemetryTrace&&n.telemetryTrace.traceID||Fr(),r=Fr().substr(0,16),s=new pl(a,r,e.diagLog());s.requestSentTime=Ds(),s.errorStatusText=v,t instanceof Request?s.requestUrl=t?t.url:"":s.requestUrl=t;var o="GET";i&&i.method?o=i.method:t&&t instanceof Request&&(o=t.method);s.method=o;var l={};if(p){new Headers((i?i.headers:0)||t instanceof Request&&t.headers||{}).forEach((function(e,t){u(t)&&(l[t]=e)}))}return s.requestHeaders=l,w("fetch",s),s}(i,a);var l=e.includeCorrelationHeaders(s,i,a);l!==a&&t.set(1,l),o.data=s}},rsp:function(e,t){var i=e.ctx().data;i&&(e.rslt=e.rslt.then((function(n){return x(e,(n||{}).status,t,n,i,(function(){var e={statusText:n.statusText,headerMap:null,correlationContext:D(n)};if(b){var t={};n.headers.forEach((function(e,i){u(i)&&(t[i]=e)})),e.headerMap=t}return e})),n})).catch((function(n){throw x(e,0,t,null,i,null,{error:n.message}),n})))},hkErr:Tl(e,Gi,"Failed to monitor Window.fetch, monitoring data for this fetch call may be incorrect.")})),c=!0):r&&T.push(Gr(a,"fetch",{req:function(e,t,i){E(null,t,i)}}));r&&(a.fetch.polyfill=r)}(),k.length>0&&k){for(var N=void 0,O=0;!N&&O<k.length;)k[O]&&"AppInsightsPropertiesPlugin"===k[O].identifier&&(N=k[O]),O++;N&&(n=N.context)}}},e.teardown=function(){ca(T,(function(e){e.rm()})),T=[],c=!1,d=!1,e.setInitialized(!1)},e.trackDependencyData=function(t,i){e.trackDependencyDataInternal(t,i)},e.includeCorrelationHeaders=function(t,i,s,o){var l=e._currentWindowHost||h;if(i){if(xs.canIncludeCorrelationHeader(g,t.getAbsoluteUrl(),l)){if(s||(s={}),s.headers=new Headers(s.headers||i instanceof Request&&i.headers||{}),r){var u="|"+t.traceID+"."+t.spanID;s.headers.set(Yr,u),p&&(t.requestHeaders[Yr]=u)}if((d=g.appId||n&&n.appId())&&(s.headers.set(Kr,Xr+d),p&&(t.requestHeaders[Kr]=Xr+d)),a){var c=new vl(t.traceID,t.spanID);s.headers.set(Qr,c.toString()),p&&(t.requestHeaders[Qr]=c.toString())}}return s}if(o){if(xs.canIncludeCorrelationHeader(g,t.getAbsoluteUrl(),l)){if(r){u="|"+t.traceID+"."+t.spanID;o.setRequestHeader(Yr,u),p&&(t.requestHeaders[Yr]=u)}var d;if((d=g.appId||n&&n.appId())&&(o.setRequestHeader(Kr,Xr+d),p&&(t.requestHeaders[Kr]=Xr+d)),a){c=new vl(t.traceID,t.spanID);o.setRequestHeader(Qr,c.toString()),p&&(t.requestHeaders[Qr]=c.toString())}}return o}},e.trackDependencyDataInternal=function(t,i,n){if(-1===y||f<y){g.distributedTracingMode!==ds.W3C&&g.distributedTracingMode!==ds.AI_AND_W3C||"string"!=typeof t.id||"."===t.id[t.id.length-1]||(t.id+="."),$n(t.startTime)&&(t.startTime=new Date);var a=yo.create(t,io.dataType,io.envelopeType,e.diagLog(),i,n);e.core.track(a)}else f===y&&yl(e,wn,"Maximum ajax per page view limit reached, ajax monitoring is paused until the next trackPageView(). In order to increase the limit set the maxAjaxCallsPerView configuration parameter.",!0);++f}})),i}return di(t,e),t.getDefaultConfig=function(){return{maxAjaxCallsPerView:500,disableAjaxTracking:!1,disableFetchTracking:!0,excludeRequestFromAutoTrackingPatterns:void 0,disableCorrelationHeaders:!1,distributedTracingMode:ds.AI_AND_W3C,correlationHeaderExcludedDomains:["*.blob.core.windows.net","*.blob.core.chinacloudapi.cn","*.blob.core.cloudapi.de","*.blob.core.usgovcloudapi.net"],correlationHeaderDomains:void 0,correlationHeaderExcludePatterns:void 0,appId:void 0,enableCorsCorrelation:!1,enableRequestHeaderTracking:!1,enableResponseHeaderTracking:!1,enableAjaxErrorStatusText:!1,enableAjaxPerfTracking:!1,maxAjaxPerfLookupAttempts:3,ajaxPerfLookupDelay:25,ignoreHeaders:["Authorization","X-API-Key","WWW-Authenticate"],addRequestContext:void 0}},t.getEmptyConfig=function(){var e=this.getDefaultConfig();return na(e,(function(t){e[t]=void 0})),e},t.prototype.processTelemetry=function(e,t){this.processNext(e,t)},t.identifier="AjaxDependencyPlugin",t}(or),Pl=["snippet","dependencies","properties","_snippetVersion","appInsightsNew","getSKUDefaults"],Cl=function(){function e(e){var t=this;t._snippetVersion=""+(e.sv||e.version||""),e.queue=e.queue||[],e.version=e.version||2;var i=e.config||{};if(i.connectionString){var n=function(e){if(!e)return{};var t=function(e,t,i){var n,a=e.length,r=0;if(arguments.length>=3)n=arguments[2];else{for(;r<a&&!(r in e);)r++;n=e[r++]}for(;r<a;)r in e&&(n=t(n,e[r],r,e)),r++;return n}(e.split(";"),(function(e,t){var i=t.split("=");if(2===i.length){var n=i[0].toLowerCase(),a=i[1];e[n]=a}return e}),{});if(fa(t).length>0){if(t.endpointsuffix){var i=t.location?t.location+".":"";t.ingestionendpoint=t.ingestionendpoint||"https://"+i+"dc."+t.endpointsuffix}t.ingestionendpoint=t.ingestionendpoint||"https://dc.services.visualstudio.com"}return t}(i.connectionString),a=n.ingestionendpoint;i.endpointUrl=a?a+"/v2/track":i.endpointUrl,i.instrumentationKey=n.instrumentationkey||i.instrumentationKey}t.appInsights=new Do,t.properties=new ul,t.dependencies=new El,t.core=new Rr,t._sender=new $o,t.snippet=e,t.config=i,t.getSKUDefaults()}return e.prototype.getCookieMgr=function(){return this.appInsights.getCookieMgr()},e.prototype.trackEvent=function(e,t){this.appInsights.trackEvent(e,t)},e.prototype.trackPageView=function(e){var t=e||{};this.appInsights.trackPageView(t)},e.prototype.trackPageViewPerformance=function(e){var t=e||{};this.appInsights.trackPageViewPerformance(t)},e.prototype.trackException=function(e,t){e&&!e.exception&&e.error&&(e.exception=e.error),this.appInsights.trackException(e,t)},e.prototype._onerror=function(e){this.appInsights._onerror(e)},e.prototype.trackTrace=function(e,t){this.appInsights.trackTrace(e,t)},e.prototype.trackMetric=function(e,t){this.appInsights.trackMetric(e,t)},e.prototype.startTrackPage=function(e){this.appInsights.startTrackPage(e)},e.prototype.stopTrackPage=function(e,t,i,n){this.appInsights.stopTrackPage(e,t,i,n)},e.prototype.startTrackEvent=function(e){this.appInsights.startTrackEvent(e)},e.prototype.stopTrackEvent=function(e,t,i){this.appInsights.stopTrackEvent(e,t,i)},e.prototype.addTelemetryInitializer=function(e){return this.appInsights.addTelemetryInitializer(e)},e.prototype.setAuthenticatedUserContext=function(e,t,i){void 0===i&&(i=!1),this.properties.context.user.setAuthenticatedUserContext(e,t,i)},e.prototype.clearAuthenticatedUserContext=function(){this.properties.context.user.clearAuthenticatedUserContext()},e.prototype.trackDependencyData=function(e){this.dependencies.trackDependencyData(e)},e.prototype.flush=function(e){var t=this;void 0===e&&(e=!0),nr(this.core,(function(){return"AISKU.flush"}),(function(){ca(t.core.getTransmissionControls(),(function(t){ca(t,(function(t){t.flush(e)}))}))}),null,e)},e.prototype.onunloadFlush=function(e){void 0===e&&(e=!0),ca(this.core.getTransmissionControls(),(function(t){ca(t,(function(t){t.onunloadFlush?t.onunloadFlush():t.flush(e)}))}))},e.prototype.loadAppInsights=function(e,t,i){var n=this;void 0===e&&(e=!1);var a=this;return e&&a.config.extensions&&a.config.extensions.length>0&&Pa("Extensions not allowed in legacy mode"),nr(a.core,(function(){return"AISKU.loadAppInsights"}),(function(){var r=[];r.push(a._sender),r.push(a.properties),r.push(a.dependencies),r.push(a.appInsights),a.core.initialize(a.config,r,t,i),a.context=a.properties.context,Sl&&a.context&&(a.context.internal.sdkSrc=Sl),function(t){if(t){var i="";$n(a._snippetVersion)||(i+=a._snippetVersion),e&&(i+=".lg"),a.context&&a.context.internal&&(a.context.internal.snippetVer=i||"-"),na(a,(function(e,i){oa(e)&&!ta(i)&&e&&"_"!==e[0]&&-1===Pl.indexOf(e)&&(t[e]=i)}))}}(a.snippet),a.emptyQueue(),a.pollInternalLogs(),a.addHousekeepingBeforeUnload(n)})),a},e.prototype.updateSnippetDefinitions=function(e){!function(e,t,i){if(e&&t&&e!==t&&ea(e)&&ea(t)){var n=function(n){if(oa(n)){var a=t[n];ta(a)?i&&!i(n,!0,t,e)||(e[n]=(r=n,function(){var e=arguments;return t[r].apply(t,e)})):i&&!i(n,!1,t,e)||(Zn(e,n)&&delete e[n],ma(e,n,(function(){return t[n]}),(function(e){t[n]=e}))||(e[n]=a))}var r};for(var a in t)n(a)}}(e,this,(function(e){return e&&-1===Pl.indexOf(e)}))},e.prototype.emptyQueue=function(){var e=this;try{if(ra(e.snippet.queue)){for(var t=e.snippet.queue.length,i=0;i<t;i++){(0,e.snippet.queue[i])()}e.snippet.queue=void 0,delete e.snippet.queue}}catch(e){e&&ta(e.toString)&&e.toString()}},e.prototype.pollInternalLogs=function(){this.core.pollInternalLogs()},e.prototype.stopPollingInternalLogs=function(){this.core.stopPollingInternalLogs()},e.prototype.addHousekeepingBeforeUnload=function(e){if(La()||Ma()){var t=function(){e.onunloadFlush(!1),ca(e.appInsights.core._extensions,(function(e){if("AppInsightsPropertiesPlugin"===e.identifier)return e&&e.context&&e.context._sessionManager&&e.context._sessionManager.backup(),-1}))},i=!1,n=e.appInsights.config.disablePageUnloadEvents;e.appInsights.config.disableFlushOnBeforeUnload||(i=Or(t,n),(i=Ur(t,n)||i)||(a=Ua())&&a.product&&"ReactNative"===a.product||e.appInsights.core.logger.throwInternal(Ai.CRITICAL,Yi,"Could not add handler for beforeunload and pagehide")),i||e.appInsights.config.disableFlushOnUnload||Ur(t,n)}var a},e.prototype.getSender=function(){return this._sender},e.prototype.getSKUDefaults=function(){var e=this;e.config.diagnosticLogInterval=e.config.diagnosticLogInterval&&e.config.diagnosticLogInterval>0?e.config.diagnosticLogInterval:1e4},e}();function Il(e,t){var i=new AbortController,n=Rl(i.signal,"abort",(()=>{n();var t=Array.isArray(e)?e:[e];t.forEach((e=>"function"==typeof e?e():e instanceof AbortController?e.abort():clearTimeout(e))),t.length=0}));return void 0!==t&&wl(t,i),i}function wl(e,t){if(e.aborted)t.abort();else var i=Rl(e,"abort",(()=>{t.abort()})),n=Rl(t.signal,"abort",(()=>{n(),i()}))}function Rl(e,t,i,n){return e.addEventListener(t,i,n),()=>e.removeEventListener(t,i,n)}function Al(e){var t=Il([Rl(window,"beforeunload",(()=>{t.abort(),e()})),Rl(window,"pagehide",(()=>{t.abort(),e()}))]);return()=>t.abort()}!function(){var e=null,t=["://js.monitor.azure.com/","://az416426.vo.msecnd.net/"];try{var i=(document||{}).currentScript;i&&(e=i.src)}catch(e){}if(e)try{var n=e.toLowerCase();if(n)for(var a="",r=0;r<t.length;r++)if(-1!==n.indexOf(t[r])){a="cdn"+(r+1),-1===n.indexOf("/scripts/")&&(-1!==n.indexOf("/next/")?a+="-next":-1!==n.indexOf("/beta/")&&(a+="-beta")),Sl=a+"";break}}catch(e){}}();var xl=g("AppTracker");class Dl{constructor(e,t){this.destroyController=new AbortController,this.appInsights=void 0,this.commonProps=void 0,this.propsCallbacks=[],this.appInsights=e,this.commonProps=t,Il(Al((()=>this.appInsights.onunloadFlush())),this.destroyController.signal)}updateInstanceProps(e){Object.assign(this.commonProps,e)}addPropsCallback(e){this.propsCallbacks.includes(e)||this.propsCallbacks.push(e)}removePropsCallback(e){this.propsCallbacks=this.propsCallbacks.filter((t=>t!==e))}trackEvent(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var a=this.mergeProps(i);xl.debug("Sending event:",e,a),this.appInsights.trackEvent({name:e,properties:a})}trackMetric(e,t){for(var i=arguments.length,n=new Array(i>2?i-2:0),a=2;a<i;a++)n[a-2]=arguments[a];var r=this.mergeProps(n);xl.debug("Sending metric:",e,t,r),this.appInsights.trackMetric({name:e,average:t,properties:r})}trackException(e,t){for(var i=t?$s.Error:$s.Warning,n=arguments.length,a=new Array(n>2?n-2:0),r=2;r<n;r++)a[r-2]=arguments[r];var s=this.mergeProps(a);xl.debug("Sending exception:",name,s),this.appInsights.trackException({exception:e,severityLevel:i,properties:s})}startTrackEvent(e){this.appInsights.startTrackEvent(e)}stopTrackEvent(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];var a=this.mergeProps(i);this.appInsights.stopTrackEvent(e,a),xl.debug("Sent timed event:",e,a)}flush(){this.appInsights.flush()}destroy(){this.commonProps={},this.propsCallbacks=[],this.destroyController.abort()}mergeProps(e){return t=Object.assign({},this.commonProps,...this.propsCallbacks.map((e=>e())),...e),Object.keys(t).reduce(((e,i)=>{var n=t[i];return void 0!==n&&(e[i]=n),e}),{});var t}}var Ll,_l=g("GASender"),Ml={Id:"dimension1",Title:"dimension2",Year:"dimension3",Month:"dimension4",Day:"dimension5",ReferrerDomain:"dimension6",Referrer:"dimension7",UserIdHit:"dimension8",UserIdSession:"dimension9",SourceId:"dimension10",Category:"dimension23",Autoplay:"dimension24",MediaType:"dimension25",MediaCategory:"dimension26",MimeType:"dimension27",AdapterType:"dimension28",ErrorType:"dimension31",ErrorReason:"dimension30"},Nl={Started:"metric21",PlayedTime:"metric22",TotalPlayedTime:"metric23",Stopped:"metric24",TimeBehindLive:"metric25"};class Ol{constructor(e,t,i){this.coreTracker=void 0,this.commonFields=void 0,this.coreTracker=e,this.commonFields=t,this.updateFields(i||{})}updateFields(e){"fields"in e&&e.fields&&Object.assign(this.commonFields,e.fields),"userId"in e&&this.coreTracker("context",{userId:e.userId}),"sourceId"in e&&(this.commonFields[Ml.SourceId]=e.sourceId),"programId"in e&&(this.commonFields[Ml.Id]=e.programId),"autoplay"in e&&(this.commonFields[Ml.Autoplay]=e.autoplay?"Yes":"No"),"mimeType"in e&&(this.commonFields[Ml.MimeType]=e.mimeType),"adapterType"in e&&(this.commonFields[Ml.AdapterType]=e.adapterType)}sendEvent(e){var t=function(e){for(var t={},i=Object.keys(e),n=0;n<i.length;++n){var a=i[n],r=e[a];"string"==typeof r?r.length>0&&(t[a]=r):"number"==typeof r?Number.isFinite(r)&&(t[a]=r):null!=r&&(t[a]=r)}return t}(n({},this.commonFields,e));_l.debug("Sending:",t),this.coreTracker("event",{ga:t})}}!function(e){e.Quantile25="media-playback-25",e.Quantile50="media-playback-50",e.Quantile75="media-playback-75"}(Ll||(Ll={}));class Ul extends Ol{sendStartedEvent(e){this.sendEvent({eventCategory:"media-playback",eventAction:"media-playback-started",[Nl.PlayedTime]:e,[Nl.TotalPlayedTime]:e,[Nl.Started]:1})}sendQuantileEvent(e,t){this.sendEvent({eventCategory:"media-playback",eventAction:e,[Nl.PlayedTime]:t.range,[Nl.TotalPlayedTime]:t.total})}sendCompletedEvent(e){this.sendEvent({eventCategory:"media-playback",eventAction:"media-playback-completed",[Nl.PlayedTime]:e.range,[Nl.TotalPlayedTime]:e.total,[Nl.Stopped]:1})}sendProgressEvent(e){this.sendEvent({eventCategory:"media-playback",eventAction:"media-playback-progress",[Nl.PlayedTime]:e.range,[Nl.TotalPlayedTime]:e.total,[Nl.TimeBehindLive]:e.timeBehindLive})}sendContentConsumedEvent(e){this.sendEvent({eventCategory:"content-consumed",eventAction:"percentConsumed",eventValue:e,nonInteraction:!0})}sendAccumulatedSecondsEvent(e){this.sendEvent({eventCategory:"media-playback",eventAction:"media-playback-accumulated",eventLabel:e+"-seconds"})}sendAccumulatedCompleteEvent(){this.sendEvent({eventCategory:"media-playback",eventAction:"media-playback-accumulated",eventLabel:"completed-stream"})}}function Bl(e){return e.reduce(((e,t)=>e+t.end-t.start),0)}function Fl(e,t){if(!t)return e;for(var i=[],n=0;n<e.length;++n){var a=e[n];a.end>t.start&&a.start<t.end&&i.push({start:Math.max(t.start,a.start),end:Math.min(t.end,a.end)})}return i}function Vl(e){if(0===e.length)return[];e.sort(((e,t)=>e.start-t.start));for(var t=[e[0]],i=0,n=1;n<e.length;++n){var a=e[n];a.start>t[i].end?(t.push(a),i++):a.end>t[i].end&&(t[i].end=a.end)}return t}class Wl{constructor(){this.playedRanges=void 0,this.playedRangesSum=void 0,this.totalPlayingTimeListeners=void 0,this.startPosition=void 0,this.currentPosition=void 0,this.playedRanges=[],this.playedRangesSum=0,this.totalPlayingTimeListeners=[]}timeStarted(e){void 0===this.startPosition&&(this.startPosition=e)}timeStopped(e){if(void 0!==this.startPosition){var t=this.startPosition;if(e>t){var i={start:t,end:e},n=e-t;this.playedRanges.push(i),this.playedRangesSum+=n,this.checkTimeListeners(this.playedRangesSum)}this.startPosition=void 0,this.currentPosition=void 0}}timeUpdate(e){if(void 0!==this.startPosition&&e>=this.startPosition){this.currentPosition=e;var t=this.playedRangesSum+e-this.startPosition;this.checkTimeListeners(t)}}onceTotalPlayingTime(e,t,i){void 0===i&&(i=this);var n=this.getTotalPlayingTime();e<=n?t.call(i,n):(this.totalPlayingTimeListeners.push({time:e,handler:t,context:i}),this.totalPlayingTimeListeners.sort(((e,t)=>e.time-t.time)))}getTotalPlayingTime(){return void 0!==this.startPosition&&void 0!==this.currentPosition?this.playedRangesSum+this.currentPosition-this.startPosition:this.playedRangesSum}getDurationOfMediaPlayed(e){var t=[...this.playedRanges];return void 0!==this.startPosition&&void 0!==this.currentPosition&&t.push({start:this.startPosition,end:this.currentPosition}),Bl(Vl(Fl(t,e)))}destroy(){this.totalPlayingTimeListeners=[],this.playedRanges=[]}checkTimeListeners(e){for(;this.totalPlayingTimeListeners.length>0&&this.totalPlayingTimeListeners[0].time<=e;){var t=this.totalPlayingTimeListeners.shift();null==t||t.handler.call(t.context,e)}}}var Hl=[{hostname:"^[^.]*\\btv\\b[^.]*\\.nrk\\.no$",data:{name:"NRK TV"}},{hostname:"^[^.]*\\bradio\\b[^.]*\\.nrk\\.no$",data:{name:"NRK Radio"}},{hostname:"^[^.]*\\btv\\b[^.]*\\.nrksuper\\.no$",data:{name:"NRK Super TV"}},{hostname:"^(.+\\.)?nrksuper\\.no$",data:{name:"NRK Super"}},{hostname:"^(.+\\.)?p3\\.no$",data:{name:"NRK P3"}},{hostname:"^(.+\\.)?nrkbeta\\.no$",data:{name:"NRK beta"}},{hostname:"^(.+\\.)?yr\\.no$",data:{name:"Yr"}},{hostname:"\\b(felles\\.ds|preview|fil|kubeint|snutt|kurator)\\.nrk\\.no$",data:{environment:"internal"}},{hostname:"^static\\.nrk\\.no$",pathname:"^/dev/",data:{environment:"dev"}},{hostname:"(www|static)\\.nrk\\.no$",pathname:"^(/embed/.*|.*/video-embed(\\.html)?)$",data:{isVideoEmbed:!0}},{hostname:"\\.nrk\\.no$",data:{name:"NRK.no",options:{applicationInsights:{samplingPercentage:10}}}},{hostname:"^localhost$",data:{environment:"test"}},{hostname:"^[A-Za-z0-9]+$",data:{environment:"internal"}},{hostname:"^160\\.6[78]\\.\\d+\\.\\d+$",data:{environment:"internal"}},{hostname:"^\\d+\\.\\d+\\.\\d+\\.\\d+$",data:{environment:"test"}},{hostname:"^nrkno\\.github\\.io$",data:{environment:"test"}}];class jl{constructor(e){this.hasParent=void 0,this.localSite=void 0,this.parentSite=void 0;var{parentURL:t=document.referrer,localLocation:i=window.location,hasParent:n=window.top!==window.self}=e||{};if(this.hasParent=n,this.localSite=this.detectSite(i)||{},this.parentSite={},n&&t){var a=this.parseURL(t);a&&(this.parentSite=this.detectSite(a))}}get isEmbedded(){return!(!this.hasParent||!this.localSite.isVideoEmbed)}get environment(){return this.parentSite.environment?this.parentSite.environment:this.localSite.environment?this.localSite.environment:!this.hasParent&&this.localSite.isVideoEmbed?"embed-test":void 0}get isProduction(){return!this.environment}get name(){var e=this.parentSite.name||this.localSite.name;return e&&this.isProduction?e:this.parentSite.location&&this.parentSite.location.hostname?this.parentSite.location.hostname:this.isEmbedded?"N/A":this.localSite.location&&this.localSite.location.hostname?this.localSite.location.hostname:"N/A"}get fullName(){var e=[];return this.environment&&(this.parentSite.configuredEnvironment||this.localSite.configuredEnvironment||"embed-test"===this.environment)&&e.push(this.environment),this.isEmbedded&&e.push("embed"),e.length?this.name+" ("+e.join(", ")+")":this.name}get options(){return this.parentSite.options||this.localSite.options||{}}parseURL(e){return new URL(e)}detectSite(e){var t={location:e},{hostname:i,pathname:n}=e,a=this.matchSite(i,n);if(a)if(Object.assign(t,a),t.environment)t.configuredEnvironment=!0;else{var r=this.matchEnvironment(i);r&&(t.environment=r,t.options=void 0)}return t}matchSite(e,t){var i=Hl.find((i=>new RegExp(i.hostname).test(e)&&(!i.pathname||new RegExp(i.pathname).test(t))));return i?i.data:void 0}matchEnvironment(e){var t=/\b(dev|preprod|stage|test)\b/.exec(e);return t?t[1]:void 0}}var ql;function Gl(e,t,i){var n=t.config.beacon+"?enableGenericAPI=1";window.AKAMAI_MEDIA_ANALYTICS_CONFIG_FILE_PATH=n;var a=new e(n);return a.disableServerIPLookUp(),a.disableLocation(),a.setStreamURL(i,!1),["title","device","deliveryType","cdn","cdnName","category","subCategory","show","contentLength","playerId","playerInfo"].forEach((e=>a.setData(e,t.data[e]))),a}function Kl(e,t){void 0===t&&(t={});var i=new Cl({config:n({instrumentationKey:e},{disableExceptionTracking:!0,disableAjaxTracking:!0,maxBatchInterval:1e3,enableSessionStorageBuffer:!1,isStorageUseDisabled:!0,isRetryDisabled:!0},t)});return i.loadAppInsights(),i}!function(e){e.Test="d4e0f7d6-9fdb-42e9-b8f8-91ff288d01af",e.Stage="f4cf2c52-4917-43bd-b257-d82b0a681e18",e.Prod="ff70c9d2-d463-4e98-acb2-b1862bbddde1"}(ql||(ql={}));var zl=g("AkamaiTracker");var Xl;function Yl(e,t,i,n,a,r){var s;e.once(v.MediaInfoLoaded,(t=>{n.updateFields({adapterType:e.getAdapterInfo().tech,mimeType:t.mediaType.type})})),e.once(v.MediaRangeChange,(a=>{if(e.isLiveStream()){t.onceTotalPlayingTime(3,(()=>{n.sendStartedEvent(Math.round(t.getTotalPlayingTime()))}));var s,o=6e5,l=0,u=()=>{void 0!==s&&s.abort(),s=Il(setTimeout((()=>u()),o),r);var i=e.getScrubberValues(),a=i.endPosition-i.playheadPosition,c=t.getDurationOfMediaPlayed(),d=c-l;l=c,n.sendProgressEvent({range:d,total:c,timeBehindLive:a})};i.on("programchange",(e=>{u(),n.updateFields({programId:e})})),e.isTimeRunning()?s=Il(setTimeout((()=>u()),o),r):e.once(v.TimeRunningChange,(()=>{s=Il(setTimeout((()=>u()),o),r)})),e.on(v.Broken,(()=>{u(),void 0!==s&&(s.abort(),s=void 0)})),e.on(v.SessionClosed,(()=>u())),Il(Al((()=>u())),r)}else{var c=a.end;!function(e,t,i){var n=e.getMediaRange().end;if(n<3)return;var a=new Promise((e=>{t.onceTotalPlayingTime(3,(()=>{i.sendStartedEvent(Math.round(t.getTotalPlayingTime())),e()}))})),r=e.createTimeRangeEventTrack();r.on("enter",(e=>{r.removeRange(e.range),a.then((()=>{var n=e.range.data,a={range:Math.round(t.getDurationOfMediaPlayed(n.targetRange)),total:Math.round(t.getDurationOfMediaPlayed())};"complete"===n.name?i.sendCompletedEvent(a):i.sendQuantileEvent(n.name,a)})).catch((e=>console.error(e)))}));var s={start:0,end:.25*n},o={start:.25*n,end:.5*n},l={start:.5*n,end:.75*n},u={start:.75*n,end:.95*n},c={start:.95*n,end:n+1};r.addRange(o,{name:Ll.Quantile25,targetRange:s}),r.addRange(l,{name:Ll.Quantile50,targetRange:o}),r.addRange(u,{name:Ll.Quantile75,targetRange:l}),r.addRange(c,{name:"complete",targetRange:u})}(e,t,n),t.onceTotalPlayingTime(.9*c,(()=>{n.sendAccumulatedCompleteEvent()}));var d=()=>{d=void 0;var e=t.getDurationOfMediaPlayed();if(e>0){var i=Math.round(e/c*100);n.sendContentConsumedEvent(i)}};e.on(v.SessionClosed,(()=>null==d?void 0:d())),Il(Al((()=>null==d?void 0:d())),r)}})),null==(s=a.accumulatedTimeEvents)||s.forEach((e=>{t.onceTotalPlayingTime(e,(()=>{n.sendAccumulatedSecondsEvent(e)}))}))}class Ql{constructor(e,t,i){this.config=void 0,this.client=void 0,this.adapter=void 0,this.stream=void 0,this.programId=void 0,this.config=t,this.client=new e(t.springStreamSite||"test"),this.adapter=this.createAdapter(i),this.programId=t.springStreamProgramId}createAdapter(e){return{getMeta:()=>({pl:e.getPlayerName(),plv:e.getPlayerVersion(),sx:window.screen.width,sy:window.screen.height}),getDuration:()=>e.isLive()?0:Math.round(e.getDuration()),getPosition:()=>e.isLive()?e.getCurrentLiveTime():e.getCurrentTime()}}createDescription(){var e;return{stream:this.config.springStreamStream,ct:this.config.springStreamContentType,cq:null==(e=this.programId)?void 0:e.toUpperCase()}}start(){this.stream||(this.stream=this.client.track("nrk",this.createDescription(),this.adapter))}stop(){this.stream&&(this.stream.stop(),this.stream=void 0)}updateProgramId(e){this.programId!==e&&(this.programId=e,this.stream&&(this.stop(),this.start()))}get libraryVersion(){return this.client.version}}!function(e){e.Unknown="unknown",e.Media="media",e.Network="network"}(Xl||(Xl={}));class $l{constructor(e){this.appTracker=e}log(e,t,i){for(var n=arguments.length,a=new Array(n>3?n-3:0),r=3;r<n;r++)a[r-3]=arguments[r];if("Metric"!==e){if("AppTracker"!==e&&t===T.Error){if(i instanceof k||a.some((e=>e instanceof k)))return;this.appTracker.trackEvent("log-error",{namespace:e,message:""+i,log:[i,...a]})}}else this.appTracker.trackMetric(i,a[0])}}class Jl extends S{}class Zl{constructor(e,t,i){this.programId=void 0,this.playbackStartTime=0,this.finalized=!1,this.trackingCallback=void 0,this.programId=e,this.playbackStartTime=t,this.trackingCallback=i}reportPlaybackProgress(e,t){this.finalized||(this.playbackStartTime=e,this.trackingCallback({playbackStartTime:e,timePlayed:t,programId:this.programId}))}finalizeProgressReporting(e){e&&(this.trackingCallback({playbackStartTime:this.playbackStartTime,timePlayed:e,programId:this.programId}),this.finalized=!0)}}class eu{constructor(e){this.trackingCallback=void 0,this.trackingCallback=e}sendCompleteEvent(){this.trackingCallback(E.EcommerceConsumeComplete)}sendStartEvent(){this.trackingCallback(E.EcommerceConsumeStart)}}var tu,iu=g("PlayerTracker");function nu(e,t){var i,n=new jl(t?{parentURL:t}:void 0),a=Kl(n.isProduction?ql.Prod:ql.Stage,n.options.applicationInsights);iu.log("Site:",n.fullName);var r={applicationName:e.name,applicationVersion:e.version,applicationFamily:null!=(i=e.family)?i:"player-core",hostname:window.location.hostname,site:n.fullName,parentURL:t};return new Dl(a,r)}var au=a(Object.freeze({__proto__:null,AppTracker:Dl,DimensionMap:Ml,GASender:Ol,GATracker:Ul,get InstrumentationKey(){return ql},MetricMap:Nl,PlayedTimeCollector:Wl,PlayerTracker:class{constructor(e,t){this.gaAppId=void 0,this.playerInfo=void 0,this.coreAnalyticsTracker=void 0,this.scoresLibrary=void 0,this.akamaiLibrary=void 0,this.appTracker=void 0,this.progressTracker=void 0,this.playerInfo=e;var{gaTrackingId:i,gaAppId:n,scoresLibrary:a,akamaiLibrary:r,parentURL:s}=t;this.gaAppId=null!=n?n:"",i&&(this.coreAnalyticsTracker=function(e,t,i){var n=t.replace(/[^\w]/g,"_").replace(/__+/g,"_").toLowerCase()+"_"+Xt.slug();iu.log("Creating CoreAnalytics tracker with name:",n);var a=Jt.create();return a("initialize",{ga:e,trackerName:n,debug:i}),a}(i,e.name)),this.scoresLibrary=a,this.akamaiLibrary=r,this.appTracker=nu(e,s),void 0===tu&&(iu.log("Creating shared app tracker for log tracking."),tu=nu(e,s),p(new $l(tu)))}trackSession(e,t){var i,a=Xt(),r=new AbortController,s=function(e){var t=new Wl;return e.on(v.TimeRunningChange,(e=>{e.isTimeRunning?t.timeStarted(e.time):t.timeStopped(e.time)})),e.on(v.TimeUpdate,(e=>{t.timeUpdate(e)})),t}(e),o=new Jl,l={setLiveProgramId:e=>o.emit("programchange",e),playedTimeCollector:s};if(e.on(v.SessionClosed,(()=>{r.abort(),s.destroy(),o.removeAllListeners()})),t.ga&&this.coreAnalyticsTracker){iu.log("Tracking session with GA.");var u=new Ul(this.coreAnalyticsTracker,{appId:this.gaAppId,appName:this.playerInfo.name,appVersion:this.playerInfo.version},t.ga.fields);Yl(e,s,o,u,t.ga,r.signal),l.gaSender=u}var c=new eu(t.ecommerce.trackingCallback);if(function(e,t,i){e.once(v.MediaRangeChange,(e=>{i.onceTotalPlayingTime(120,(()=>{t.sendStartEvent()})),i.onceTotalPlayingTime(.9*e.end,(()=>{t.sendCompleteEvent()}))}))}(e,c,s),t.progress&&(iu.log("Tracking session with PSAPI progress tracker"),this.progressTracker=new Zl(t.progress.programId,t.progress.playbackStartTime,t.progress.trackingCallback),function(e,t,i,n){var a,r=!1,s=i,o=()=>{void 0!==a&&(a.abort(),a=void 0)},l=()=>{void 0!==a&&(a.abort(),a=void 0),a=Il(setTimeout((()=>l()),3e4),n),r&&t.reportPlaybackProgress(s,e.getCurrentTime())};e.once(v.MediaRangeChange,(async i=>{if(!e.isLiveStream()){var a=e.createTimeRangeEventTrack();a.addRange({start:120,end:e.getScrubberRange().end}),a.on("enter",(e=>{a.removeRange(e.range),r=!0,l()})),Il(Al((()=>{r&&t.reportPlaybackProgress(s,e.getCurrentTime()),o()})),n)}})),e.on(v.WaitingChange,(t=>{t.isWaiting||"seeking"!==t.reason||(s=e.getCurrentTime())})),e.on(v.TimeRunningChange,(i=>{r&&(i.isTimeRunning?(o(),a=Il(setTimeout((()=>l()),3e4),n)):(t.reportPlaybackProgress(s,e.getCurrentTime()),o()))})),e.on(v.Broken,(()=>{r&&t.reportPlaybackProgress(s,e.getCurrentTime()),o()}))}(e,this.progressTracker,t.progress.playbackStartTime,r.signal)),t.scores&&this.scoresLibrary&&(iu.log("Tracking session with TNS Scores."),i=function(e,t,i,n,a){var r=function(e,t){return{getPlayerName:()=>t.playerName,getPlayerVersion:()=>t.playerVersion,isLive:()=>e.isLiveStream(),getDuration:()=>e.getMediaRange().end,getCurrentTime:()=>e.getCurrentTime(),getCurrentLiveTime:()=>e.getCurrentTimeLive().getTime()/1e3}}(e,n),s=new Ql(i,n.config,r);return e.on(v.Broken,(()=>s.stop())),e.on(v.SessionClosed,(()=>s.stop())),Il(Al((()=>s.stop())),a),t.on("programchange",(e=>s.updateProgramId(e))),e.on(v.PlayingChange,(e=>{e.isPlaying?void 0!==e.type&&s.start():e.pausedReason===m.Ended&&s.stop()})),e.isPlaying()&&s.start(),s}(e,o,this.scoresLibrary,{playerName:this.playerInfo.name,playerVersion:this.playerInfo.version,config:t.scores.config},r.signal)),t.akamai&&this.akamaiLibrary){iu.log("Tracking session with Akamai/Luna.");var d=e.getMediaInfo().src,h=Gl(this.akamaiLibrary,{data:n({},t.akamai.config.data,{playerId:this.playerInfo.name}),config:t.akamai.config.config},d);!function(e,t){var i=new AbortController,n=t,a=!1,r=()=>{n=void 0,i.abort(),zl.log("Akamai tracker stopped.")};e.on(v.PlayingChange,(t=>{var i,s,o;if(t.isPlaying)t.type===f.Starting?(null==(i=n)||i.handleSessionInit({streamHeadPosition:()=>a?e.getCurrentTimeLive().getTime()/1e3:e.getCurrentTime()}),e.isTimeRunning()?null==(s=n)||s.handlePlaying():e.once(v.TimeRunningChange,(()=>{var e;null==(e=n)||e.handlePlaying()}))):null==(o=n)||o.handlePlaying();else if(t.pausedReason===m.Ended){var l;null==(l=n)||l.handlePlayEnd("Play.End.Detected"),r()}else{var u;null==(u=n)||u.handlePause()}})),e.once(v.MediaInfoLoaded,(()=>{a=e.isLiveStream()})),e.on(v.MediaRangeChange,(e=>{var t;null==(t=n)||t.setStreamDuration(e.end-e.start)})),e.on(v.WaitingChange,(e=>{var t,i;if(e.reason===y.Seeking)e.isWaiting?null==(t=n)||t.handleSeekStart():null==(i=n)||i.handleSeekEnd();else if(e.reason===y.Rebuffering){var a,r;e.isWaiting?null==(a=n)||a.handleBufferStart():null==(r=n)||r.handleBufferEnd()}})),e.on(v.QualityChange,(e=>{var t;null==(t=n)||t.handleBitRateSwitch(e.bitrate)})),e.on(v.Broken,(e=>{var t,i,a=e.error;null==(t=n)||t.handleError(a?a.causeSummary+": "+a.getCauseAsString():"Unknown error"),null==(i=n)||i.handleApplicationExit(),r()})),e.on(v.SessionClosed,(()=>{var e;null==(e=n)||e.handleApplicationExit(),r()})),Il(Al((()=>{var e;null==(e=n)||e.handleApplicationExit(),r()})),i.signal)}(e,h)}iu.log("Tracking session with App Insights.");var g=()=>{var t,n,r,s,o=e.getCurrentTimeLive(),l=void 0!==o?o.getTime()/1e3:e.getCurrentTime();return{trackingSession:a,mediaInfo:e.getMediaInfo(),adapterInfo:e.getAdapterInfo(),documentHidden:"webkitHidden"in document?document.webkitHidden:document.hidden,versions:{PlayerCore:P,SpringStreams:null!=(t=null==(n=i)?void 0:n.libraryVersion)?t:"none",CoreAnalytics:null!=(r=null==(s=this.coreAnalyticsTracker)?void 0:s.version)?r:"none"},playback:{time:l,position:e.getCurrentTime(),quality:e.getCurrentQuality(),rate:e.getPlaybackRate(),state:e.getState(),waitingReason:e.getWaitingReason(),pausedReason:e.getPausedReason(),mediaRange:e.getMediaRange()},displayModes:{pip:e.getPiPState(),fullscreen:e.getFullscreenState(),remote:e.getRemotePlaybackState()}}};if(this.appTracker.addPropsCallback(g),e.once(v.SessionClosed,(()=>this.appTracker.removePropsCallback(g))),function(e,t,i){var a;e.once(v.MediaInfoLoaded,(()=>{t.trackEvent("player-core-media-info-loaded")})),e.on(v.PlayingChange,(e=>{e.pausedReason===m.AutoplayBlocked?t.trackEvent("player-core-autoplay-blocked"):void 0!==e.type&&t.trackEvent("player-core-"+e.type)})),e.once(v.TimeRunningChange,(e=>{e.isTimeRunning&&t.trackEvent("player-core-playing")})),e.on(v.WaitingChange,(e=>{if(e.isWaiting)void 0!==a&&a.stillWaitingTimeout.abort(),a={reason:e.reason,startTime:Date.now(),stillWaitingTimeout:Il(setTimeout((()=>{var i="player-core-duration-"+e.reason+"-20s";t.trackEvent(i,{duration:2e4})}),2e4),i)};else{var n,r;if((null==(n=a)?void 0:n.reason)!==e.reason)return null==(r=a)||r.stillWaitingTimeout.abort(),void(a=void 0);var s=Date.now()-a.startTime,o="player-core-duration-"+a.reason;a.stillWaitingTimeout.abort(),a=void 0,t.trackEvent(o,{duration:s})}})),Il([Rl(document,"visibilitychange",(()=>{var e;null==(e=a)||e.stillWaitingTimeout.abort(),a=void 0})),Rl(document,"webkitvisibilitychange",(()=>{var e;null==(e=a)||e.stillWaitingTimeout.abort(),a=void 0})),Al((()=>{if(void 0!==a){var e;null==(e=a)||e.stillWaitingTimeout.abort();var i=Date.now()-a.startTime;t.trackEvent("player-core-duration-"+a.reason+"-exit",{duration:i})}}))],i),e.on(v.Broken,(e=>{var i=e.error;if(t.trackEvent("player-core-broken",{error:i}),i){var a=n({},i,{cause:i.getCauseAsString()});t.trackException(a,i.fatal)}})),e.once(v.SessionClosed,(()=>{t.flush()}))}(e,this.appTracker,r.signal),t.metadata){var p;iu.log("Tracking playback errors.");var T=this.playerInfo;!function(e,t,i){t.on(v.Broken,(n=>{var a,r=n.error;if(r){var s=t.getMediaInfo().src,o=new URL(s),l={[b.PLAYBACK_STOPPED_DECODE_ERROR]:Xl.Media,[b.PLAYBACK_STOPPED_NETWORK_ERROR]:Xl.Network,[b.NO_PLAYBACK_NETWORK_ERROR]:Xl.Network,[b.NO_PLAYBACK_DECODE_ERROR]:Xl.Media,[b.UNKNOWN_ERROR]:Xl.Unknown,[b.UNSUPPORTED_FORMAT_ERROR]:Xl.Media}[r.type],u=t.isLiveStream();e.trackEvent("nativePlayerError",{Properties:Object.assign({mediaUrlHost:o.host,mediaUrlPath:o.pathname,mediaUrlQuery:o.search,playerTime:""+Math.floor(u?t.getCurrentTimeLive().getTime()/1e3:t.getCurrentTime()),playerIsRunningInBackground:"n/a",streamingMode:u?"live":"onDemand",errorCategory:l,errorType:r.type,errorCode:"n/a",errorDescription:r.message,underlyingErrorType:null!=(a=r.causeSummary)?a:"n/a",underlyingErrorCode:"n/a",underlyingErrorDescription:r.getCauseAsString()},i)})}}))}(this.appTracker,e,n({platform:null!=(p=T.platform)?p:"web",applicationName:T.name,applicationVersion:T.version},t.metadata))}return l}destroy(){this.appTracker.destroy()}},get Quantile(){return Ll},ScoresTracker:Ql,Site:jl,clipRanges:Fl,createAkamaiTracker:Gl,defaultAkamaiMediaAnalyticsURL:{http:"http://79423.analytics.edgesuite.net/ma_library/javascript/javascript_malibrary.js",https:"https://79423.analytics.edgekey.net/ma_library/javascript/javascript_malibrary.js"},initAppInsights:Kl,mergeOverlappingRanges:Vl,siteConfigs:Hl,summarizeRanges:Bl}));function ru(e){this.namespace="com.kantarmedia.sensors.javascript",this.version="2.5.7";var t="tns-cs.net",i="default",n=new Array;this.namespace="com.kma.springstreams",this.updateTimer=!1,this.syncTimer=!1,this.syncrate=20,this.pausesync=6,this.maxstates=50,this.workerRunning=!1;var a,r,s=!0,o={"+":"%2B",",":"%2C",";":"%3B","=":"%3D","~":"%7E","*":"%2A","'":"%27","!":"%21","(":"%28",")":"%29"},l=this,u=!0;!function(e){var t;if(e){for(var i in e)0;t&&function(e){e&&(r=e)}(t.syncrates)}}({"2cnt.net":{syncrates:[3,7,10,10,10,10,10,60]}}),e&&(i=e);var c=!1;if((window.navigator.userAgent.indexOf("MSIE ")>0||navigator.userAgent.match(/Trident.*rv\:11\./))&&(c=!0),window.URL&&window.Blob&&window.Worker&&!c||(u=!1),u)var d=new Blob(['onmessage = function (evt) {if(evt.data == "start"){postMessage("open");if(!self.updateTimer)self.updateTimer = setInterval(()=>{postMessage("update")},200);if(!self.syncTimer)self.syncTimer = setInterval(()=>postMessage("sync"),2000);}if(evt.data == "stop"){clearInterval(self.updateTimer);clearInterval(self.syncTimer);postMessage("close");self.close();}};'],{type:"text/javascript"}),h=URL.createObjectURL(d);function g(){a=new Worker(h),l.workerRunning=!0,a.onmessage=function(e){"open"==e.data&&(l.updateTimer=l.syncTimer=!0),"sync"==e.data&&m(),"update"==e.data&&f(),"close"==e.data&&(l.workerRunning=!1)},a.onerror=function(e){l.workerRunning=!1,a.postMessage("stop"),console.error(e.message),p()}}if(u)try{g()}catch(e){l.workerRunning=!1,u=!1}function p(){l.updateTimer||(l.updateTimer=setInterval(f,200)),l.syncTimer||(l.syncTimer=setInterval(m,2e3))}function v(){clearInterval(l.updateTimer),clearInterval(l.syncTimer),l.updateTimer=!1,l.syncTimer=!1,this.workerRunning=!1,u&&a.postMessage("stop");for(var e=0;e<n.length;++e)try{n[e].stop()}catch(e){y(e)}}function f(e){for(var t=0;t<n.length;++t)try{n[t].update(e)}catch(e){y(e)}}function m(e){for(var t=0;t<n.length;++t)try{n[t].sync()}catch(e){y(e)}}function y(e){T("",e)}function b(e,t){return k([[e,t]])}function T(e,n){if(void 0!==l.pageContext.tracking&&(s=l.pageContext.tracking),s)if(void 0===n.stream||""==n.stream)l.warn("Stream is mandatory for measurement");else{var a=(void 0===l.pageContext.getWindowLocationURL()?"http://":"https"===l.pageContext.getWindowLocationURL().slice(0,5)?"https://":"http://")+function(e){return e&&void 0!==e.site?e.site:i}(n)+"."+t+"/j0="+b(e,n)+"?lt="+(new Date).getTime().toString(36)+function(){if(!l.nlso)try{var e,i="i00";if(void 0!==l.pageContext.getUniqueId&&(i=t),e=l.pageContext.getLocalStorageItem(i))return"&c="+e;var n="0000",a=n+Math.ceil((new Date).getTime()/1e3).toString(16)+(32768|65535*Math.random()).toString(16)+n;l.pageContext.setLocalStorageItem(i,a)}catch(e){l.warn("error"+e)}return""}();l.pageContext.preloadImage(a),l.debug(a)}}function k(e){var t,i,n,a,r,s=/[+&,;=~!*'()]/g;switch(typeof e){case"string":return s.test(e)?encodeURIComponent(e).replace(s,(function(e){var t=o[e];return t||e})):encodeURIComponent(e);case"number":return isFinite(e)?e.toString():"null";case"boolean":case"null":return e.toString();case"object":if(!e)return"null";if(t=[],"number"==typeof e.length&&!e.propertyIsEnumerable("length")){for(a=e.length,i=0;i<a;i+=1)t.push(k(e[i])||"null");return","+t.join("+")+";"}for(n in e)"string"==typeof n&&"site"!==n&&(r=k(e[n]))&&t.push(k(n)+"="+r);return","+t.join("+")+";"}return""}function S(e,t,i,n){var a,r="";a=Math.round(1e10*Math.random()).toString(36),r=(new Date).getTime().toString(36)+a;var s,o,u,c,d,h,g,p,v=Math.round((new Date).getTime()/1e3),f=[0,0,v.toString(36)],m=0,b=0,T=!0,k=!1,S=0;function E(e){(function(e){u.length<s.maxstates&&u.push(e)})(f=[e,e,Math.round((new Date).getTime()/1e3).toString(36)]),T=!0,m=0}function P(){null!=g&&p<g.length&&(h=g[p++],s.debug("switch syncrate to "+h))}function C(){void 0!==l.pageContext.getSerialNumber?l.pageContext.getSerialNumber(I):I()}function I(){if(T){try{o.width&&(c.sx=o.width),o.videoWidth&&(c.sx=o.videoWidth),o.height&&(c.sy=o.height),o.videoHeight&&(c.sy=o.videoHeight)}catch(e){}var e;void 0!==l.pageContext.getUniqueId&&(c.psid=l.pageContext.getUniqueId()),c.uid=r,c.pst=u;try{c.dur&&0!==c.dur||(c.dur=d.getDuration(o))}catch(e){}try{e=d.getMeta(o),void 0!==l.pageContext.getDeviceID&&void 0!==l.pageContext.getDeviceID()&&(e[l.pageContext.getDeviceID().id_name]=l.pageContext.getDeviceID().id_value)}catch(e){}void 0===e.v&&(e.v="js "+l.version),c.vt=Math.round((new Date).getTime()/1e3)-v,void 0!==l.pageContext&&void 0!==l.pageContext.addElectronParameters&&(l.pageContext.addElectronParameters(c),e.v="E "+l.version),void 0!==l.pageContext&&void 0!==l.pageContext.isCasting&&l.pageContext.isCasting(),void 0!==l.pageContext&&void 0!==l.pageContext.getChromecastID&&(e.v="C "+l.version,e.cid=l.pageContext.getChromecastID()),s.send(e,c),b=f[1]}T=!1}s=e,o=t,d=n||s.HTML5Adapter,c=function(e){var t=new Object;for(var i in e)t[i]=e[i];return t}(i),(u=new Array).push(f),p=0,h=e.syncrate,g=e.getSyncRates(),P(),this.update=function(e){if(!k){var t=f[1],i=t;try{i=Math.round(d.getPosition(o))}catch(e){}try{if(t===i)return void(m>=0&&++m===s.pausesync&&(T=!0));m>=s.pausesync?E(i):t<i-1||t>i?function(e){setTimeout((function(){e==Math.round(d.getPosition(o))||e+1==Math.round(d.getPosition(o))?++S>=5&&(S=0,(e-f[1]>1||f[1]-e>1)&&E(e)):S=0}),200)}(i):(f[1]=i,f[1]-f[0]>=h&&i-b>=h&&(T=!0,P()),m=0)}catch(e){y=!0,s.error(e)}}},this.stop=function(){k||(T=!0,k=!0,C())},this.sync=C}function E(e,t){localStorage.setItem(e,t)}function P(e){return localStorage.getItem(e)}this.getSyncRates=function(){return r},this.track=function(e,t,i){u?function(){l.workerRunning||g();a.postMessage("start")}():p();var r=i;if(void 0===l.pageContext&&(window.cordova?"browser"===device.platform?(l.debug("Detected cordova browser-mode falling back to HTML5 context / adapter"),l.pageContext=l.defaultPageContext,r=this.HTML5Adapter):(l.nlso=!0,l.debug("Detected cordova context"),l.pageContext=l.cordovaPageContext):l.pageContext=l.defaultPageContext),void 0!==l.pageContext.generateId&&l.pageContext.generateId(),e){void 0!==l.pageContext&&void 0!==l.pageContext.initHooks&&l.pageContext.initHooks();var s=new S(this,e,t,r);return n.push(s),s}},this.unload=v,this.doUpdate=f,this.doSync=m,this.error=y,this.debug=function(e){console.debug(e)},this.warn=function(e){console.warn(e)},this.send=T,this.defaultPageContext={getLocalStorageItem:P,setLocalStorageItem:E,preloadImage:function(e){(new Image).src=e},getWindowLocationURL:function(){return document.location.href},initHooks:function(){}},this.cordovaPageContext={getLocalStorageItem:P,setLocalStorageItem:E,preloadImage:function(e){var t="Cordova <"+device.platform+" "+device.version+">";cordova.plugin.http.setHeader("User-Agent",t),cordova.plugin.http.sendRequest(e,{method:"get"},(function(e){l.debug("Request respopnse: "+e.status)}),(function(e){l.warn("Request respopnse: "+e.status+":"+e.error)}))},getWindowLocationURL:function(){return"https://"},initHooks:function(){if(null==l.cordovaSetCloseHook){l.cordovaSetCloseHook,document.addEventListener("pause",(function(){v()}),!1)}}},this.HTML5Adapter={getMeta:function(e){return{pl:"HTML 5 Video",plv:"HTML 5",sx:screen.width,sy:screen.height}},getPosition:function(e){return e.currentTime},getDuration:function(e){return Math.round(e.duration)}},this.DefaultAdapter={getMeta:function(e){return{pl:"DEF",plv:version,sx:screen.width,sy:screen.height}},getPosition:function(e){return(new Date).getTime()/1e3},getDuration:function(e){return 0}},this.WMStreamAdapter={getMeta:function(e){return{pl:"MSWM",plv:e.versionInfo,sx:screen.width,sy:screen.height}},getPosition:function(e){if(e.CurrentPosition)return e.CurrentPosition;if(e.currentPosition)return e.currentPosition;if(e.controls&&e.controls.currentPosition)return e.controls.currentPosition;if(e.Controls&&e.Controls.currentPosition)return e.Controls.currentPosition;return 0},getDuration:function(e){if(e.currentMedia){if(e.currentMedia.Duration)return e.currentMedia.Duration;if(e.currentMedia.duration)return e.currentMedia.duration}else if(e.CurrentMedia){if(e.CurrentMedia.duration)return e.CurrentMedia.duration;if(e.CurrentMedia.Duration)return e.CurrentMedia.Duration}}},this.RVStreamAdapter={getMeta:function(e){return{pl:"RV",plv:e.GetVersionInfo(),sx:screen.width,sy:screen.height}},getPosition:function(e){return e.GetPosition()/1e3},getDuration:function(e){return e.GetLength()/1e3}},this.HTML5CordovaAdapter={getMeta:function(e){var t="CDV "+l.version;void 0===l.cordovaAppName&&(l.cordovaAppName="",cordova.getAppVersion.getAppName().then((function(e){l.cordovaAppName=e})));void 0===l.cordovaAppVersion&&(l.cordovaAppVersion="",cordova.getAppVersion.getVersionNumber().then((function(e){l.cordovaAppVersion=e})));return"Android"==device.platform?(l.cordovaGID=su(device.uuid).substring(0,16),void 0===l.cordovaAID&&(l.cordovaAID="",void 0!==cordova.plugins.idfa&&cordova.plugins.idfa.getInfo().then((function(e){l.cordovaAID=su(e.aaid).substring(0,16),l.cordovaLimitAdTracking=e.limitAdTracking}))),{pl:"HTML 5 Video",plv:"HTML 5",v:t,sx:screen.width,sy:screen.height,aid:l.cordovaAID,gid:l.cordovaGID,os:device.platform,osv:device.version,av:l.cordovaAppVersion,an:l.cordovaAppName,app:l.cordovaAppName}):"iOS"==device.platform?(l.cordovaIFV=su(device.uuid).substring(0,16),{pl:"HTML 5 Video",plv:"HTML 5",v:t,sx:screen.width,sy:screen.height,ifv:l.cordovaIFV,os:device.platform,osv:device.version,av:l.cordovaAppVersion,an:l.cordovaAppName,app:l.cordovaAppName}):{pl:"HTML 5 Video",plv:"HTML 5",v:t,sx:screen.width,sy:screen.height,os:device.platform,osv:device.version,an:l.cordovaAppName,av:l.cordovaAppVersion}},getPosition:function(e){return e.currentTime},getDuration:function(e){return Math.round(e.duration)}}}function su(e){var t,i,n,a,r,s,o,l,u,c,d,h=function(e,t){return e<<t|e>>>32-t},g=function(e,t){var i,n,a,r,s;return a=2147483648&e,r=2147483648&t,s=(1073741823&e)+(1073741823&t),(i=1073741824&e)&(n=1073741824&t)?2147483648^s^a^r:i|n?1073741824&s?3221225472^s^a^r:1073741824^s^a^r:s^a^r},p=function(e,t,i,n,a,r,s){return e=g(e,g(g(function(e,t,i){return e&t|~e&i}(t,i,n),a),s)),g(h(e,r),t)},v=function(e,t,i,n,a,r,s){return e=g(e,g(g(function(e,t,i){return e&i|t&~i}(t,i,n),a),s)),g(h(e,r),t)},f=function(e,t,i,n,a,r,s){return e=g(e,g(g(function(e,t,i){return e^t^i}(t,i,n),a),s)),g(h(e,r),t)},m=function(e,t,i,n,a,r,s){return e=g(e,g(g(function(e,t,i){return t^(e|~i)}(t,i,n),a),s)),g(h(e,r),t)},y=function(e){var t,i="",n="";for(t=0;t<=3;t++)i+=(n="0"+(e>>>8*t&255).toString(16)).substr(n.length-2,2);return i};for(l=1732584193,u=4023233417,c=2562383102,d=271733878,t=(i=function(e){for(var t,i=e.length,n=i+8,a=16*((n-n%64)/64+1),r=new Array(a-1),s=0,o=0;o<i;)s=o%4*8,r[t=(o-o%4)/4]=r[t]|e.charCodeAt(o)<<s,o++;return s=o%4*8,r[t=(o-o%4)/4]=r[t]|128<<s,r[a-2]=i<<3,r[a-1]=i>>>29,r}(e=function(e){var t,i,n,a="";t=i=0,n=(e=(e+"").replace(/\r\n/g,"\n").replace(/\r/g,"\n")).length;for(var r=0;r<n;r++){var s=e.charCodeAt(r),o=null;s<128?i++:o=s>127&&s<2048?String.fromCharCode(s>>6|192)+String.fromCharCode(63&s|128):String.fromCharCode(s>>12|224)+String.fromCharCode(s>>6&63|128)+String.fromCharCode(63&s|128),null!=o&&(i>t&&(a+=e.substring(t,i)),a+=o,t=i=r+1)}return i>t&&(a+=e.substring(t,e.length)),a}(e))).length,n=0;n<t;n+=16)a=l,r=u,s=c,o=d,l=p(l,u,c,d,i[n+0],7,3614090360),d=p(d,l,u,c,i[n+1],12,3905402710),c=p(c,d,l,u,i[n+2],17,606105819),u=p(u,c,d,l,i[n+3],22,3250441966),l=p(l,u,c,d,i[n+4],7,4118548399),d=p(d,l,u,c,i[n+5],12,1200080426),c=p(c,d,l,u,i[n+6],17,2821735955),u=p(u,c,d,l,i[n+7],22,4249261313),l=p(l,u,c,d,i[n+8],7,1770035416),d=p(d,l,u,c,i[n+9],12,2336552879),c=p(c,d,l,u,i[n+10],17,4294925233),u=p(u,c,d,l,i[n+11],22,2304563134),l=p(l,u,c,d,i[n+12],7,1804603682),d=p(d,l,u,c,i[n+13],12,4254626195),c=p(c,d,l,u,i[n+14],17,2792965006),l=v(l,u=p(u,c,d,l,i[n+15],22,1236535329),c,d,i[n+1],5,4129170786),d=v(d,l,u,c,i[n+6],9,3225465664),c=v(c,d,l,u,i[n+11],14,643717713),u=v(u,c,d,l,i[n+0],20,3921069994),l=v(l,u,c,d,i[n+5],5,3593408605),d=v(d,l,u,c,i[n+10],9,38016083),c=v(c,d,l,u,i[n+15],14,3634488961),u=v(u,c,d,l,i[n+4],20,3889429448),l=v(l,u,c,d,i[n+9],5,568446438),d=v(d,l,u,c,i[n+14],9,3275163606),c=v(c,d,l,u,i[n+3],14,4107603335),u=v(u,c,d,l,i[n+8],20,1163531501),l=v(l,u,c,d,i[n+13],5,2850285829),d=v(d,l,u,c,i[n+2],9,4243563512),c=v(c,d,l,u,i[n+7],14,1735328473),l=f(l,u=v(u,c,d,l,i[n+12],20,2368359562),c,d,i[n+5],4,4294588738),d=f(d,l,u,c,i[n+8],11,2272392833),c=f(c,d,l,u,i[n+11],16,1839030562),u=f(u,c,d,l,i[n+14],23,4259657740),l=f(l,u,c,d,i[n+1],4,2763975236),d=f(d,l,u,c,i[n+4],11,1272893353),c=f(c,d,l,u,i[n+7],16,4139469664),u=f(u,c,d,l,i[n+10],23,3200236656),l=f(l,u,c,d,i[n+13],4,681279174),d=f(d,l,u,c,i[n+0],11,3936430074),c=f(c,d,l,u,i[n+3],16,3572445317),u=f(u,c,d,l,i[n+6],23,76029189),l=f(l,u,c,d,i[n+9],4,3654602809),d=f(d,l,u,c,i[n+12],11,3873151461),c=f(c,d,l,u,i[n+15],16,530742520),l=m(l,u=f(u,c,d,l,i[n+2],23,3299628645),c,d,i[n+0],6,4096336452),d=m(d,l,u,c,i[n+7],10,1126891415),c=m(c,d,l,u,i[n+14],15,2878612391),u=m(u,c,d,l,i[n+5],21,4237533241),l=m(l,u,c,d,i[n+12],6,1700485571),d=m(d,l,u,c,i[n+3],10,2399980690),c=m(c,d,l,u,i[n+10],15,4293915773),u=m(u,c,d,l,i[n+1],21,2240044497),l=m(l,u,c,d,i[n+8],6,1873313359),d=m(d,l,u,c,i[n+15],10,4264355552),c=m(c,d,l,u,i[n+6],15,2734768916),u=m(u,c,d,l,i[n+13],21,1309151649),l=m(l,u,c,d,i[n+4],6,4149444226),d=m(d,l,u,c,i[n+11],10,3174756917),c=m(c,d,l,u,i[n+2],15,718787259),u=m(u,c,d,l,i[n+9],21,3951481745),l=g(l,a),u=g(u,r),c=g(c,s),d=g(d,o);return(y(l)+y(u)+y(c)+y(d)).toLowerCase()}ru.prototype.setPageContext=function(e){this.pageContext=e};var ou=a(Object.freeze({__proto__:null,default:ru}));Object.defineProperty(Lt,"__esModule",{value:!0});var lu=l,uu=au,cu=e,du=C,hu=i;function gu(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var pu=gu(ou);class vu extends hu.ReactiveElement{constructor(){super(...arguments),this.player=void 0,this.playerTracker=void 0,this.trackingSession=void 0,this.sourceId=void 0,this.currentSession=void 0,this.autoplay=void 0,this.epgState=void 0,this.gaTrackingId="",this.gaAppId="",this._logger=du.getLogger("TrackingElement"),this._unshadowProperties=void 0}static get reactiveAttributes(){return n({},super.reactiveAttributes,{gaTrackingId:String,gaAppId:String})}static get reactiveProperties(){return n({},super.reactiveProperties,{autoplay:Boolean,epgState:hu.ReactiveState})}readyCallback(){super.readyCallback();var e=this.gaAppId,t=this.gaTrackingId;if(!t)throw new Error("Missing attribute 'gatrackingid' which is required for tracking");this.sourceId=this.getAttribute("source-id")||void 0;var i=cu.getElementOfType(this);this.player=i,this.playerTracker=new uu.PlayerTracker({name:this.player.playerName,version:this.player.playerVersionNumber},{gaTrackingId:t,gaAppId:e,scoresLibrary:pu.default}),i.addEventListener(lu.PlayerEvents.SessionCreated,this),i.addEventListener(lu.PlayerEvents.PlayNextEpisode,this),i.activeSession&&this.createTrackingSession(i.activeSession),this._unshadowProperties=this.player.shadowProperties(["autoplay","epgState"],this)}disconnectedCallback(){var e,t,i,n;null==(e=this.player)||e.removeEventListener(lu.PlayerEvents.SessionCreated,this),null==(t=this.player)||t.removeEventListener(lu.PlayerEvents.PlayNextEpisode,this),null==(i=this.playerTracker)||i.destroy(),this.playerTracker=void 0,this.player=void 0,this.currentSession=void 0,this.trackingSession=void 0,null==(n=this._unshadowProperties)||n.call(this),super.disconnectedCallback()}updating(e,t){var i;if(super.updating(e,t),"epgState.entries"===e&&null!=(i=this.epgState)&&i.entries.length&&this.player){var n=this.epgState.getEPGTracker();n&&n.on("programchange",(e=>{var t;null==(t=this.trackingSession)||t.setLiveProgramId(null==e?void 0:e.programId),this.dispatchEvent(new CustomEvent(lu.PlayerEvents.EPGChange,{bubbles:!0,detail:e}))}))}}updated(e){var t,i;e.has("autoplay")&&(null==(t=this.trackingSession)||null==(i=t.gaSender)||i.updateFields({autoplay:this.autoplay}))}handleEvent(e){if(lu.isPlayerEvent(e,lu.PlayerEvents.SessionCreated)){var t=e.detail;this.createTrackingSession(t)}else if(e.type===lu.PlayerEvents.PlayNextEpisode){var i;if(this.playerTracker&&this.playerTracker.progressTracker)this.playerTracker.progressTracker.finalizeProgressReporting(null==(i=this.currentSession)?void 0:i.getMediaRange().end)}}createTrackingSession(e){if(this.player&&this.playerTracker)if(this.currentSession!==e){var{metadata:t,manifest:i}=this.player;if(t&&i&&"playable"in i){var a,r;this.currentSession=e;var s,o={metadata:{mediaId:null!=(a=t.id)?a:"unknown",mediaTitle:null!=(r=t.heading)?r:"unknown",cdnName:i.statistics.luna.data.cdnName},ga:{accumulatedTimeEvents:[120],fields:{sourceId:this.sourceId,autoplay:this.autoplay,fields:n({eventLabel:t.heading},i.statistics.ga)}},ecommerce:{trackingCallback:this.trackEcommerceEvent.bind(this)},scores:{config:i.statistics.scores},akamai:{config:i.statistics.luna}};if(t.id)o.progress={trackingCallback:this.trackProgress.bind(this),programId:t.id,playbackStartTime:null!=(s=this.player.startTime)?s:0};this.trackingSession=this.playerTracker.trackSession(e,o)}}else this._logger.warn("Avoid tracking same PlaybackSession more than once")}trackEcommerceEvent(e){this.dispatchEvent(new CustomEvent(e,{bubbles:!0,detail:e}))}trackProgress(e){this.dispatchEvent(new CustomEvent(lu.PlayerEvents.TrackProgress,{bubbles:!0,detail:e}))}}var fu=Lt.TrackingElement=vu;function mu(e){for(var t=[],i=0;i<e.length;++i)t.push({start:e.start(i),end:e.end(i)});return t}function yu(e,t){return t<e.start?e.start:t>e.end?e.end:t}var bu=I("CoreEvent");class Tu{constructor(){this.emitter=new S}on(e,t,i){this.emitter.on(e,t,i)}once(e,t,i){this.emitter.once(e,t,i)}off(e,t,i){this.emitter.off(e,t,i)}emit(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];this.emitter.emit(e,...i)}reset(){this.emitter.removeAllListeners()}}class ku extends Tu{constructor(e){super(),this.emitters=void 0,this.emitters=e}emit(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),n=1;n<t;n++)i[n-1]=arguments[n];e===v.MediaRangeChange||e===v.SubtitlesCueUpdate?bu.debug("Emitting event:",e,...i):e!==v.TimeUpdate&&e!==v.ScrubberUpdate&&bu.log("Emitting event:",e,...i),super.emit(e,...i),this.emitters.forEach((t=>{t.emit(e,...i)}))}reset(){super.reset(),this.emitters.forEach((e=>e instanceof Tu&&e.reset()))}}class Su{constructor(e){this.element=void 0,this.element=e}emit(e){var t=new CustomEvent(e,{bubbles:!0,detail:arguments.length<=1?void 0:arguments[1]});this.element.dispatchEvent(t)}}var Eu=I("AdapterSnapshot");class Pu{constructor(e){this.values=void 0,this.values=e}static from(e){return new Pu({adapterInfo:e.getAdapterInfo(),mediaInfo:e.getMediaInfo(),state:e.getState(),waitingReason:e.getWaitingReason(),pausedReason:e.getPausedReason(),error:e.getError(),liveStream:e.isLiveStream(),liveStreamEnded:e.isLiveStreamEnded(),seekable:e.isSeekable(),currentTime:e.getCurrentTime(),scrubberValues:e.getScrubberValues(),playbackRate:e.getPlaybackRate(),muted:e.isMuted(),volume:e.getVolume(),mediaRange:e.getMediaRange(),scrubberRange:e.getScrubberRange(),seekableRange:e.getSeekableRange(),rawSeekableRange:e.getRawSeekableRange(),rawDuration:e.getRawDuration(),bufferedRanges:e.getBufferedRanges(),playedRanges:e.getPlayedRanges()})}getAdapterInfo(){return Eu.log("Getting adapter info from adapter snapshot."),this.values.adapterInfo}getMediaInfo(){return Eu.log("Getting media info from adapter snapshot."),this.values.mediaInfo}preload(){return Eu.log("Calling preload on adapter snapshot (no-op)."),Promise.resolve()}createTimeRangeEventTrack(){throw new Error("Can't create time range event track on adapter snapshot.")}play(){return Eu.log("Calling play on adapter snapshot (no-op)."),Promise.resolve()}pause(){Eu.log("Calling pause on adapter snapshot (no-op).")}getState(){return Eu.log("Getting state from adapter snapshot."),this.values.state}getWaitingReason(){return Eu.log("Getting waiting state from adapter snapshot."),this.values.waitingReason}getPausedReason(){return Eu.log("Getting paused state from adapter snapshot."),this.values.pausedReason}getError(){return Eu.log("Getting error from adapter snapshot."),this.values.error}isLiveStream(){return Eu.log("Getting live stream from adapter snapshot."),this.values.liveStream}isLiveStreamEnded(){return Eu.log("Getting live stream ended from adapter snapshot."),this.values.liveStreamEnded}isSeekable(){return Eu.log("Getting seekable from adapter snapshot."),this.values.seekable}seekTo(){Eu.log("Seeking on adapter snapshot (no-op).")}seekToRelativeTime(){Eu.log("Seeking on adapter snapshot (no-op).")}getCurrentTime(){return Eu.log("Getting current time from adapter snapshot."),this.values.currentTime}getScrubberValues(){return Eu.log("Getting scrubber values from adapter snapshot."),this.values.scrubberValues}setPlaybackRate(){Eu.log("Setting playback rate on adapter snapshot (no-op).")}getPlaybackRate(){return Eu.log("Getting playback rate from adapter snapshot."),this.values.playbackRate}resetPlaybackRate(){Eu.log("Resetting playback rate on adapter snapshot (no-op).")}mute(){Eu.log("Muting on adapter snapshot (no-op).")}unmute(){Eu.log("Unmuting on adapter snapshot (no-op).")}isMuted(){return Eu.log("Getting muted from adapter snapshot."),this.values.muted}setVolume(){Eu.log("Setting volume on adapter snapshot (no-op).")}getVolume(){return Eu.log("Getting volume from adapter snapshot."),this.values.volume}getMediaRange(){return Eu.log("Getting media range from adapter snapshot."),this.values.mediaRange}getScrubberRange(){return Eu.log("Getting scrubber range from adapter snapshot."),this.values.scrubberRange}getSeekableRange(){return Eu.log("Getting seekable range from adapter snapshot."),this.values.seekableRange}getRawSeekableRange(){return Eu.log("Getting raw seekable range from adapter snapshot."),this.values.rawSeekableRange}getRawDuration(){return Eu.log("Getting raw duration from adapter snapshot."),this.values.rawDuration}getBufferedRanges(){return Eu.log("Getting buffered ranges from adapter snapshot."),this.values.bufferedRanges}getPlayedRanges(){return Eu.log("Getting played ranges from adapter snapshot."),this.values.playedRanges}addSubtitlesTrack(){throw new Error("Can't add subtitles to the adapter snapshot.")}setNoSubtitles(){Eu.log("Setting no subtitles on adapter snapshot (no-op).")}setDefaultSubtitles(){Eu.log("Setting default subtitles on adapter snapshot (no-op).")}setAutoSubtitles(){Eu.log("Setting auto subtitles on adapter snapshot (no-op).")}setActiveSubtitles(){Eu.log("Setting active subtitles on adapter snapshot (no-op).")}getActiveSubtitles(){Eu.log("Getting active subtitles from adapter snapshot.")}getAvailableSubtitles(){return Eu.log("Getting available subtitles menu from adapter snapshot."),[]}enableNativeSubtitlesDisplay(){Eu.log("Enabling native subtitles display on adapter snapshot (no-op).")}disableNativeSubtitlesDisplay(){Eu.log("Disabling native subtitles display on adapter snapshot (no-op).")}isNativeSubtitlesDisplayEnabled(){return Eu.log("Getting subtitles display enabled from adapter snapshot."),!1}destroy(){return Promise.resolve()}}var Cu=I("Live");class Iu{constructor(e,t,i){this.adapter=void 0,this.options=void 0,this.streamInfo=void 0,this.clientDateTimeAtSlideStart=void 0,this.livePositionAtSlideStart=void 0,this.programDateTimeAtPosZero=void 0,this.liveStreamEnded=void 0,this.slidingWindowDuration=void 0,this.minimumScrubberRange={start:0,end:0},this.adapter=e,this.options=i,this.streamInfo=e.getMediaInfo().segmentListInfo,this.programDateTimeAtPosZero=this.resolveProgramDateTimeAtPosZero(),this.liveStreamEnded=e.isLiveStreamEnded(),t.on(v.LiveStreamEnded,(()=>{this.liveStreamEnded=!0})),t.once(v.MediaRangeChange,(()=>{this.programDateTimeAtPosZero=this.resolveProgramDateTimeAtPosZero(),e.isSeekable()?this.slidingWindowDuration=null==i?void 0:i.slidingWindowDuration:(Cu.log("Seeking not supported by client. Setting scrubber duration to 0."),this.slidingWindowDuration=0),t.on(v.MediaRangeChange,this.handleMediaRangeChange.bind(this)),this.liveStreamEnded||this.startSliding()}))}handleMediaRangeChange(e){if(void 0===this.slidingWindowDuration&&e.start>1&&(this.slidingWindowDuration=Ru(e.end-e.start),Cu.log("Detected sliding window. Scrubber duration set to: "+this.slidingWindowDuration)),void 0!==this.livePositionAtSlideStart&&!this.liveStreamEnded){var t=e.end-3*this.streamInfo.averageSegmentDuration-this.getCurrentLivePosition();t>0&&(Cu.log("Adjusting live position to be "+t+" seconds closer to real-time."),this.livePositionAtSlideStart+=t)}if(void 0!==this.slidingWindowDuration&&this.adapter.getState()===D.Playing&&this.adapter.getWaitingReason()!==y.Starting&&this.adapter.getWaitingReason()!==y.Seeking){var i=this.getSeekableRange().start,n=this.adapter.getCurrentTime(),a=this.streamInfo.averageSegmentDuration;if(this.adapter.getPlaybackRate()<1&&n<i+a/2&&(Cu.log("Uping playback rate to 1 at the edge of seekable range."),this.adapter.setPlaybackRate(1)),this.adapter.getPlaybackRate()>1){var r=this.getCurrentLivePosition();void 0!==r&&n>r&&(Cu.log("Lowering playback rate to 1 as playhead has entered segment loading range."),this.adapter.setPlaybackRate(1))}n<i-2*a&&(Cu.log("Playhead is way outside seekable range. Pulling it in."),this.seekTo(i+a))}}startSliding(){Cu.log("Live sliding start."),this.clientDateTimeAtSlideStart=Date.now()/1e3,this.livePositionAtSlideStart=this.adapter.isSeekable()?this.adapter.getMediaRange().end-3*this.streamInfo.averageSegmentDuration:this.adapter.getCurrentTime()}resolveProgramDateTimeAtPosZero(){var e,t;if(this.streamInfo.programDateTimeAtPosZero){var i,n,a=null!=(i=null==(n=this.options)?void 0:n.programDateTimeCorrection)?i:0;return this.streamInfo.programDateTimeAtPosZero+a}var r=this.adapter.getMediaRange(),s=null!=(e=null==(t=this.options)?void 0:t.liveDelay)?e:wu(this.streamInfo.averageSegmentDuration);return Date.now()/1e3-s-(r.end||this.streamInfo.segmentListDuration||0)}getCurrentLivePosition(){if(void 0!==this.clientDateTimeAtSlideStart&&void 0!==this.livePositionAtSlideStart){var e=Date.now()/1e3-this.clientDateTimeAtSlideStart;return this.livePositionAtSlideStart+e}}getLiveScrubberRangeEnd(){var e=this.getCurrentLivePosition();if(void 0===e)return this.adapter.getCurrentTime();var t=Math.max(e,this.adapter.getCurrentTime(),this.minimumScrubberRange.end);return this.minimumScrubberRange.end=t,t}play(){if(this.adapter.getState()===D.Paused){var e=this.getSeekableRange().start;this.adapter.getCurrentTime()<e&&(Cu.log("Playhead is outside seekable range. Seeking before calling play."),this.adapter.seekTo(e))}return this.adapter.play()}getScrubberRange(){if(this.liveStreamEnded)return this.adapter.getSeekableRange();var e,t=this.getLiveScrubberRangeEnd();return void 0!==this.slidingWindowDuration?(e=Math.max(t-this.slidingWindowDuration,this.minimumScrubberRange.start),this.minimumScrubberRange.start=e):e=0,{start:e,end:t}}getScrubberValues(){var e=this.adapter.getCurrentTime(),t=this.getScrubberRange(),i=Math.max(e,t.start),n=this.positionToLiveTime(t.start),a=this.positionToLiveTime(t.end),r=this.positionToLiveTime(i),s=(n.getTime()/1e3-60*n.getTimezoneOffset())%86400,o=(a.getTime()/1e3-60*a.getTimezoneOffset())%86400,l=(r.getTime()/1e3-60*r.getTimezoneOffset())%86400;return{startPosition:t.start,startLiveTime:n,startDisplayTime:s,endPosition:t.end,endLiveTime:a,endDisplayTime:o,playheadPosition:i,playheadLiveTime:r,playheadDisplayTime:l}}getSeekableRange(){var e=this.adapter.getMediaRange(),t=this.getScrubberRange(),i=Math.max(e.start,t.start),n=Math.min(e.end,t.end);return i>n?t:{start:i,end:n}}isSeekable(){return 0!==this.slidingWindowDuration}seekTo(e){var t=yu(this.getSeekableRange(),e);this.adapter.seekTo(t)}seekToRelativeTime(e){this.seekTo(this.adapter.getCurrentTime()+e)}seekToLive(){this.liveStreamEnded||this.adapter.seekTo(this.getSeekableRange().end)}seekToLiveTime(e){this.seekTo(this.liveTimeToPosition(e))}getCurrentTimeLive(){return this.positionToLiveTime(this.adapter.getCurrentTime())}positionToLiveTime(e){return new Date(1e3*(this.programDateTimeAtPosZero+e))}liveTimeToPosition(e){return e.getTime()/1e3-this.programDateTimeAtPosZero}}var wu=e=>e+9,Ru=e=>{var t=Math.floor(e/60),i=e%60,n=5*Math.floor(t/5);return t-n==4&&i>=30?60*(n+5):60*t},Au=I("LiveSnapshot");class xu{constructor(e){this.values=void 0,this.values=e}static from(e,t){return new xu({seekable:e.isSeekable(),currentTimeLive:e.getCurrentTimeLive(),scrubberValues:e.getScrubberValues(),scrubberRange:e.getScrubberRange(),seekableRange:e.getSeekableRange(),programDateTimeAtPosZero:t.getMediaInfo().segmentListInfo.programDateTimeAtPosZero})}play(){return Au.log("Calling play on live controls snapshot (no-op)."),Promise.resolve()}isSeekable(){return Au.log("Getting seekable from live controls snapshot."),this.values.seekable}seekTo(){Au.log("Seeking on live controls snapshot (no-op).")}seekToRelativeTime(){Au.log("Seeking on live controls snapshot (no-op).")}seekToLive(){Au.log("Seeking on live controls snapshot (no-op).")}seekToLiveTime(){Au.log("Seeking on live controls snapshot (no-op).")}getCurrentTimeLive(){return Au.log("Getting current live time from live controls snapshot."),this.values.currentTimeLive}getScrubberValues(){return Au.log("Getting scrubber values from live controls snapshot."),this.values.scrubberValues}getScrubberRange(){return Au.log("Getting scrubber range from live controls snapshot."),this.values.scrubberRange}getSeekableRange(){return Au.log("Getting seekable range from live controls snapshot."),this.values.seekableRange}positionToLiveTime(e){return new Date(1e3*(this.values.programDateTimeAtPosZero+e))}liveTimeToPosition(e){return e.getTime()/1e3-this.values.programDateTimeAtPosZero}}class Du{constructor(e,t,i,n,a,r){var s=this;this.__adapter=void 0,this.__eventEmitter=void 0,this.__qualityTracker=void 0,this.__displayModes=void 0,this.__livePlaybackControls=void 0,this.on=void 0,this.off=void 0,this.once=void 0,this.getAdapterInfo=void 0,this.getMediaInfo=void 0,this.preload=void 0,this.createTimeRangeEventTrack=void 0,this.play=void 0,this.pause=void 0,this.getState=void 0,this.getWaitingReason=void 0,this.getPausedReason=void 0,this.getError=void 0,this.isLiveStream=void 0,this.isLiveStreamEnded=void 0,this.isSeekable=void 0,this.seekTo=void 0,this.seekToRelativeTime=void 0,this.getCurrentTime=void 0,this.getScrubberValues=void 0,this.setPlaybackRate=void 0,this.getPlaybackRate=void 0,this.resetPlaybackRate=void 0,this.mute=void 0,this.unmute=void 0,this.isMuted=void 0,this.setVolume=void 0,this.getVolume=void 0,this.getMediaRange=void 0,this.getScrubberRange=void 0,this.getSeekableRange=void 0,this.getRawSeekableRange=void 0,this.getRawDuration=void 0,this.getBufferedRanges=void 0,this.getPlayedRanges=void 0,this.seekToLive=void 0,this.seekToLiveTime=void 0,this.getCurrentTimeLive=void 0,this.positionToLiveTime=void 0,this.liveTimeToPosition=void 0,this.addSubtitlesTrack=void 0,this.setNoSubtitles=void 0,this.setDefaultSubtitles=void 0,this.setAutoSubtitles=void 0,this.setActiveSubtitles=void 0,this.getActiveSubtitles=void 0,this.getAvailableSubtitles=void 0,this.enableNativeSubtitlesDisplay=void 0,this.disableNativeSubtitlesDisplay=void 0,this.isNativeSubtitlesDisplayEnabled=void 0,this.getFullscreenState=void 0,this.enterFullscreen=void 0,this.exitFullscreen=void 0,this.getPiPState=void 0,this.enterPiP=void 0,this.exitPiP=void 0,this.getRemotePlaybackState=void 0,this.startRemoteTargetScan=void 0,this.stopRemoteTargetScan=void 0,this.enterRemotePlayback=void 0,this.__adapter=e,this.__eventEmitter=t,this.__qualityTracker=n,this.__displayModes=a;["on","off","once"].forEach((e=>{Object.defineProperty(this,e,{value:i[e].bind(i)})})),["getAdapterInfo","getMediaInfo","preload","createTimeRangeEventTrack","pause","getState","getWaitingReason","getPausedReason","getError","isLiveStream","isLiveStreamEnded","getCurrentTime","setPlaybackRate","getPlaybackRate","resetPlaybackRate","mute","unmute","isMuted","setVolume","getVolume","getMediaRange","getRawSeekableRange","getRawDuration","getBufferedRanges","getPlayedRanges","addSubtitlesTrack","setNoSubtitles","setDefaultSubtitles","setAutoSubtitles","setActiveSubtitles","getActiveSubtitles","getAvailableSubtitles","enableNativeSubtitlesDisplay","disableNativeSubtitlesDisplay","isNativeSubtitlesDisplayEnabled"].forEach((e=>{Object.defineProperty(this,e,{value:function(){return s.__adapter[e](...arguments)}})})),["play","isSeekable","seekTo","seekToRelativeTime","seekToLive","seekToLiveTime","getCurrentTimeLive","positionToLiveTime","liveTimeToPosition","getScrubberValues","getScrubberRange","getSeekableRange"].forEach((e=>{Object.defineProperty(this,e,{value:function(){return s.__livePlaybackControls?s.__livePlaybackControls[e](...arguments):e in s.__adapter?s.__adapter[e](...arguments):void 0}})})),["getFullscreenState","enterFullscreen","exitFullscreen","getPiPState","enterPiP","exitPiP","getRemotePlaybackState","startRemoteTargetScan","stopRemoteTargetScan","enterRemotePlayback"].forEach((e=>{Object.defineProperty(this,e,{value:a[e].bind(a)})})),t.once(v.MediaInfoLoaded,(()=>{this.isLiveStream()&&(this.__livePlaybackControls=new Iu(e,t,r))})),t.on(v.PlayingChange,(e=>{if(e.type===f.Replay){var i=()=>n.dispatchQualityChangeEvent();t.once(v.TimeRunningChange,i),t.once(v.QualityChange,(()=>{t.off(v.TimeRunningChange,i)}))}})),t.emit(v.SessionCreated,this)}isIdle(){return this.getState()===D.Idle}isPlaying(){return this.getState()===D.Playing}isWaiting(){return null!=this.getWaitingReason()}isTimeRunning(){return this.isPlaying()&&!this.isWaiting()}isBroken(){return this.getState()===D.Broken}getCurrentQuality(){return this.__qualityTracker.getCurrentQuality()}async close(){var e=this.__adapter;this.__adapter=Pu.from(e),this.__livePlaybackControls&&(this.__livePlaybackControls=xu.from(this.__livePlaybackControls,e)),await e.destroy(),this.__displayModes.destroy(),this.__eventEmitter.emit(v.SessionClosed,this),this.__eventEmitter.reset()}}var Lu,_u=I("Fullscreen");function Mu(){return[{type:"standard",changeEvent:"fullscreenchange",isEnabled:()=>document.fullscreenEnabled,requestFullscreen:e=>e.requestFullscreen(),exitFullscreen:()=>document.exitFullscreen(),getActiveElement:()=>document.fullscreenElement||void 0},{type:"webkit",changeEvent:"webkitfullscreenchange",isEnabled:()=>document.webkitFullscreenEnabled,requestFullscreen:e=>e.webkitRequestFullscreen(),exitFullscreen:()=>document.webkitExitFullscreen(),getActiveElement:()=>document.webkitFullscreenElement},{type:"moz",changeEvent:"mozfullscreenchange",isEnabled:()=>document.mozFullScreenEnabled,requestFullscreen:e=>e.mozRequestFullScreen(),exitFullscreen:()=>document.mozCancelFullScreen(),getActiveElement:()=>document.mozFullScreenElement},{type:"ms",changeEvent:"MSFullscreenChange",isEnabled:()=>document.msFullscreenEnabled,requestFullscreen:e=>e.msRequestFullscreen(),exitFullscreen:()=>document.msExitFullscreen(),getActiveElement:()=>document.msFullscreenElement}].find((e=>e.isEnabled()))}class Nu{constructor(e,t){var i;this.destroyController=void 0,this.element=void 0,this.stateChangedCallback=void 0,this.integration=void 0,this.supportsOrientationLock=void 0,this.isActive=!1;var n=Mu();if(!n)throw new Error("Fullscreen not supported!");_u.log("HTML5 fullscreen integration: "+n.type+"."),this.element=e,this.stateChangedCallback=t,this.integration=n,this.supportsOrientationLock="string"==typeof(null==(i=window.screen.orientation)?void 0:i.type),this.destroyController=Il(Rl(document,n.changeEvent,this.checkIfActive.bind(this))),this.checkIfActive()}static isSupported(){return void 0!==Mu()}getFullscreenState(){return{isSupported:!0,isAvailable:!0,isActive:this.isActive,isNativeUI:!1}}enterFullscreen(e){Promise.resolve(this.integration.requestFullscreen(this.element)).then((()=>this.attemptOrientationLock(null==e?void 0:e.orientation))).catch((e=>{_u.warn("Fullscreen request rejected:",e)}))}exitFullscreen(){Promise.resolve(this.integration.exitFullscreen()).catch((e=>{_u.warn("Failed to exit fullscreen:",e)}))}destroy(){this.destroyController.abort()}checkIfActive(){var e=this.integration.getActiveElement()===this.element;e!==this.isActive&&(this.isActive=e,this.stateChangedCallback("isActive"))}async attemptOrientationLock(e){if(this.supportsOrientationLock&&e)return _u.log("Attempting to lock screen orientation to '"+e+"'."),window.screen.orientation.lock(e).catch((e=>{var t=L(e);"NotSupportedError"===t.name?(_u.log("Screen orientation lock is not actually available."),this.supportsOrientationLock=!1):_u.log("Orientation error: "+t.name.replace("Error","")+". "+t.message)}))}}!function(e){e.Inline="inline",e.Fullscreen="fullscreen",e.PiP="picture-in-picture"}(Lu||(Lu={}));class Ou{constructor(e,t){this.destroyController=void 0,this.video=void 0,this.stateChangedCallback=void 0,this.isAvailable=!1,this.isActive=!1,this.video=e,this.stateChangedCallback=t;var i=this.checkIfActive.bind(this),n=this.checkIfAvailable.bind(this);this.destroyController=Il([Rl(e,"webkitfullscreenchange",i),Rl(e,"webkitbeginfullscreen",i),Rl(e,"webkitendfullscreen",i),Rl(e,"resize",i),Rl(e,"loadedmetadata",n),Rl(e,"emptied",n)]),this.checkIfActive()}static isSupported(e){return"function"==typeof e.webkitEnterFullscreen||"function"==typeof e.webkitEnterFullScreen}getFullscreenState(){return{isSupported:!0,isAvailable:this.isAvailable,isActive:this.isActive,isNativeUI:!0}}enterFullscreen(){var e,t;this.video.webkitEnterFullscreen?this.video.webkitEnterFullscreen():null==(e=(t=this.video).webkitEnterFullScreen)||e.call(t)}exitFullscreen(){var e,t;this.video.webkitExitFullscreen?this.video.webkitExitFullscreen():null==(e=(t=this.video).webkitExitFullScreen)||e.call(t)}destroy(){this.destroyController.abort()}checkIfAvailable(){var e=!(!this.video.webkitSupportsFullscreen||this.video.webkitPresentationMode&&this.video.webkitPresentationMode!==Lu.Inline&&this.video.webkitPresentationMode!==Lu.Fullscreen);this.isAvailable!==e&&(this.isAvailable=e,this.stateChangedCallback("isAvailable"))}checkIfActive(){var e=this.video.webkitPresentationMode?this.video.webkitPresentationMode===Lu.Fullscreen&&!this.video.webkitDisplayingFullscreen:!!this.video.webkitDisplayingFullscreen;this.isActive!==e&&(this.isActive=e,this.stateChangedCallback("isActive")),this.checkIfAvailable()}}var Uu=I("PiP");class Bu{constructor(e,t){this.destroyController=void 0,this.video=void 0,this.stateChangedCallback=void 0,this.isAvailable=!1,this.video=e,this.stateChangedCallback=t,this.destroyController=Il([Rl(e,"enterpictureinpicture",t.bind(t,"isActive")),Rl(e,"leavepictureinpicture",t.bind(t,"isActive")),Rl(e,"loadedmetadata",this.checkIfAvailable.bind(this)),Rl(e,"emptied",this.checkIfAvailable.bind(this))]),this.checkIfAvailable()}static isSupported(){return"pictureInPictureEnabled"in document}getPiPState(){return{isSupported:!0,isAvailable:this.isAvailable,isActive:this.isActive()}}enterPiP(){var e,t;Promise.resolve(null==(e=(t=this.video).requestPictureInPicture)?void 0:e.call(t)).catch((e=>{Uu.warn("PiP request rejected:",e)}))}exitPiP(){Promise.resolve(null==document.exitPictureInPicture?void 0:document.exitPictureInPicture()).catch((e=>{Uu.warn("Failed to exit PiP:",e)}))}destroy(){this.destroyController.abort()}isActive(){return document.pictureInPictureElement===this.video}checkIfAvailable(){var e=!!document.pictureInPictureEnabled&&!this.video.disablePictureInPicture&&0!==this.video.readyState;this.isAvailable!==e&&(this.isAvailable=e,this.stateChangedCallback("isAvailable"))}}class Fu{constructor(e,t){this.destroyController=void 0,this.video=void 0,this.stateChangedCallback=void 0,this.isAvailable=!1,this.isActive=!1,this.video=e,this.stateChangedCallback=t;var i=this.checkIfActive.bind(this),n=this.checkIfAvailable.bind(this);this.destroyController=Il([Rl(e,"webkitbeginfullscreen",i),Rl(e,"webkitendfullscreen",i),Rl(e,"resize",i),Rl(e,"loadedmetadata",n),Rl(e,"emptied",n)]),this.checkIfActive()}static isSupported(e){return"function"==typeof e.webkitSupportsPresentationMode&&!/iPhone|iPod/.exec(window.navigator.userAgent)}getPiPState(){return{isSupported:!0,isAvailable:this.isAvailable,isActive:this.isActive}}enterPiP(){var e,t;null==(e=(t=this.video).webkitSetPresentationMode)||e.call(t,Lu.PiP)}exitPiP(){var e,t;null==(e=(t=this.video).webkitSetPresentationMode)||e.call(t,Lu.Inline)}destroy(){this.destroyController.abort()}checkIfAvailable(){var e=this.video.webkitSupportsPresentationMode(Lu.PiP)&&(this.video.webkitPresentationMode===Lu.Inline||this.video.webkitPresentationMode===Lu.PiP);this.isAvailable!==e&&(this.isAvailable=e,this.stateChangedCallback("isAvailable"))}checkIfActive(){var e=this.video.webkitPresentationMode===Lu.PiP;this.isActive!==e&&(this.isActive=e,this.stateChangedCallback("isActive")),this.checkIfAvailable()}}var Vu=I("AirPlay");class Wu{static isSupported(){return!!window.WebKitPlaybackTargetAvailabilityEvent}constructor(e,t){this.destroyController=new AbortController,this.media=void 0,this.stateChangedCallback=void 0,this.abortScanner=void 0,this.hasMedia=!1,this.hasTargets=!1,this.isActive=!1,this.media=e,this.stateChangedCallback=t,Il([Rl(e,"webkitcurrentplaybacktargetiswirelesschanged",this.checkIfActive.bind(this)),Rl(e,"loadstart",this.checkIfHasMedia.bind(this)),Rl(e,"emptied",this.checkIfHasMedia.bind(this))],this.destroyController.signal),this.checkIfActive()}getRemotePlaybackState(){return{isSupported:!0,isAvailable:this.hasMedia&&this.hasTargets,isActive:this.isActive,isScanning:void 0!==this.abortScanner}}startRemoteTargetScan(e){void 0===this.abortScanner&&(this.abortScanner=new AbortController,wl(this.destroyController.signal,this.abortScanner),Il(Rl(this.media,"webkitplaybacktargetavailabilitychanged",(t=>{var i=t.availability;Vu.log("Scan result:",i);var n="available"===i;this.hasTargets!==n&&(this.hasTargets=n,this.hasMedia&&this.stateChangedCallback("isAvailable")),n&&null!=e&&e.stopWhenAvailable&&(Vu.log("Stopping scan because targets."),this.stopRemoteTargetScan())})),this.abortScanner.signal),this.stateChangedCallback("isScanning"),null!=e&&e.timeout&&(Vu.log("Scanning for max "+e.timeout+" ms."),Il(setTimeout(this.stopRemoteTargetScan.bind(this),e.timeout),this.abortScanner.signal)))}stopRemoteTargetScan(){void 0!==this.abortScanner&&(this.abortScanner.abort(),this.abortScanner=void 0,this.stateChangedCallback("isScanning"))}enterRemotePlayback(){var e,t;null==(e=(t=this.media).webkitShowPlaybackTargetPicker)||e.call(t)}destroy(){this.stopRemoteTargetScan(),this.destroyController.abort()}checkIfHasMedia(){var e=!this.isActive&&!this.media.webkitWirelessVideoPlaybackDisabled;this.hasMedia!==e&&(this.hasMedia=e,this.hasTargets&&this.stateChangedCallback("isAvailable"))}checkIfActive(){this.media.webkitCurrentPlaybackTargetIsWireless!==this.isActive&&(this.isActive=!this.isActive,this.stateChangedCallback("isActive")),this.checkIfHasMedia()}}var Hu=I("NativeRemotePlayback");class ju{constructor(e,t){if(this.destroyController=new AbortController,this.remote=void 0,this.stateChangedCallback=void 0,this.scannerId=void 0,this.clearScannerTimeout=void 0,this.isScanningSupported=!0,this.hasMedia=!1,this.hasTargets=!1,!e.remote)throw new Error("RemotePlayback not supported!");this.remote=e.remote,this.stateChangedCallback=t;var i=this.stateChangedCallback.bind(this,"isActive");Il([Rl(this.remote,"connect",i),Rl(this.remote,"connecting",i),Rl(this.remote,"disconnect",i),Rl(this.remote,"loadstart",(()=>{this.hasMedia=!0,this.hasTargets&&this.stateChangedCallback("isAvailable")})),Rl(this.remote,"emptied",(()=>{this.hasMedia=!1,this.hasTargets&&this.stateChangedCallback("isAvailable")}))],this.destroyController.signal)}static isSupported(e){return"remote"in e&&!e.disableRemotePlayback}getRemotePlaybackState(){return{isSupported:!0,isAvailable:this.hasMedia&&this.hasTargets,isActive:"connected"===this.remote.state||"connecting"===this.remote.state,isScanning:void 0!==this.scannerId}}startRemoteTargetScan(e){this.isScanningSupported&&void 0===this.scannerId&&(this.scannerId=Number.NaN,this.remote.watchAvailability((t=>{Hu.log("Scan result:",t?"available":"not available"),this.hasTargets!==t&&(this.hasTargets=t,this.hasMedia&&this.stateChangedCallback("isAvailable"),t&&null!=e&&e.stopWhenAvailable&&(Hu.log("Stopping scan because targets."),this.stopRemoteTargetScan()))})).then((t=>{void 0===this.scannerId?(Hu.log("Scanning cancelled before starting."),this.remote.cancelWatchAvailability(t).catch((e=>{Hu.warn("Failed to stop scanning:",e)}))):(this.scannerId=t,this.stateChangedCallback("isScanning"),null!=e&&e.timeout&&(Hu.log("Scanning for max "+e.timeout+" ms."),this.clearScannerTimeout=Il(setTimeout((()=>this.stopRemoteTargetScan()),e.timeout),this.destroyController.signal)))})).catch((()=>{Hu.log("Scanning is not supported."),this.isScanningSupported=!1,this.scannerId=void 0,this.hasTargets=!0,this.hasMedia&&this.stateChangedCallback("isAvailable")})))}stopRemoteTargetScan(){this.clearScannerTimeout&&(this.clearScannerTimeout.abort(),this.clearScannerTimeout=void 0),void 0!==this.scannerId&&(Number.isNaN(this.scannerId)||this.remote.cancelWatchAvailability(this.scannerId).catch((e=>{Hu.warn("Failed to stop scanning:",e)})),this.scannerId=void 0,this.stateChangedCallback("isScanning"))}enterRemotePlayback(){this.remote.prompt().catch((e=>{Hu.warn("Remote playback prompt rejected:",e)}))}destroy(){this.stopRemoteTargetScan(),this.destroyController.abort()}}var qu=I("DisplayModes");class Gu{constructor(e,t,i,n){this.eventEmitter=void 0,this.fullscreen=void 0,this.pip=void 0,this.remotePlayback=void 0,this.eventEmitter=e,Nu.isSupported()&&(this.fullscreen=new Nu(t,this.handleFullscreenStateChanged.bind(this)),qu.log("Fullscreen is supported.")),i instanceof HTMLVideoElement&&(!this.fullscreen&&Ou.isSupported(i)&&(this.fullscreen=new Ou(i,this.handleFullscreenStateChanged.bind(this)),qu.log("WebKit video fullscreen is supported")),Bu.isSupported()?(this.pip=new Bu(i,this.handlePiPStateChanged.bind(this)),qu.log("PiP is supported.")):Fu.isSupported(i)&&(this.pip=new Fu(i,this.handlePiPStateChanged.bind(this)),qu.log("WebKit PiP is supported."))),i&&(null!=n&&n.enableNativeRemotePlayback&&ju.isSupported(i)?(this.remotePlayback=new ju(i,this.handleRemotePlaybackStateChanged.bind(this)),qu.log("RemotePlayback is supported.")):Wu.isSupported()&&(this.remotePlayback=new Wu(i,this.handleRemotePlaybackStateChanged.bind(this)),qu.log("WebKit AirPlay is supported.")))}getFullscreenState(){var e,t;return null!=(e=null==(t=this.fullscreen)?void 0:t.getFullscreenState())?e:{isSupported:!1,isAvailable:!1,isActive:!1,isNativeUI:!1}}enterFullscreen(e){var t,i;null!=(t=this.pip)&&t.getPiPState().isActive&&this.pip.exitPiP(),null==(i=this.fullscreen)||i.enterFullscreen(e)}exitFullscreen(){var e;null==(e=this.fullscreen)||e.exitFullscreen()}getPiPState(){var e,t;return null!=(e=null==(t=this.pip)?void 0:t.getPiPState())?e:{isSupported:!1,isAvailable:!1,isActive:!1}}enterPiP(){var e,t;null!=(e=this.fullscreen)&&e.getFullscreenState().isActive&&this.fullscreen.exitFullscreen(),null==(t=this.pip)||t.enterPiP()}exitPiP(){var e;null==(e=this.pip)||e.exitPiP()}getRemotePlaybackState(){var e,t;return null!=(e=null==(t=this.remotePlayback)?void 0:t.getRemotePlaybackState())?e:{isSupported:!1,isAvailable:!1,isActive:!1,isScanning:!1}}startRemoteTargetScan(e){var t;null==(t=this.remotePlayback)||t.startRemoteTargetScan(e)}stopRemoteTargetScan(){var e;null==(e=this.remotePlayback)||e.stopRemoteTargetScan()}enterRemotePlayback(){var e;null==(e=this.remotePlayback)||e.enterRemotePlayback()}destroy(){var e,t,i;null==(e=this.fullscreen)||e.destroy(),this.fullscreen=void 0,null==(t=this.pip)||t.destroy(),this.pip=void 0,null==(i=this.remotePlayback)||i.destroy(),this.remotePlayback=void 0}handleFullscreenStateChanged(e){if(this.fullscreen){var t=this.fullscreen.getFullscreenState();qu.log("Fullscreen: "+e+" is "+t[e]+"."),this.eventEmitter.emit(v.FullscreenStateChange,{state:t,field:e})}}handlePiPStateChanged(e){if(this.pip){var t=this.pip.getPiPState();qu.log("PiP: "+e+" is "+t[e]+"."),this.eventEmitter.emit(v.PiPStateChange,{state:t,field:e})}}handleRemotePlaybackStateChanged(e){if(this.remotePlayback){var t=this.remotePlayback.getRemotePlaybackState();qu.log("RemotePlayback: "+e+" is "+t[e]+"."),this.eventEmitter.emit(v.RemotePlaybackStateChange,{state:t,field:e})}}}class Ku{constructor(e){this.emitter=void 0,this.availableQualities=[],this.currentQuality=void 0,this.emitter=e}setAvailableQualities(e){this.availableQualities=e}setCurrentQualityByLevel(e){var t=this.availableQualities.find((t=>t.level===e));t&&this.setCurrentQuality(t)}setCurrentQualityByBitrate(e){var t=this.availableQualities.find((t=>t.bitrate===e||t.averageBitrate===e));t&&this.setCurrentQuality(t)}setCurrentQualityByVideoProps(e,t,i){var n=this.availableQualities.find((n=>n.width===e&&n.height===t&&(void 0===i||n.frameRate===i)));n&&this.setCurrentQuality(n)}setCurrentQuality(e){this.currentQuality!==e&&(this.currentQuality=e,this.dispatchQualityChangeEvent())}getCurrentQuality(){return this.currentQuality}dispatchQualityChangeEvent(){this.currentQuality&&this.emitter.emit(v.QualityChange,this.currentQuality)}}var zu=I("ScrubberUpdate");class Xu{constructor(e,t,i){this.session=void 0,this.eventEmitter=void 0,this.interval=void 0,this.intervalId=void 0,this.session=e,this.eventEmitter=t,this.interval=null!=i?i:250,e.isTimeRunning()?this.start():t.once(v.TimeRunningChange,(()=>this.start())),t.on(v.Broken,(()=>this.destroy())),t.on(v.SessionClosed,(()=>this.destroy()))}start(){this.session.isLiveStream()&&!this.session.isLiveStreamEnded()?(zu.log("Emitting scrubber update events by interval timer."),this.eventEmitter.emit(v.ScrubberUpdate,this.session.getScrubberValues()),this.intervalId=setInterval((()=>{this.eventEmitter.emit(v.ScrubberUpdate,this.session.getScrubberValues())}),this.interval),this.eventEmitter.once(v.LiveStreamEnded,(()=>{this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0),zu.log("Changing to piggybacking on time updates."),this.eventEmitter.on(v.TimeUpdate,(()=>{this.eventEmitter.emit(v.ScrubberUpdate,this.session.getScrubberValues())}))}))):(zu.log("Emitting scrubber update events by piggybacking on time updates."),this.eventEmitter.on(v.TimeUpdate,(()=>{this.eventEmitter.emit(v.ScrubberUpdate,this.session.getScrubberValues())})))}destroy(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0)}}function Yu(e,t){var i,n=function(e,t){if(e instanceof HTMLMediaElement)return e;var i=e.querySelector(t);if(i)return i;var n=document.createElement(t);return e.insertBefore(n,e.firstChild),n}(e,null!=(i=null==t?void 0:t.type)?i:"video");return function(e,t){var i;"none"===(null==t?void 0:t.crossOrigin)?e.removeAttribute("crossorigin"):e.crossOrigin=null!=(i=null==t?void 0:t.crossOrigin)?i:"anonymous";!1===(null==t?void 0:t.playsInline)?(e.removeAttribute("playsinline"),e.removeAttribute("webkit-playsinline")):(e.setAttribute("playsinline",""),e.setAttribute("webkit-playsinline",""));null!=t&&t.videoPoster&&e instanceof HTMLVideoElement&&(e.poster=t.videoPoster)}(n,t),n}function Qu(e,t){var i=function(e,t){if(e instanceof HTMLObjectElement&&e.type===t)return e;var i=e.querySelector('object[type="'+t+'"]');if(i)return i;var n=document.createElement("object");return n.type=t,e.insertBefore(n,e.firstChild),n}(e,t.type);return Object.getOwnPropertyNames(t).forEach((e=>{i.setAttribute(e,""+t[e])})),i}class $u{constructor(e,t,i){this.playerElement=void 0,this.adapters=void 0,this.config=void 0,this.playerElement=e,this.adapters=t,this.config=i}canPlayType(e){return void 0!==this.findSupportedAdapter(e)}createPlaybackSession(e,t,i){var a,r,s,o,l=t?"string"==typeof t?w(t):t:R(e);if(!l)throw new Error("Unable to detect media type. Please specify.");var u=this.findSupportedAdapter(l);if(!u)throw new Error("No matching adapter for "+A(l)+".");var c,d,h=this.playerElement instanceof HTMLElement?this.playerElement:this.playerElement.eventElement,g=new Tu,p=new Su(h),v=new ku([g,p]),f=new Ku(v),m=this.playerElement instanceof HTMLElement?this.playerElement:this.playerElement.mediaElement;"AVPlay"===u.getAdapterInfo().id?c=Qu(m,{type:"application/avplayer"}):c=Yu(m,n({type:this.resolvePlayerType(l)},null==(d=this.config)?void 0:d.mediaElementOptions,i));var y=this.playerElement instanceof HTMLElement?this.playerElement:this.playerElement.fullscreenElement,b=new Gu(v,y,c instanceof HTMLMediaElement?c:void 0,null==(a=this.config)?void 0:a.displayModesOptions),T=new u(c,v,f,e,l,i,this.config),k=new Du(T,v,g,f,b,null==this||null==(r=this.config)?void 0:r.liveOptions);return new Xu(k,v,null==(s=this.config)||null==(o=s.liveOptions)?void 0:o.liveScrubberUpdateInterval),k}resolvePlayerType(e){return e&&x(e)?"audio":"video"}findSupportedAdapter(e){return this.adapters.find((t=>t.canPlayType(e)))}}function Ju(e,t){return(Ju=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function Zu(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,Ju(e,t)}var ec=function(){function e(){this.listeners={}}var t=e.prototype;return t.on=function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)},t.off=function(e,t){if(!this.listeners[e])return!1;var i=this.listeners[e].indexOf(t);return this.listeners[e]=this.listeners[e].slice(0),this.listeners[e].splice(i,1),i>-1},t.trigger=function(e){var t=this.listeners[e];if(t)if(2===arguments.length)for(var i=t.length,n=0;n<i;++n)t[n].call(this,arguments[1]);else for(var a=Array.prototype.slice.call(arguments,1),r=t.length,s=0;s<r;++s)t[s].apply(this,a)},t.dispose=function(){this.listeners={}},t.pipe=function(e){this.on("data",(function(t){e.push(t)}))},e}();function tc(){return(tc=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}).apply(this,arguments)}var ic="undefined"!=typeof window?window:void 0!==_?_:"undefined"!=typeof self?self:{};function nc(e){for(var t,i=(t=e,ic.atob?ic.atob(t):Buffer.from(t,"base64").toString("binary")),n=new Uint8Array(i.length),a=0;a<i.length;a++)n[a]=i.charCodeAt(a);return n}
/*! @name m3u8-parser @version 4.7.0 @license Apache-2.0 */var ac=function(e){function t(){var t;return(t=e.call(this)||this).buffer="",t}return Zu(t,e),t.prototype.push=function(e){var t;for(this.buffer+=e,t=this.buffer.indexOf("\n");t>-1;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},t}(ec),rc=String.fromCharCode(9),sc=function(e){var t=/([0-9.]*)?@?([0-9.]*)?/.exec(e||""),i={};return t[1]&&(i.length=parseInt(t[1],10)),t[2]&&(i.offset=parseInt(t[2],10)),i},oc=function(e){for(var t,i=e.split(new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')),n={},a=i.length;a--;)""!==i[a]&&((t=/([^=]*)=(.*)/.exec(i[a]).slice(1))[0]=t[0].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^['"](.*)['"]$/g,"$1"),n[t[0]]=t[1]);return n},lc=function(e){function t(){var t;return(t=e.call(this)||this).customParsers=[],t.tagMappers=[],t}Zu(t,e);var i=t.prototype;return i.push=function(e){var t,i,n=this;0!==(e=e.trim()).length&&("#"===e[0]?this.tagMappers.reduce((function(t,i){var n=i(e);return n===e?t:t.concat([n])}),[e]).forEach((function(e){for(var a=0;a<n.customParsers.length;a++)if(n.customParsers[a].call(n,e))return;if(0===e.indexOf("#EXT"))if(e=e.replace("\r",""),t=/^#EXTM3U/.exec(e))n.trigger("data",{type:"tag",tagType:"m3u"});else{if(t=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(e))return i={type:"tag",tagType:"inf"},t[1]&&(i.duration=parseFloat(t[1])),t[2]&&(i.title=t[2]),void n.trigger("data",i);if(t=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(e))return i={type:"tag",tagType:"targetduration"},t[1]&&(i.duration=parseInt(t[1],10)),void n.trigger("data",i);if(t=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(e))return i={type:"tag",tagType:"version"},t[1]&&(i.version=parseInt(t[1],10)),void n.trigger("data",i);if(t=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return i={type:"tag",tagType:"media-sequence"},t[1]&&(i.number=parseInt(t[1],10)),void n.trigger("data",i);if(t=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(e))return i={type:"tag",tagType:"discontinuity-sequence"},t[1]&&(i.number=parseInt(t[1],10)),void n.trigger("data",i);if(t=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(e))return i={type:"tag",tagType:"playlist-type"},t[1]&&(i.playlistType=t[1]),void n.trigger("data",i);if(t=/^#EXT-X-BYTERANGE:?(.*)?$/.exec(e))return i=tc(sc(t[1]),{type:"tag",tagType:"byterange"}),void n.trigger("data",i);if(t=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(e))return i={type:"tag",tagType:"allow-cache"},t[1]&&(i.allowed=!/NO/.test(t[1])),void n.trigger("data",i);if(t=/^#EXT-X-MAP:?(.*)$/.exec(e)){if(i={type:"tag",tagType:"map"},t[1]){var r=oc(t[1]);r.URI&&(i.uri=r.URI),r.BYTERANGE&&(i.byterange=sc(r.BYTERANGE))}n.trigger("data",i)}else if(t=/^#EXT-X-STREAM-INF:?(.*)$/.exec(e)){if(i={type:"tag",tagType:"stream-inf"},t[1]){if(i.attributes=oc(t[1]),i.attributes.RESOLUTION){var s=i.attributes.RESOLUTION.split("x"),o={};s[0]&&(o.width=parseInt(s[0],10)),s[1]&&(o.height=parseInt(s[1],10)),i.attributes.RESOLUTION=o}i.attributes.BANDWIDTH&&(i.attributes.BANDWIDTH=parseInt(i.attributes.BANDWIDTH,10)),i.attributes["PROGRAM-ID"]&&(i.attributes["PROGRAM-ID"]=parseInt(i.attributes["PROGRAM-ID"],10))}n.trigger("data",i)}else{if(t=/^#EXT-X-MEDIA:?(.*)$/.exec(e))return i={type:"tag",tagType:"media"},t[1]&&(i.attributes=oc(t[1])),void n.trigger("data",i);if(t=/^#EXT-X-ENDLIST/.exec(e))n.trigger("data",{type:"tag",tagType:"endlist"});else if(t=/^#EXT-X-DISCONTINUITY/.exec(e))n.trigger("data",{type:"tag",tagType:"discontinuity"});else{if(t=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(e))return i={type:"tag",tagType:"program-date-time"},t[1]&&(i.dateTimeString=t[1],i.dateTimeObject=new Date(t[1])),void n.trigger("data",i);if(t=/^#EXT-X-KEY:?(.*)$/.exec(e))return i={type:"tag",tagType:"key"},t[1]&&(i.attributes=oc(t[1]),i.attributes.IV&&("0x"===i.attributes.IV.substring(0,2).toLowerCase()&&(i.attributes.IV=i.attributes.IV.substring(2)),i.attributes.IV=i.attributes.IV.match(/.{8}/g),i.attributes.IV[0]=parseInt(i.attributes.IV[0],16),i.attributes.IV[1]=parseInt(i.attributes.IV[1],16),i.attributes.IV[2]=parseInt(i.attributes.IV[2],16),i.attributes.IV[3]=parseInt(i.attributes.IV[3],16),i.attributes.IV=new Uint32Array(i.attributes.IV))),void n.trigger("data",i);if(t=/^#EXT-X-START:?(.*)$/.exec(e))return i={type:"tag",tagType:"start"},t[1]&&(i.attributes=oc(t[1]),i.attributes["TIME-OFFSET"]=parseFloat(i.attributes["TIME-OFFSET"]),i.attributes.PRECISE=/YES/.test(i.attributes.PRECISE)),void n.trigger("data",i);if(t=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(e))return i={type:"tag",tagType:"cue-out-cont"},t[1]?i.data=t[1]:i.data="",void n.trigger("data",i);if(t=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(e))return i={type:"tag",tagType:"cue-out"},t[1]?i.data=t[1]:i.data="",void n.trigger("data",i);if(t=/^#EXT-X-CUE-IN:?(.*)?$/.exec(e))return i={type:"tag",tagType:"cue-in"},t[1]?i.data=t[1]:i.data="",void n.trigger("data",i);if((t=/^#EXT-X-SKIP:(.*)$/.exec(e))&&t[1])return(i={type:"tag",tagType:"skip"}).attributes=oc(t[1]),i.attributes.hasOwnProperty("SKIPPED-SEGMENTS")&&(i.attributes["SKIPPED-SEGMENTS"]=parseInt(i.attributes["SKIPPED-SEGMENTS"],10)),i.attributes.hasOwnProperty("RECENTLY-REMOVED-DATERANGES")&&(i.attributes["RECENTLY-REMOVED-DATERANGES"]=i.attributes["RECENTLY-REMOVED-DATERANGES"].split(rc)),void n.trigger("data",i);if((t=/^#EXT-X-PART:(.*)$/.exec(e))&&t[1])return(i={type:"tag",tagType:"part"}).attributes=oc(t[1]),["DURATION"].forEach((function(e){i.attributes.hasOwnProperty(e)&&(i.attributes[e]=parseFloat(i.attributes[e]))})),["INDEPENDENT","GAP"].forEach((function(e){i.attributes.hasOwnProperty(e)&&(i.attributes[e]=/YES/.test(i.attributes[e]))})),i.attributes.hasOwnProperty("BYTERANGE")&&(i.attributes.byterange=sc(i.attributes.BYTERANGE)),void n.trigger("data",i);if((t=/^#EXT-X-SERVER-CONTROL:(.*)$/.exec(e))&&t[1])return(i={type:"tag",tagType:"server-control"}).attributes=oc(t[1]),["CAN-SKIP-UNTIL","PART-HOLD-BACK","HOLD-BACK"].forEach((function(e){i.attributes.hasOwnProperty(e)&&(i.attributes[e]=parseFloat(i.attributes[e]))})),["CAN-SKIP-DATERANGES","CAN-BLOCK-RELOAD"].forEach((function(e){i.attributes.hasOwnProperty(e)&&(i.attributes[e]=/YES/.test(i.attributes[e]))})),void n.trigger("data",i);if((t=/^#EXT-X-PART-INF:(.*)$/.exec(e))&&t[1])return(i={type:"tag",tagType:"part-inf"}).attributes=oc(t[1]),["PART-TARGET"].forEach((function(e){i.attributes.hasOwnProperty(e)&&(i.attributes[e]=parseFloat(i.attributes[e]))})),void n.trigger("data",i);if((t=/^#EXT-X-PRELOAD-HINT:(.*)$/.exec(e))&&t[1])return(i={type:"tag",tagType:"preload-hint"}).attributes=oc(t[1]),["BYTERANGE-START","BYTERANGE-LENGTH"].forEach((function(e){if(i.attributes.hasOwnProperty(e)){i.attributes[e]=parseInt(i.attributes[e],10);var t="BYTERANGE-LENGTH"===e?"length":"offset";i.attributes.byterange=i.attributes.byterange||{},i.attributes.byterange[t]=i.attributes[e],delete i.attributes[e]}})),void n.trigger("data",i);if((t=/^#EXT-X-RENDITION-REPORT:(.*)$/.exec(e))&&t[1])return(i={type:"tag",tagType:"rendition-report"}).attributes=oc(t[1]),["LAST-MSN","LAST-PART"].forEach((function(e){i.attributes.hasOwnProperty(e)&&(i.attributes[e]=parseInt(i.attributes[e],10))})),void n.trigger("data",i);n.trigger("data",{type:"tag",data:e.slice(4)})}}}else n.trigger("data",{type:"comment",text:e.slice(1)})})):this.trigger("data",{type:"uri",uri:e}))},i.addParser=function(e){var t=this,i=e.expression,n=e.customType,a=e.dataParser,r=e.segment;"function"!=typeof a&&(a=function(e){return e}),this.customParsers.push((function(e){if(i.exec(e))return t.trigger("data",{type:"custom",data:a(e),customType:n,segment:r}),!0}))},i.addTagMapper=function(e){var t=e.expression,i=e.map;this.tagMappers.push((function(e){return t.test(e)?i(e):e}))},t}(ec),uc=function(e){var t={};return Object.keys(e).forEach((function(i){var n;t[(n=i,n.toLowerCase().replace(/-(\w)/g,(function(e){return e[1].toUpperCase()})))]=e[i]})),t},cc=function(e){var t=e.serverControl,i=e.targetDuration,n=e.partTargetDuration;if(t){var a="#EXT-X-SERVER-CONTROL",r="holdBack",s="partHoldBack",o=i&&3*i,l=n&&2*n;i&&!t.hasOwnProperty(r)&&(t[r]=o,this.trigger("info",{message:a+" defaulting HOLD-BACK to targetDuration * 3 ("+o+")."})),o&&t[r]<o&&(this.trigger("warn",{message:a+" clamping HOLD-BACK ("+t[r]+") to targetDuration * 3 ("+o+")"}),t[r]=o),n&&!t.hasOwnProperty(s)&&(t[s]=3*n,this.trigger("info",{message:a+" defaulting PART-HOLD-BACK to partTargetDuration * 3 ("+t[s]+")."})),n&&t[s]<l&&(this.trigger("warn",{message:a+" clamping PART-HOLD-BACK ("+t[s]+") to partTargetDuration * 2 ("+l+")."}),t[s]=l)}},dc=function(e){function t(){var t;(t=e.call(this)||this).lineStream=new ac,t.parseStream=new lc,t.lineStream.pipe(t.parseStream);var i,n,a=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t),r=[],s={},o=!1,l=function(){},u={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},c=0;t.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};var d=0,h=0;return t.on("end",(function(){s.uri||!s.parts&&!s.preloadHints||(!s.map&&i&&(s.map=i),!s.key&&n&&(s.key=n),s.timeline||"number"!=typeof c||(s.timeline=c),t.manifest.preloadSegment=s)})),t.parseStream.on("data",(function(e){var t,g;({tag:function(){({version:function(){e.version&&(this.manifest.version=e.version)},"allow-cache":function(){this.manifest.allowCache=e.allowed,"allowed"in e||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var t={};"length"in e&&(s.byterange=t,t.length=e.length,"offset"in e||(e.offset=d)),"offset"in e&&(s.byterange=t,t.offset=e.offset),d=t.offset+t.length},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),e.duration>0&&(s.duration=e.duration),0===e.duration&&(s.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"})),this.manifest.segments=r},key:function(){if(e.attributes)if("NONE"!==e.attributes.METHOD)if(e.attributes.URI){if("com.apple.streamingkeydelivery"===e.attributes.KEYFORMAT)return this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.apple.fps.1_0"]={attributes:e.attributes});if("urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"===e.attributes.KEYFORMAT){return-1===["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(e.attributes.METHOD)?void this.trigger("warn",{message:"invalid key method provided for Widevine"}):("SAMPLE-AES-CENC"===e.attributes.METHOD&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),"data:text/plain;base64,"!==e.attributes.URI.substring(0,23)?void this.trigger("warn",{message:"invalid key URI provided for Widevine"}):e.attributes.KEYID&&"0x"===e.attributes.KEYID.substring(0,2)?(this.manifest.contentProtection=this.manifest.contentProtection||{},void(this.manifest.contentProtection["com.widevine.alpha"]={attributes:{schemeIdUri:e.attributes.KEYFORMAT,keyId:e.attributes.KEYID.substring(2)},pssh:nc(e.attributes.URI.split(",")[1])})):void this.trigger("warn",{message:"invalid key ID provided for Widevine"}))}e.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),n={method:e.attributes.METHOD||"AES-128",uri:e.attributes.URI},void 0!==e.attributes.IV&&(n.iv=e.attributes.IV)}else this.trigger("warn",{message:"ignoring key declaration without URI"});else n=null;else this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){isFinite(e.number)?this.manifest.mediaSequence=e.number:this.trigger("warn",{message:"ignoring invalid media sequence: "+e.number})},"discontinuity-sequence":function(){isFinite(e.number)?(this.manifest.discontinuitySequence=e.number,c=e.number):this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+e.number})},"playlist-type":function(){/VOD|EVENT/.test(e.playlistType)?this.manifest.playlistType=e.playlistType:this.trigger("warn",{message:"ignoring unknown playlist type: "+e.playlist})},map:function(){i={},e.uri&&(i.uri=e.uri),e.byterange&&(i.byterange=e.byterange),n&&(i.key=n)},"stream-inf":function(){this.manifest.playlists=r,this.manifest.mediaGroups=this.manifest.mediaGroups||u,e.attributes?(s.attributes||(s.attributes={}),tc(s.attributes,e.attributes)):this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||u,e.attributes&&e.attributes.TYPE&&e.attributes["GROUP-ID"]&&e.attributes.NAME){var i=this.manifest.mediaGroups[e.attributes.TYPE];i[e.attributes["GROUP-ID"]]=i[e.attributes["GROUP-ID"]]||{},t=i[e.attributes["GROUP-ID"]],(g={default:/yes/i.test(e.attributes.DEFAULT)}).default?g.autoselect=!0:g.autoselect=/yes/i.test(e.attributes.AUTOSELECT),e.attributes.LANGUAGE&&(g.language=e.attributes.LANGUAGE),e.attributes.URI&&(g.uri=e.attributes.URI),e.attributes["INSTREAM-ID"]&&(g.instreamId=e.attributes["INSTREAM-ID"]),e.attributes.CHARACTERISTICS&&(g.characteristics=e.attributes.CHARACTERISTICS),e.attributes.FORCED&&(g.forced=/yes/i.test(e.attributes.FORCED)),t[e.attributes.NAME]=g}else this.trigger("warn",{message:"ignoring incomplete or missing media group"})},discontinuity:function(){c+=1,s.discontinuity=!0,this.manifest.discontinuityStarts.push(r.length)},"program-date-time":function(){void 0===this.manifest.dateTimeString&&(this.manifest.dateTimeString=e.dateTimeString,this.manifest.dateTimeObject=e.dateTimeObject),s.dateTimeString=e.dateTimeString,s.dateTimeObject=e.dateTimeObject},targetduration:function(){!isFinite(e.duration)||e.duration<0?this.trigger("warn",{message:"ignoring invalid target duration: "+e.duration}):(this.manifest.targetDuration=e.duration,cc.call(this,this.manifest))},start:function(){e.attributes&&!isNaN(e.attributes["TIME-OFFSET"])?this.manifest.start={timeOffset:e.attributes["TIME-OFFSET"],precise:e.attributes.PRECISE}:this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"})},"cue-out":function(){s.cueOut=e.data},"cue-out-cont":function(){s.cueOutCont=e.data},"cue-in":function(){s.cueIn=e.data},skip:function(){this.manifest.skip=uc(e.attributes),this.warnOnMissingAttributes_("#EXT-X-SKIP",e.attributes,["SKIPPED-SEGMENTS"])},part:function(){var t=this;o=!0;var i=this.manifest.segments.length,n=uc(e.attributes);s.parts=s.parts||[],s.parts.push(n),n.byterange&&(n.byterange.hasOwnProperty("offset")||(n.byterange.offset=h),h=n.byterange.offset+n.byterange.length);var a=s.parts.length-1;this.warnOnMissingAttributes_("#EXT-X-PART #"+a+" for segment #"+i,e.attributes,["URI","DURATION"]),this.manifest.renditionReports&&this.manifest.renditionReports.forEach((function(e,i){e.hasOwnProperty("lastPart")||t.trigger("warn",{message:"#EXT-X-RENDITION-REPORT #"+i+" lacks required attribute(s): LAST-PART"})}))},"server-control":function(){var t=this.manifest.serverControl=uc(e.attributes);t.hasOwnProperty("canBlockReload")||(t.canBlockReload=!1,this.trigger("info",{message:"#EXT-X-SERVER-CONTROL defaulting CAN-BLOCK-RELOAD to false"})),cc.call(this,this.manifest),t.canSkipDateranges&&!t.hasOwnProperty("canSkipUntil")&&this.trigger("warn",{message:"#EXT-X-SERVER-CONTROL lacks required attribute CAN-SKIP-UNTIL which is required when CAN-SKIP-DATERANGES is set"})},"preload-hint":function(){var t=this.manifest.segments.length,i=uc(e.attributes),n=i.type&&"PART"===i.type;s.preloadHints=s.preloadHints||[],s.preloadHints.push(i),i.byterange&&(i.byterange.hasOwnProperty("offset")||(i.byterange.offset=n?h:0,n&&(h=i.byterange.offset+i.byterange.length)));var a=s.preloadHints.length-1;if(this.warnOnMissingAttributes_("#EXT-X-PRELOAD-HINT #"+a+" for segment #"+t,e.attributes,["TYPE","URI"]),i.type)for(var r=0;r<s.preloadHints.length-1;r++){var o=s.preloadHints[r];o.type&&(o.type===i.type&&this.trigger("warn",{message:"#EXT-X-PRELOAD-HINT #"+a+" for segment #"+t+" has the same TYPE "+i.type+" as preload hint #"+r}))}},"rendition-report":function(){var t=uc(e.attributes);this.manifest.renditionReports=this.manifest.renditionReports||[],this.manifest.renditionReports.push(t);var i=this.manifest.renditionReports.length-1,n=["LAST-MSN","URI"];o&&n.push("LAST-PART"),this.warnOnMissingAttributes_("#EXT-X-RENDITION-REPORT #"+i,e.attributes,n)},"part-inf":function(){this.manifest.partInf=uc(e.attributes),this.warnOnMissingAttributes_("#EXT-X-PART-INF",e.attributes,["PART-TARGET"]),this.manifest.partInf.partTarget&&(this.manifest.partTargetDuration=this.manifest.partInf.partTarget),cc.call(this,this.manifest)}}[e.tagType]||l).call(a)},uri:function(){s.uri=e.uri,r.push(s),this.manifest.targetDuration&&!("duration"in s)&&(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),s.duration=this.manifest.targetDuration),n&&(s.key=n),s.timeline=c,i&&(s.map=i),h=0,s={}},comment:function(){},custom:function(){e.segment?(s.custom=s.custom||{},s.custom[e.customType]=e.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[e.customType]=e.data)}})[e.type].call(a)})),t}Zu(t,e);var i=t.prototype;return i.warnOnMissingAttributes_=function(e,t,i){var n=[];i.forEach((function(e){t.hasOwnProperty(e)||n.push(e)})),n.length&&this.trigger("warn",{message:e+" lacks required attribute(s): "+n.join(", ")})},i.push=function(e){this.lineStream.push(e)},i.end=function(){this.lineStream.push("\n"),this.trigger("end")},i.addParser=function(e){this.parseStream.addParser(e)},i.addTagMapper=function(e){this.parseStream.addTagMapper(e)},t}(ec);class hc extends Error{constructor(e,t){super(e),this.cause=t,Object.setPrototypeOf(this,hc.prototype),this.name="DecodeError"}}class gc extends Error{constructor(e,t){super(e),this.cause=t,Object.setPrototypeOf(this,gc.prototype),this.name="NetworkError"}}var pc,vc={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};function fc(e,t){var i=vc[t];return!!i&&!0===i[e.slice(0,4)]}async function mc(e,t){var i;try{i=await M(e,t)}catch(t){throw new gc("Failed to fetch master playlist: "+e,t)}return function(e,t){var i,n,a=new dc;try{a.push(t),a.end()}catch(e){throw new hc("Failed to parse media playlist.",e)}var r,s=a.manifest,o=new Set,l=!0,u=null!=(i=null==s||null==(n=s.playlists)?void 0:n.map((t=>{var i,n,a=t.attributes.SUBTITLES;void 0!==a&&o.add(a);var s=null!=(i=null==(n=t.attributes.CODECS)?void 0:n.split(","))?i:[];if(l)for(var u=0;u<s.length;++u)if(!fc(s[u],"audio")){l=!1;break}var c=function(e){var t,i,n=e["AVERAGE-BANDWIDTH"]?Number.parseInt(e["AVERAGE-BANDWIDTH"],10):void 0,a=e["FRAME-RATE"]?Number.parseFloat(e["FRAME-RATE"]):void 0,r={level:-1,bitrate:null!=(t=null!=(i=e.BANDWIDTH)?i:n)?t:0,averageBitrate:n,frameRate:a},s=e.RESOLUTION;void 0!==s&&(r.width=s.width,r.height=s.height);return r}(t.attributes);return void 0===r&&void 0!==c.width&&(r=N(c.width,c.height)),{quality:c,url:new URL(t.uri,e).toString()}})))?i:[],c=function(e,t,i){var n=[];if(0===i.length)return;var a=e.mediaGroups.SUBTITLES[i[0]];return Object.keys(a).forEach((e=>{var i=a[e],{language:r,autoselect:s,forced:o,default:l,uri:u}=i;n.push({id:("hls-"+r+"-"+e).replace(/[^-\w]+/,""),label:e,language:r,autoselect:null!=s&&s,defaultOn:null!=l&&l,forced:null!=o&&o,src:new URL(u,t).toString()})})),0===n.length?void 0:n}(s,e,Array.from(o));return{isAudioOnly:l,levels:u,orientation:r,subtitles:c}}(e,i)}function yc(e){var t=function(e){var t={};return e.filter((e=>{var i=JSON.stringify(e);return!t[i]&&(t[i]=!0,!0)}))}(e.map((e=>e.quality)));return t.sort(((e,t)=>e.bitrate-t.bitrate)),t.forEach(((e,t)=>e.level=t)),t}async function bc(e,t){var i;try{i=await M(e,t)}catch(t){throw new gc("Failed to fetch media playlist: "+e,t)}return function(e){var t,i=new dc;try{i.push(e),i.end()}catch(e){throw new hc("Failed to parse media playlist.",e)}var n=i.manifest,a=!0===n.endList||"VOD"===n.playlistType,r="VOD"===n.playlistType||"EVENT"===n.playlistType,s=n.dateTimeObject,o=null!=(t=n.totalDuration)?t:n.segments.reduce(((e,t)=>e+t.duration),0),l=0===n.segments.length?n.targetDuration:Math.round(o/n.segments.length);if(void 0===l)throw new hc("Media playlist is missing required tag EXT-X-TARGETDURATION.");return{averageSegmentDuration:l,fixedEnd:a,fixedStart:r,playlistDuration:o,programDateTime:s}}(i)}function Tc(e){return{[pc.Idle]:{playbackState:D.Idle},[pc.Playing]:{playbackState:D.Playing},[pc.Paused]:{playbackState:D.Paused},[pc.AutoplayBlocked]:{playbackState:D.Paused,pausedReason:m.AutoplayBlocked},[pc.Broken]:{playbackState:D.Broken},[pc.Starting]:{playbackState:D.Playing,waitingReason:y.Starting},[pc.Seeking]:{playbackState:D.Playing,waitingReason:y.Seeking},[pc.Rebuffering]:{playbackState:D.Playing,waitingReason:y.Rebuffering},[pc.PausedSeeking]:{playbackState:D.Paused,waitingReason:y.Seeking},[pc.Ended]:{playbackState:D.Paused,pausedReason:m.Ended}}[e]}function kc(){return navigator.languages?navigator.languages:navigator.language?[navigator.language]:[]}function Sc(e){var t=new Set(e);e.forEach((e=>t.add(Pc(e))));var i=Array.from(t);if(!t.has("no")){var n=i.findIndex((e=>/^(nb|nn|se)$/.exec(e)));n>=0&&i.splice(n+1,0,"no")}return i}function Ec(e,t,i){var n=i.length,a=e.map(((e,a)=>{var r=t(e),s=i.indexOf(r);if(-1!==s)return[s,a];var o=i.indexOf(Pc(r));return-1!==o?[o,a]:[n,a]}));return a.sort(((e,t)=>e[0]-t[0])),a.map((t=>e[t[1]]))}function Pc(e){return e.replace(/^((?:\w-)?\w+).*$/,"$1")}!function(e){e.Idle="idle",e.Playing="playing",e.Paused="paused",e.AutoplayBlocked="autoplayblocked",e.Broken="broken",e.Starting="starting",e.Seeking="seeking",e.Rebuffering="rebuffering",e.PausedSeeking="paused-seeking",e.Ended="ended"}(pc||(pc={}));var Cc,Ic=I("AdapterFSM");function wc(e,t){var i=new O.FiniteStateMachine(pc.Idle);return function(e){e.from(pc.Idle).to(pc.Starting,pc.Broken),e.from(pc.Starting).to(pc.Playing,pc.Paused,pc.AutoplayBlocked,pc.Broken),e.from(pc.Playing).to(pc.Seeking,pc.Rebuffering,pc.Paused,pc.AutoplayBlocked,pc.Ended,pc.Broken),e.from(pc.Seeking).to(pc.Playing,pc.Paused,pc.Ended,pc.Broken),e.from(pc.Rebuffering).to(pc.Playing,pc.Seeking,pc.Paused,pc.Ended,pc.Broken),e.from(pc.Paused).to(pc.Playing,pc.Rebuffering,pc.PausedSeeking,pc.Ended,pc.Broken),e.from(pc.AutoplayBlocked).to(pc.Playing,pc.Rebuffering,pc.PausedSeeking,pc.Broken),e.from(pc.PausedSeeking).to(pc.Seeking,pc.Paused,pc.AutoplayBlocked,pc.Ended,pc.Broken),e.from(pc.Ended).to(pc.Playing,pc.Rebuffering,pc.PausedSeeking)}(i),function(e,t,i){function n(t,i,n){e.on(i,(e=>{t===e&&n()}))}var a=!1,r=()=>{a?(a=!1,t.emit(v.PlayingChange,{isPlaying:!0,type:f.Replay})):t.emit(v.PlayingChange,{isPlaying:!0})};n(pc.Idle,pc.Starting,(()=>{t.emit(v.PlayingChange,{isPlaying:!0,type:f.Starting}),t.emit(v.WaitingChange,{isWaiting:!0,reason:y.Starting})})),n(pc.Idle,pc.Broken,(()=>{t.emit(v.Broken,{error:i.getError()})})),n(pc.Starting,pc.Playing,(()=>{t.emit(v.WaitingChange,{isWaiting:!1,reason:y.Starting}),t.emit(v.TimeRunningChange,{isTimeRunning:!0,time:i.getStartTime()})})),n(pc.Starting,pc.Paused,(()=>{t.emit(v.WaitingChange,{isWaiting:!1,reason:y.Starting}),t.emit(v.PlayingChange,{isPlaying:!1})})),n(pc.Starting,pc.AutoplayBlocked,(()=>{t.emit(v.WaitingChange,{isWaiting:!1,reason:y.Starting}),t.emit(v.PlayingChange,{isPlaying:!1,pausedReason:m.AutoplayBlocked})})),n(pc.Starting,pc.Broken,(()=>{t.emit(v.WaitingChange,{isWaiting:!1,reason:y.Starting}),t.emit(v.PlayingChange,{isPlaying:!1}),t.emit(v.Broken,{error:i.getError()})})),n(pc.Playing,pc.Seeking,(()=>{t.emit(v.TimeRunningChange,{isTimeRunning:!1,time:i.getStopTime()}),t.emit(v.WaitingChange,{isWaiting:!0,reason:y.Seeking})})),n(pc.Playing,pc.Rebuffering,(()=>{t.emit(v.TimeRunningChange,{isTimeRunning:!1,time:i.getStopTime()}),t.emit(v.WaitingChange,{isWaiting:!0,reason:y.Rebuffering})})),n(pc.Playing,pc.Paused,(()=>{t.emit(v.TimeRunningChange,{isTimeRunning:!1,time:i.getStopTime()}),t.emit(v.PlayingChange,{isPlaying:!1})})),n(pc.Playing,pc.AutoplayBlocked,(()=>{t.emit(v.TimeRunningChange,{isTimeRunning:!1,time:i.getStopTime()}),t.emit(v.PlayingChange,{isPlaying:!1,pausedReason:m.AutoplayBlocked})})),n(pc.Playing,pc.Ended,(()=>{t.emit(v.TimeRunningChange,{isTimeRunning:!1,time:i.getStopTime()}),t.emit(v.PlayingChange,{isPlaying:!1,pausedReason:m.Ended})})),n(pc.Playing,pc.Broken,(()=>{t.emit(v.TimeRunningChange,{isTimeRunning:!1,time:i.getStopTime()}),t.emit(v.PlayingChange,{isPlaying:!1}),t.emit(v.Broken,{error:i.getError()})})),n(pc.Seeking,pc.Playing,(()=>{t.emit(v.WaitingChange,{isWaiting:!1,reason:y.Seeking}),t.emit(v.TimeRunningChange,{isTimeRunning:!0,time:i.getStartTime()})})),n(pc.Seeking,pc.Paused,(()=>{t.emit(v.WaitingChange,{isWaiting:!1,reason:y.Seeking}),t.emit(v.PlayingChange,{isPlaying:!1})})),n(pc.Seeking,pc.Ended,(()=>{t.emit(v.WaitingChange,{isWaiting:!1,reason:y.Seeking}),t.emit(v.PlayingChange,{isPlaying:!1,pausedReason:m.Ended})})),n(pc.Seeking,pc.Broken,(()=>{t.emit(v.WaitingChange,{isWaiting:!1,reason:y.Seeking}),t.emit(v.PlayingChange,{isPlaying:!1}),t.emit(v.Broken,{error:i.getError()})})),n(pc.Rebuffering,pc.Playing,(()=>{t.emit(v.WaitingChange,{isWaiting:!1,reason:y.Rebuffering}),t.emit(v.TimeRunningChange,{isTimeRunning:!0,time:i.getStartTime()})})),n(pc.Rebuffering,pc.Seeking,(()=>{t.emit(v.WaitingChange,{isWaiting:!0,reason:y.Seeking})})),n(pc.Rebuffering,pc.Paused,(()=>{t.emit(v.WaitingChange,{isWaiting:!1,reason:y.Rebuffering}),t.emit(v.PlayingChange,{isPlaying:!1})})),n(pc.Rebuffering,pc.Ended,(()=>{t.emit(v.WaitingChange,{isWaiting:!1,reason:y.Rebuffering}),t.emit(v.PlayingChange,{isPlaying:!1,pausedReason:m.Ended})})),n(pc.Rebuffering,pc.Broken,(()=>{t.emit(v.WaitingChange,{isWaiting:!1,reason:y.Rebuffering}),t.emit(v.PlayingChange,{isPlaying:!1}),t.emit(v.Broken,{error:i.getError()})})),n(pc.Paused,pc.Playing,(()=>{r(),t.emit(v.TimeRunningChange,{isTimeRunning:!0,time:i.getStartTime()})})),n(pc.Paused,pc.Rebuffering,(()=>{r(),t.emit(v.WaitingChange,{isWaiting:!0,reason:y.Rebuffering})})),n(pc.Paused,pc.PausedSeeking,(()=>{t.emit(v.WaitingChange,{isWaiting:!0,reason:y.Seeking})})),n(pc.Paused,pc.Ended,(()=>{t.emit(v.PlayingChange,{isPlaying:!1,pausedReason:m.Ended})})),n(pc.Paused,pc.Broken,(()=>{t.emit(v.Broken,{error:i.getError()})})),n(pc.AutoplayBlocked,pc.Playing,(()=>{r(),t.emit(v.TimeRunningChange,{isTimeRunning:!0,time:i.getStartTime()})})),n(pc.AutoplayBlocked,pc.Rebuffering,(()=>{r(),t.emit(v.WaitingChange,{isWaiting:!0,reason:y.Rebuffering})})),n(pc.AutoplayBlocked,pc.PausedSeeking,(()=>{t.emit(v.WaitingChange,{isWaiting:!0,reason:y.Seeking})})),n(pc.AutoplayBlocked,pc.Broken,(()=>{t.emit(v.Broken,{error:i.getError()})})),n(pc.PausedSeeking,pc.Seeking,(()=>{r()})),n(pc.PausedSeeking,pc.Paused,(()=>{t.emit(v.WaitingChange,{isWaiting:!1,reason:y.Seeking})})),n(pc.PausedSeeking,pc.AutoplayBlocked,(()=>{t.emit(v.WaitingChange,{isWaiting:!1,reason:y.Seeking})})),n(pc.PausedSeeking,pc.Ended,(()=>{t.emit(v.WaitingChange,{isWaiting:!1,reason:y.Seeking}),t.emit(v.PlayingChange,{isPlaying:!1,pausedReason:m.Ended})})),n(pc.PausedSeeking,pc.Broken,(()=>{t.emit(v.WaitingChange,{isWaiting:!1,reason:y.Seeking}),t.emit(v.Broken,{error:i.getError()})})),n(pc.Ended,pc.Playing,(()=>{a=!0,r(),t.emit(v.TimeRunningChange,{isTimeRunning:!0,time:i.getStartTime()})})),n(pc.Ended,pc.Rebuffering,(()=>{a=!0,r(),t.emit(v.WaitingChange,{isWaiting:!0,reason:y.Rebuffering})})),n(pc.Ended,pc.PausedSeeking,(()=>{a=!0,t.emit(v.WaitingChange,{isWaiting:!0,reason:y.Seeking})}))}(i,e,t),i.onTransition=(e,t)=>{Ic.log("Transitioned from "+e+" to "+t+".")},i.onInvalidTransition(((e,t)=>(Ic.log("Blocked adapter state transition from "+e+" to "+t+"."),!0))),i}!function(e){e[e.MEDIA_ERR_ABORTED=1]="MEDIA_ERR_ABORTED",e[e.MEDIA_ERR_NETWORK=2]="MEDIA_ERR_NETWORK",e[e.MEDIA_ERR_DECODE=3]="MEDIA_ERR_DECODE",e[e.MEDIA_ERR_SRC_NOT_SUPPORTED=4]="MEDIA_ERR_SRC_NOT_SUPPORTED"}(Cc||(Cc={}));var Rc=I("TextTrackSubtitles");class Ac{constructor(e,t,i){this.element=void 0,this.eventEmitter=void 0,this.configs=void 0,this.nativeDisplayEnabled=void 0,this.activeConfig=void 0,this.activeTrack=void 0,this.element=e,this.eventEmitter=t,this.configs=i?i.map((e=>Object.freeze(e))):[],this.nativeDisplayEnabled=!0}supportsAddingTracks(){return!0}addSubtitlesTrack(e,t,i,n){if(!this.element)throw new Error("Subtitle controls are destroyed.");var a="sub-"+Xt.slug(),{autoselect:r=!1,defaultOn:s=!1,forced:o=!1}=null!=n?n:{},l=document.createElement("track");l.id=a,l.kind="subtitles",l.label=t,l.src=e,l.srclang=i,l.onload=e=>{var n,r=e.target;r.onload=null;var s=r.track,o=(null==(n=this.activeTrack)?void 0:n.id)===s.id?this.nativeDisplayEnabled?"showing":"hidden":"disabled";s.mode!==o?(Rc.log("Subtitles "+a+" ("+t+"/"+i+") loaded as '"+s.mode+"'. Expected '"+o+"'."),s.mode=o):Rc.log("Subtitles "+a+" ("+t+"/"+i+") loaded as '"+s.mode+"'.")},this.element.appendChild(l);var u={id:a,src:e,label:t,language:i,autoselect:r,defaultOn:s,forced:o};return this.configs.push(Object.freeze(u)),Promise.resolve(u)}setNoSubtitles(){var e=this.getForcedConfig();this.switchSubtitles(e)}setDefaultSubtitles(){var e=this.getDefaultConfig();e?this.switchSubtitles(e):this.setNoSubtitles()}setAutoSubtitles(){var e=this.getDefaultConfig();if(e)this.switchSubtitles(e);else{var t=this.getAutoselectConfig();t?this.switchSubtitles(t):this.setNoSubtitles()}}setActiveSubtitles(e){var t="object"==typeof e?e.id:e,i=this.configs.find((e=>e.id===t&&!e.forced));i&&this.switchSubtitles(i)}getActiveSubtitles(){var e;return!1===(null==(e=this.activeConfig)?void 0:e.forced)?this.activeConfig:void 0}getAvailableSubtitles(){return this.configs.filter((e=>!e.forced))}enableNativeSubtitlesDisplay(){this.nativeDisplayEnabled||(this.nativeDisplayEnabled=!0,this.activeTrack&&(this.activeTrack.mode="showing"),this.emitSubtitleChange())}disableNativeSubtitlesDisplay(){this.nativeDisplayEnabled&&(this.nativeDisplayEnabled=!1,this.activeTrack&&(this.activeTrack.mode="hidden"),this.emitSubtitleChange())}isNativeSubtitlesDisplayEnabled(){return this.nativeDisplayEnabled}destroy(){this.activeTrack&&this.switchSubtitles(),this.element=void 0}getDefaultConfig(){return this.getBestLanguageMatch(this.configs.filter((e=>e.defaultOn&&!e.forced)))}getAutoselectConfig(){return this.getBestLanguageMatch(this.configs.filter((e=>(e.autoselect||e.defaultOn)&&!e.forced)))}getForcedConfig(){return this.getBestLanguageMatch(this.configs.filter((e=>e.forced)))}getBestLanguageMatch(e){if(0!==e.length)return Ec(e,(e=>e.language),Sc(kc()))[0]}switchSubtitles(e){var t;if((null==e?void 0:e.id)!==(null==(t=this.activeConfig)?void 0:t.id)){var i,n;if(this.activeTrack)null!=(i=null==(n=this.activeTrack.activeCues)?void 0:n.length)&&i&&this.emitCueEvent(),this.activeTrack.mode="disabled",this.activeTrack.oncuechange=null,this.activeTrack=void 0,this.activeConfig=void 0;if(e){var a=this.getTextTrack(e);a&&(this.activeTrack=a,this.activeConfig=e,a.oncuechange=()=>this.emitCueEvent(this.activeTrack),a.mode=this.nativeDisplayEnabled?"showing":"hidden")}this.emitSubtitleChange()}}getTextTrack(e){if(this.element){var t,i,n=this.element.textTracks;if(n.getTrackById)t=n.getTrackById(e.id);else t=null==(i=this.element.querySelector("#"+e.id))?void 0:i.track;if(t)return t;for(var a=0;a<n.length;++a){var r=n[a];if("subtitles"===r.kind&&r.label===e.label&&r.language===e.language){t=r;break}}return t||void 0}}emitSubtitleChange(){var e;this.eventEmitter.emit(v.SubtitlesChange,{active:!1===(null==(e=this.activeConfig)?void 0:e.forced)?this.activeConfig:void 0,nativeDisplayEnabled:this.nativeDisplayEnabled})}emitCueEvent(e){var t;this.eventEmitter.emit(v.SubtitlesCueUpdate,{activeCues:Array.from(null!=(t=null==e?void 0:e.activeCues)?t:[])})}}class xc extends Error{constructor(e){super(e),Object.setPrototypeOf(this,xc.prototype),this.name="AutoplayError"}}class Dc{constructor(e){this.textTrack=void 0,this.data={},this.eventEmitter=new S,this.idCounter=0,this.onCueEnter=void 0,this.onCueExit=void 0,this.textTrack=e.addTextTrack("metadata"),this.onCueEnter=this.cueEventHandler.bind(this,"enter"),this.onCueExit=this.cueEventHandler.bind(this,"exit")}addRange(e){var t=!(arguments.length<=1)&&arguments.length-1?arguments.length<=1?void 0:arguments[1]:void 0,i=this.generateId();this.data[i]=t;var n=this.createTextTackCue(i,e.start,e.end);return n.addEventListener("enter",this.onCueEnter),n.addEventListener("exit",this.onCueExit),this.textTrack.addCue(n),this.createExtendedTimeRange(i,e.start,e.end)}getAllRanges(){var e;return Array.from(null!=(e=this.textTrack.cues)?e:[]).map((e=>this.createExtendedTimeRange(e.id,e.startTime,e.endTime)))}getActiveRanges(){var e;return Array.from(null!=(e=this.textTrack.activeCues)?e:[]).map((e=>this.createExtendedTimeRange(e.id,e.startTime,e.endTime)))}removeRange(e){var t,i="string"==typeof e?e:e.id,n=null==(t=this.textTrack.cues)?void 0:t.getCueById(i);n&&(delete this.data[i],n.removeEventListener("enter",this.onCueEnter),n.removeEventListener("exit",this.onCueExit),this.textTrack.removeCue(n)),this.removeAllListeners(i)}removeAllRanges(){for(;null!=(e=this.textTrack.cues)&&e.length;){var e,t=this.textTrack.cues[0];this.textTrack.removeCue(t),delete this.data[t.id]}}on(e,t,i){this.eventEmitter.on(this.getEventId("*",e),t,i)}once(e,t,i){this.eventEmitter.once(this.getEventId("*",e),t,i)}off(e,t,i){this.eventEmitter.off(this.getEventId("*",e),t,i)}removeAllListeners(e){this.eventEmitter.removeAllListeners(this.getEventId(null!=e?e:"*","enter")),this.eventEmitter.removeAllListeners(this.getEventId(null!=e?e:"*","exit"))}destroy(){this.eventEmitter.removeAllListeners(),this.removeAllRanges(),this.textTrack.mode="disabled"}createExtendedTimeRange(e,t,i){return{id:e,start:t,end:i,data:this.data[e],on:(t,i,n)=>{this.eventEmitter.on(this.getEventId(e,t),i,n)},once:(t,i,n)=>{this.eventEmitter.once(this.getEventId(e,t),i,n)},off:(t,i,n)=>{this.eventEmitter.off(this.getEventId(e,t),i,n)},removeAllListeners:()=>{this.removeAllListeners(e)}}}createTextTackCue(e,t,i){var n=new("VTTCue"in window?VTTCue:TextTrackCue)(t,i,e);return n.id=e,n}cueEventHandler(e,t){var i=t.target,n=Object.freeze({type:e,range:this.createExtendedTimeRange(i.id,i.startTime,i.endTime)});this.eventEmitter.emit(this.getEventId(i.id,e),n),this.eventEmitter.emit(this.getEventId("*",e),n)}generateId(){return"tr:"+this.idCounter++}getEventId(e,t){return e+":"+t}}var Lc,_c=I("HTML5AdapterBase");!function(e){e.Play="play",e.Playing="playing",e.TimeUpdate="timeupdate",e.Pause="pause",e.Seeking="seeking",e.Seeked="seeked",e.Ended="ended",e.Waiting="waiting",e.Stalled="stalled"}(Lc||(Lc={}));class Mc{constructor(e,t,i,n){void 0===n&&(n={}),this.destroyController=new AbortController,this.element=void 0,this.eventEmitter=void 0,this.stateMachine=void 0,this.mediaInfo=void 0,this.mediaInfoReady=void 0,this.initialPlaybackState=void 0,this.subtitleControls=void 0,this.fatalError=void 0,this.preloading=void 0,this.allowPlaybackAttempt=void 0,this.incomingPause=void 0,this.incomingUnmute=void 0,this.lastTimeUpdate=void 0,this.lastTimeUpdateBeforeJump=void 0,this.lastPlayingIndicationTime=void 0,this.lastMediaRange=void 0,this.previouslyMuted=void 0,this.previousVolume=void 0,this.seekTarget=void 0,this.element=e,this.eventEmitter=t,this.mediaInfo=i,this.mediaInfoReady=!1,this.initialPlaybackState=n,this.previouslyMuted=this.isMuted(),this.previousVolume=this.getVolume(),this.stateMachine=wc(t,{getError:this.getError.bind(this),getStartTime:()=>{var e,t=null!=(e=this.lastPlayingIndicationTime)?e:this.getCurrentTime();return this.lastPlayingIndicationTime=void 0,t},getStopTime:()=>{var e,t=null!=(e=this.lastTimeUpdateBeforeJump)?e:this.getCurrentTime();return this.lastTimeUpdateBeforeJump=void 0,t}})}getMediaInfo(){return this.mediaInfo}async preload(e){return this.preloading?_c.log("Preload already initiated."):(_c.log("Preloading."),this.preloading=this.internalPreload(e).then((()=>{_c.log("Preload done."),this.mediaInfoReady=!0,this.eventEmitter.emit(v.MediaInfoLoaded,this.mediaInfo)})).catch((e=>{if(e instanceof k)this.fatalError=e;else{var t=L(e,"Failed to preload"),i="NetworkError"===t.name?b.NO_PLAYBACK_NETWORK_ERROR:"DecodeError"===t.name?b.NO_PLAYBACK_DECODE_ERROR:b.UNKNOWN_ERROR;this.fatalError=new k(i,t,t.name)}_c.error("Preloading failed:",this.fatalError,this.fatalError.cause),this.stateMachine.go(pc.Broken)}))),this.preloading}async startPlaying(){if(this.stateMachine.go(pc.Starting),await this.preload(),this.stateMachine.is(pc.Broken))return Promise.reject(this.fatalError);try{await this.internalStartPlaying()}catch(t){var e=L(t);return"AutoplayError"===e.name?this.stateMachine.go(pc.AutoplayBlocked):(this.fatalError=new k(b.UNKNOWN_ERROR,e,e.name),this.stateMachine.go(pc.Broken)),Promise.reject(t)}}async internalStartPlaying(){if(this.stateMachine.is(pc.Paused))_c.log("Playback attempt stopped.");else if(this.element.paused){_c.log("Attempting play");try{await this.elementPlay()}catch(e){throw U(e)?new xc(e.name+": "+e.message):new xc(""+e)}}else _c.log("Play already called when processing playback attempt.")}async elementPlay(){if(!this.allowPlaybackAttempt)if(!1!==this.allowPlaybackAttempt){this.allowPlaybackAttempt=!0;try{await Promise.resolve(this.element.play()),!1===this.allowPlaybackAttempt&&(this.incomingPause=Date.now(),this.element.pause())}finally{this.allowPlaybackAttempt=void 0}}else this.allowPlaybackAttempt=!0}createTimeRangeEventTrack(){return new Dc(this.element)}async destroy(){this.element&&(await new Promise((e=>{this.getState()===D.Playing?(this.stateMachine.on(pc.Paused,(()=>e())),this.stateMachine.on(pc.Ended,(()=>e())),this.stateMachine.on(pc.Broken,(()=>e())),this.stateMachine.on(pc.AutoplayBlocked,(()=>e())),this.pause()):e()})),this.internalDestroy())}internalDestroy(){for(this.destroyController.abort(),this.subtitleControls&&this.subtitleControls.destroy(),this.element.hasAttribute("src")&&this.element.removeAttribute("src");this.element.firstChild;)this.element.removeChild(this.element.firstChild);this.element.load()}endOfMediaReached(){return!(this.isLiveStream()&&!this.isLiveStreamEnded())&&this.getCurrentTime()>=this.getMediaRange().end}async play(){if(this.stateMachine.is(pc.Idle))return await this.startPlaying();if(this.stateMachine.is(pc.Paused)||this.stateMachine.is(pc.PausedSeeking)||this.stateMachine.is(pc.AutoplayBlocked)||this.stateMachine.is(pc.Ended)){var e=Il([Rl(this.element,Lc.Playing,(()=>e.abort())),Rl(this.element,Lc.Pause,(()=>e.abort())),setTimeout((()=>{e.abort(),_c.log("Still waiting for playback (1)."),this.stateMachine.go(pc.Rebuffering)}),1e3)],this.destroyController.signal);return await this.elementPlay()}}pause(){this.allowPlaybackAttempt?(this.allowPlaybackAttempt=!1,_c.log("Pause: Will pause right after play.")):this.element.paused?this.stateMachine.is(pc.Starting)&&(this.stateMachine.go(pc.Paused),_c.log("Pause: Will not call play.")):(this.incomingPause=Date.now(),this.element.pause())}getState(){return Tc(this.stateMachine.currentState).playbackState}getWaitingReason(){return Tc(this.stateMachine.currentState).waitingReason}getPausedReason(){return Tc(this.stateMachine.currentState).pausedReason}getError(){return this.fatalError}isLiveStream(){var e;if(!this.mediaInfoReady)return!1;var t=null==(e=this.mediaInfo.segmentListInfo)?void 0:e.type;return t===B.Live||t===B.Event}isLiveStreamEnded(){var e;return!!this.mediaInfoReady&&!0===(null==(e=this.mediaInfo.segmentListInfo)?void 0:e.endListPresent)}isSeekable(){var e=this.getMediaRange();return e.end-e.start>0}seekTo(e){var t=yu(this.getSeekableRange(),e);this.seekTarget=t,this.element.currentTime=t}seekToRelativeTime(e){this.seekTo(this.getCurrentTime()+e)}getCurrentTime(){return void 0!==this.seekTarget?this.seekTarget:this.element.currentTime}getScrubberValues(){var e=this.getScrubberRange(),t=this.getCurrentTime();return{startPosition:e.start,startDisplayTime:e.start,endPosition:e.end,endDisplayTime:e.end,playheadPosition:t,playheadDisplayTime:t}}setPlaybackRate(e){this.element.playbackRate=e}getPlaybackRate(){return this.element.playbackRate}resetPlaybackRate(){this.element.playbackRate=this.element.defaultPlaybackRate}mute(){this.element.muted=!0}unmute(){this.element.muted=!1}isMuted(){return this.element.muted}setVolume(e){this.element.volume=e}getVolume(){return this.element.volume}getMediaRange(){var e=this.getRawSeekableRange();return 0!==e.end&&Number.isFinite(e.end)?e:{start:0,end:0}}getScrubberRange(){return this.getMediaRange()}getSeekableRange(){return this.getMediaRange()}getRawSeekableRange(){var e=mu(this.element.seekable);return e.length>0?e[0]:{start:0,end:0}}getRawDuration(){return this.element.duration}getBufferedRanges(){return mu(this.element.buffered)}getPlayedRanges(){return mu(this.element.played)}async addSubtitlesTrack(e,t,i,n){var a;this.subtitleControls&&this.subtitleControls.supportsAddingTracks()||(this.subtitleControls?(_c.log("Changing from media provided subtitles to sideloaded subtitles."),a=this.subtitleControls.isNativeSubtitlesDisplayEnabled(),this.subtitleControls.destroy()):_c.log("Creating controls for sideloaded subtitles."),this.subtitleControls=new Ac(this.element,this.eventEmitter),void 0!==a&&(a?this.subtitleControls.enableNativeSubtitlesDisplay():this.subtitleControls.disableNativeSubtitlesDisplay()));return this.subtitleControls.addSubtitlesTrack(e,t,i,n)}setNoSubtitles(){var e;null==(e=this.subtitleControls)||e.setNoSubtitles()}setDefaultSubtitles(){var e;null==(e=this.subtitleControls)||e.setDefaultSubtitles()}setAutoSubtitles(){var e;null==(e=this.subtitleControls)||e.setAutoSubtitles()}setActiveSubtitles(e){var t;null==(t=this.subtitleControls)||t.setActiveSubtitles(e)}getActiveSubtitles(){var e;return null==(e=this.subtitleControls)?void 0:e.getActiveSubtitles()}getAvailableSubtitles(){var e,t;return null!=(e=null==(t=this.subtitleControls)?void 0:t.getAvailableSubtitles())?e:[]}enableNativeSubtitlesDisplay(){var e;null==(e=this.subtitleControls)||e.enableNativeSubtitlesDisplay()}disableNativeSubtitlesDisplay(){var e;null==(e=this.subtitleControls)||e.disableNativeSubtitlesDisplay()}isNativeSubtitlesDisplayEnabled(){var e,t;return null!=(e=null==(t=this.subtitleControls)?void 0:t.isNativeSubtitlesDisplayEnabled())&&e}attachPlaybackEvents(){var e=new AbortController;wl(this.destroyController.signal,e);var t=!1,i=!1,n={playing:()=>{this.lastPlayingIndicationTime=this.getCurrentTime()},seeking:()=>{t=!0},seeked:()=>{t=!1,this.lastTimeUpdate=void 0,this.lastPlayingIndicationTime=this.lastTimeUpdateBeforeJump=this.getCurrentTime()},timeupdate:()=>{var e,i,n=this.getCurrentTime();if(void 0!==this.seekTarget&&!t){var r=this.element.currentTime;(r>=this.seekTarget||r<this.seekTarget-1)&&(this.seekTarget=void 0,n=r,_c.log("Seek target cleared."))}n!==this.lastTimeUpdate?(this.lastTimeUpdate=n,(void 0===this.lastTimeUpdateBeforeJump||Math.abs(n-this.lastTimeUpdateBeforeJump)<1)&&(this.lastTimeUpdateBeforeJump=n),null==(e=(i=a[this.stateMachine.currentState])[Lc.TimeUpdate])||e.call(i),this.eventEmitter.emit(v.TimeUpdate,n)):_c.debug("Ignoring repeated time update: "+n+".")},ended:()=>{this.isLiveStream()&&!this.isLiveStreamEnded()&&(_c.log("Live stream ended without endlist being detected."),this.mediaInfo.segmentListInfo.endListPresent=!0,this.eventEmitter.emit(v.LiveStreamEnded,this.getMediaRange())),this.stateMachine.go(pc.Ended)}},a={[pc.Idle]:{play:()=>{this.startPlaying().catch(_c.warn.bind(_c))}},[pc.Starting]:{pause:()=>{var e=Date.now(),t=void 0!==this.incomingPause&&e-this.incomingPause<500,i=void 0!==this.incomingUnmute&&e-this.incomingUnmute<100;void 0!==this.incomingPause?(_c.metric("pause-call-to-event-delay-starting",e-this.incomingPause),this.incomingPause=void 0):void 0!==this.incomingUnmute&&(_c.metric("unmute-event-to-pause-event-starting",e-this.incomingUnmute),this.incomingUnmute=void 0),t?this.stateMachine.go(pc.Paused):i&&this.stateMachine.go(pc.AutoplayBlocked)},playing:()=>{Il(Rl(this.element,Lc.TimeUpdate,(()=>{!t&&this.element.currentTime>0&&(_c.log("Got first non-zero time update after playing event:",this.element.currentTime),this.stateMachine.go(pc.Playing))})),e.signal)}},[pc.Playing]:{enter:()=>{var t=Il([Rl(this.element,Lc.TimeUpdate,(()=>t.abort())),setTimeout((()=>{t.abort(),this.fatalError?(_c.log("Missing time update with fatal error. Changing to broken."),this.stateMachine.go(pc.Broken)):this.stateMachine.go(pc.Rebuffering)}),2e3)],e.signal)},timeupdate:()=>{var t=this.getCurrentTime(),i=Il([Rl(this.element,Lc.TimeUpdate,(()=>{t!==this.getCurrentTime()&&i.abort()})),setTimeout((()=>{this.fatalError?(_c.log("Missing time update with fatal error. Changing to broken."),this.stateMachine.go(pc.Broken)):this.stateMachine.go(pc.Rebuffering)}),1e3)],e.signal)},waiting:()=>{if(this.fatalError)_c.log("Waiting with fatal error. Changing to broken."),this.stateMachine.go(pc.Broken);else var t=Il([Rl(this.element,Lc.Seeking,(()=>t.abort())),Rl(this.element,Lc.TimeUpdate,(()=>t.abort())),setTimeout((()=>this.stateMachine.go(pc.Rebuffering)),500)],e.signal)},stalled:()=>{this.fatalError&&(_c.log("Stalled with fatal error. Changing to broken."),this.stateMachine.go(pc.Broken))},pause:()=>{var t=Date.now(),i=void 0!==this.incomingPause&&t-this.incomingPause<500,n=void 0!==this.incomingUnmute&&t-this.incomingUnmute<100;if(void 0!==this.incomingPause?(_c.metric("pause-call-to-event-delay-playing",t-this.incomingPause),this.incomingPause=void 0):void 0!==this.incomingUnmute&&(_c.metric("unmute-event-to-pause-event-playing",t-this.incomingUnmute),this.incomingUnmute=void 0),n&&!i)this.stateMachine.go(pc.AutoplayBlocked);else if(this.endOfMediaReached())this.stateMachine.go(pc.Ended);else if(i)this.stateMachine.go(pc.Paused);else var a=Il([Rl(this.element,Lc.Seeking,(()=>a.abort())),Rl(this.element,Lc.Playing,(()=>a.abort())),Rl(this.element,Lc.Play,(()=>{this.stateMachine.go(pc.Rebuffering)})),setTimeout((()=>{a.abort(),_c.log("Unexpected pause event. Not caused by call to pause, autoplay policy or seeking."),this.stateMachine.go(pc.Paused)}),100)],e.signal)},seeking:()=>{this.isTechnicalSeek()||this.stateMachine.go(pc.Seeking)}},[pc.Paused]:{play:()=>{var t=Il([Rl(this.element,Lc.Playing,(()=>t.abort())),Rl(this.element,Lc.Pause,(()=>t.abort())),setTimeout((()=>{t.abort(),_c.log("Still waiting for playback (2)."),this.stateMachine.go(pc.Rebuffering)}),500)],e.signal)},playing:()=>{this.stateMachine.go(pc.Playing)},seeking:()=>{i=!1,this.stateMachine.go(pc.PausedSeeking)}},[pc.AutoplayBlocked]:{play:()=>{var t=Il([Rl(this.element,Lc.Playing,(()=>t.abort())),Rl(this.element,Lc.Pause,(()=>t.abort())),setTimeout((()=>{t.abort(),_c.log("Still waiting for playback (3)."),this.stateMachine.go(pc.Rebuffering)}),500)],e.signal)},playing:()=>{this.stateMachine.go(pc.Playing)},seeking:()=>{i=!0,this.stateMachine.go(pc.PausedSeeking)}},[pc.PausedSeeking]:{play:()=>{this.stateMachine.go(pc.Seeking)},playing:()=>{this.stateMachine.go(pc.Seeking)},seeked:()=>{i?this.stateMachine.go(pc.AutoplayBlocked):this.stateMachine.go(pc.Paused)}},[pc.Ended]:{seeking:()=>{i=!1,this.stateMachine.go(pc.PausedSeeking)}},[pc.Rebuffering]:{timeupdate:()=>{this.stateMachine.go(pc.Playing)},seeking:()=>{this.isTechnicalSeek()||this.stateMachine.go(pc.Seeking)},pause:()=>{this.endOfMediaReached()?this.stateMachine.go(pc.Ended):this.stateMachine.go(pc.Paused),this.incomingPause=void 0}},[pc.Seeking]:{pause:()=>{this.endOfMediaReached()?this.stateMachine.go(pc.Ended):this.stateMachine.go(pc.Paused),this.incomingPause=void 0},timeupdate:()=>{t||this.stateMachine.go(pc.Playing)}},[pc.Broken]:{}},r=this.stateMachine.onTransition;this.stateMachine.onTransition=(t,i)=>{var n,s,o,l;e.abort(),e=new AbortController,wl(this.destroyController.signal,e),null==(n=(s=a[t]).exit)||n.call(s),null==(o=(l=a[i]).enter)||o.call(l),r(t,i)};var s=e=>{var t,i,r,s;e===Lc.TimeUpdate?null==(t=n[e])||t.call(n):(_c.debug("Got "+e+" event."),null==(i=n[e])||i.call(n),null==(r=(s=a[this.stateMachine.currentState])[e])||r.call(s))};Il(Object.values(Lc).map((e=>Rl(this.element,e,s.bind(this,e)))),this.destroyController.signal)}isTechnicalSeek(){return!1}handleRateChangeEvent(){this.eventEmitter.emit(v.RateChange,this.getPlaybackRate())}handleVolumeChangeEvent(){var e=this.isMuted(),t=this.getVolume();this.previouslyMuted!==e&&(this.incomingUnmute=e?void 0:Date.now(),this.previouslyMuted=e,this.eventEmitter.emit(v.MutedChange,e)),this.previousVolume!==t&&(this.previousVolume=t,this.eventEmitter.emit(v.VolumeChange,t))}handleDurationChangeEvent(){this.handleMediaRangeChange(this.getMediaRange())}handleMediaRangeChange(e){if(0===e.end){var t=this.getRawSeekableRange();if(0===t.end||Number.isNaN(t.end))return void _c.log("Blocking media range change event of [0, 0] because the raw end value is expected to be temporary:",t);_c.log("Allowing media range change event of [0, 0] because the raw end value is expected to be permanent:",t)}if(this.lastMediaRange&&this.lastMediaRange.start===e.start&&this.lastMediaRange.end===e.end)_c.debug("Ignoring repeated media range change event.");else if(this.lastMediaRange=e,this.preloading){var i=Date.now();this.preloading.catch((()=>{throw new Error("skip")})).then((()=>{var t=Date.now()-i;t>10&&_c.log("MediaRangeChange event held for "+t+" ms."),_c.debug("Media range change:",e),this.eventEmitter.emit(v.MediaRangeChange,e)})).catch((e=>{"skip"!==L(e).message&&_c.error("Media range change event error:",e)}))}}handleErrorEvent(e){var t=null!=e?e:this.element.error;if(t){var i=function(e,t){var{playbackStarted:i}=t,n=Cc[e.code],a=!0,r=b.UNKNOWN_ERROR;switch(e.code){case 1:a=!1;break;case 2:r=i?b.PLAYBACK_STOPPED_NETWORK_ERROR:b.NO_PLAYBACK_NETWORK_ERROR;break;case 3:r=i?b.PLAYBACK_STOPPED_DECODE_ERROR:b.NO_PLAYBACK_DECODE_ERROR;break;case 4:r=b.UNSUPPORTED_FORMAT_ERROR}return new k(r,e,n,a)}(t,{playbackStarted:this.stateMachine.is(pc.Idle)||this.stateMachine.is(pc.Starting)});i.fatal?(_c.log("Got fatal error:",i,i.cause),this.fatalError=i,this.stateMachine.is(pc.Idle)||this.stateMachine.is(pc.Starting)||this.stateMachine.is(pc.Rebuffering)||this.stateMachine.is(pc.Seeking)?(_c.log("Time is not running. Changing to broken."),this.stateMachine.go(pc.Broken)):_c.log("Saving fatal error for later when time stops.")):_c.log("Got non-fatal error:",i,i.cause)}else _c.log("Ignoring error event without error data.")}attachValueChangeEvents(){Il([Rl(this.element,"ratechange",this.handleRateChangeEvent.bind(this)),Rl(this.element,"volumechange",this.handleVolumeChangeEvent.bind(this))],this.destroyController.signal)}attachDurationChangeEvents(){Il([Rl(this.element,"durationchange",this.handleDurationChangeEvent.bind(this)),Rl(this.element,"stalled",this.handleDurationChangeEvent.bind(this))],this.destroyController.signal)}attachErrorEvents(){Il(Rl(this.element,"error",(()=>this.handleErrorEvent())),this.destroyController.signal)}fakeMediaErrorNetwork(){this.fakeMediaError(2)}fakeMediaErrorDecode(){this.fakeMediaError(3)}fakeMediaError(e){if(e in Cc){var t=n({code:e,message:"Fake "+Cc[e]},Cc);if(this.handleErrorEvent(t),!this.stateMachine.is(pc.Broken)){var i=this.getCurrentTime();this.getCurrentTime=()=>i,setTimeout((()=>this.element.pause()),1e4)}}else console.log("Supported error codes: "+Object.values(Cc))}}var Nc,Oc=I("HlsJsBuiltinSubtitles");class Uc{constructor(e,t,i){this.hlsClass=void 0,this.hls=void 0,this.eventEmitter=void 0,this.activeTrack=void 0,this.destroyController=void 0,this.muteTrackSwitchEvent=!1,this.hlsClass=e,this.hls=t,this.eventEmitter=i,this.destroyController=new AbortController;var n=this.handleHlsJsTrackSwitch.bind(this);this.hls.on(this.hlsClass.Events.SUBTITLE_TRACK_SWITCH,n),Il((()=>this.hls.off(this.hlsClass.Events.SUBTITLE_TRACK_SWITCH,n)),this.destroyController.signal)}supportsAddingTracks(){return!1}addSubtitlesTrack(){throw new Error("Not supported.")}setNoSubtitles(){var e=this.getForcedTrack();this.hls.subtitleTrack=e?e.id:-1}setDefaultSubtitles(){var e=this.getDefaultTrack();e?this.hls.subtitleTrack=e.id:this.setNoSubtitles()}setAutoSubtitles(){var e=this.getDefaultTrack();if(e)this.hls.subtitleTrack=e.id;else{var t=this.getAutoselectTrack();t?this.hls.subtitleTrack=t.id:this.setNoSubtitles()}}setActiveSubtitles(e){var t=Number.parseInt("object"==typeof e?e.id:e,10);this.getAllTracks().find((e=>e.id===t&&!e.forced))&&(this.hls.subtitleTrack=t)}getActiveSubtitles(){var e=this.hls.subtitleTrack;if(-1!==e){var t=this.getAllTracks().find((t=>t.id===e&&!t.forced));return t?Bc(t):void 0}}getAvailableSubtitles(){return this.getAllTracks().filter((e=>!e.forced)).map(Bc)}enableNativeSubtitlesDisplay(){this.hls.subtitleDisplay||(this.hls.subtitleDisplay=!0,this.updateCurrentTrackMode(),this.emitSubtitlesChange())}disableNativeSubtitlesDisplay(){this.hls.subtitleDisplay&&(this.hls.subtitleDisplay=!1,this.updateCurrentTrackMode(),this.emitSubtitlesChange())}isNativeSubtitlesDisplayEnabled(){return this.hls.subtitleDisplay}destroy(){this.destroyController.abort(),this.hls.subtitleTrack=-1,Fc(this.hls)}getDefaultTrack(){return this.getBestLanguageMatch(this.getAllTracks().filter((e=>e.default&&!e.forced)))}getAutoselectTrack(){return this.getBestLanguageMatch(this.getAllTracks().filter((e=>(e.autoselect||e.default)&&!e.forced)))}getForcedTrack(){return this.getBestLanguageMatch(this.getAllTracks().filter((e=>e.forced)))}getBestLanguageMatch(e){if(0!==e.length)return Ec(e,(e=>{var t;return null!=(t=e.lang)?t:"unknown"}),Sc(kc()))[0]}getAllTracks(){return this.hls.subtitleTracks}updateCurrentTrackMode(){var e=this.hls.subtitleTrack;-1!==e&&(this.muteTrackSwitchEvent=!0,this.hls.subtitleTrack=-1,this.hls.subtitleTrack=e,this.muteTrackSwitchEvent=!1)}handleHlsJsTrackSwitch(e,t){this.muteTrackSwitchEvent||(void 0!==this.activeTrack&&(this.activeTrack.oncuechange=null,this.emitCueEvent(),this.activeTrack=void 0),-1!==t.id&&(this.activeTrack=this.findActiveHlsJsTextTrack(t),void 0!==this.activeTrack?this.activeTrack.oncuechange=this.emitCueEvent.bind(this,this.activeTrack):Oc.error("Unable to find the text track matching:",t)),this.emitSubtitlesChange())}findActiveHlsJsTextTrack(e){var t,i;return Array.from(null!=(t=null==(i=this.hls.media)?void 0:i.textTracks)?t:[]).find((t=>"subtitles"===t.kind&&"disabled"!==t.mode&&t.label===e.name&&(!e.groupId||t.groupId===e.groupId)))}emitSubtitlesChange(){this.eventEmitter.emit(v.SubtitlesChange,{active:this.getActiveSubtitles(),nativeDisplayEnabled:this.hls.subtitleDisplay})}emitCueEvent(e){var t;this.eventEmitter.emit(v.SubtitlesCueUpdate,{activeCues:Array.from(null!=(t=null==e?void 0:e.activeCues)?t:[])})}}function Bc(e){var t;return{id:""+e.id,label:e.name,language:null!=(t=e.lang)?t:"unknown"}}function Fc(e){var t=e.subtitleTrackController;Oc.log("Disabling hls.js text track controller"),t.onMediaDetaching()}class Vc{constructor(e){var t,i;this.url=void 0,this.type=void 0,this.details=void 0,this.reason=void 0,this.fatal=void 0,this.response=void 0,this.context=void 0,this.url=e.url,this.type=e.type,this.details=e.details,this.reason=e.reason,this.fatal=e.fatal;var{text:n,code:a}=null!=(t=e.response)?t:{},{level:r,url:s,type:o}=null!=(i=e.context)?i:{};this.response={text:n,code:a},this.context={level:null!==r?r:void 0,url:s,type:o}}}function Wc(e,t){void 0===t&&(t=0);var i=10**t;return Math.round(e*i)/i}var Hc={id:"HlsJs",name:"Hls.js adapter",tech:"hls.js",version:"library not loaded"},jc=I("HlsJsAdapter"),qc=(e=>{})(Nc=class extends Mc{constructor(e,t,i,n,a,r,s){super(e,t,{src:n,mediaType:a,isAudioOnly:!1},r),this.qualityTracker=void 0,this.config=void 0,this.hls=void 0,this.startLoadCalled=void 0,this.startTime=void 0,this.firstSegmentOffset=void 0,this.incomingAutoSeek=void 0,this.qualityTracker=i,this.config=null==s?void 0:s.hlsJsAdapter,this.firstSegmentOffset=0,this.attachErrorEvents(),this.attachValueChangeEvents(),this.attachDurationChangeEvents(),this.attachPlaybackEvents(),this.applyInitialPlaybackState(r)}static canPlayType(e){return F(e)}static getAdapterInfo(){return Hc}getAdapterInfo(){var e=n({},this.config,{loadHlsJs:void 0});return delete e.loadHlsJs,n({},Hc,{config:e})}async internalPreload(e){var t;if(null==(t=this.config)||!t.loadHlsJs)throw new Error("Unable to load hls.js. No loadHlsJs() method provided.");var i=this.config.loadHlsJs().then((e=>"function"==typeof e?e:e.default)).then((e=>(Hc.version=e.version,this.preloadHlsJs(e).then((t=>{this.hls=t,this.attachHlsEvents(e,t)}))))),n=mc(this.mediaInfo.src).then((e=>e.levels[0].url)).then((e=>bc(e))).then((e=>{this.mediaInfo.segmentListInfo={averageSegmentDuration:e.averageSegmentDuration,endListPresent:e.fixedEnd,type:e.fixedEnd?B.OnDemand:e.fixedStart?B.Event:B.Live,segmentListDuration:e.playlistDuration,programDateTimeAtPosZero:void 0!==e.programDateTime?e.programDateTime.getTime()/1e3:void 0}}));await Promise.all([i,n]),!1!==(null==e?void 0:e.loadData)&&this.startLoad()}async preloadHlsJs(e){return new Promise(((t,i)=>{var a,r,s,o,l=new e({autoStartLoad:!1,capLevelToPlayerSize:null==(a=null==(r=this.config)?void 0:r.limitQualityToPlayerSize)||a,debug:null==(s=this.config)?void 0:s.debugHlsJs,enableWorker:!(null!=(o=this.config)&&o.disableWebWorker)}),u=(t,n)=>{var a=Gc(n,e,{playbackStarted:!1});a.fatal?(l.destroy(),i(a)):jc.log("Got non-fatal error:",a,a.cause)};l.on(e.Events.ERROR,u),l.on(e.Events.MEDIA_ATTACHED,(()=>{jc.log("Media attached, loading source."),l.loadSource(this.mediaInfo.src)})),l.once(e.Events.MANIFEST_PARSED,((i,a)=>{jc.log("Manifest parsed.");var r=!!a.audio&&!a.video;this.mediaInfo.isAudioOnly=r,this.mediaInfo.qualities=a.levels.map(((e,t)=>{var{bitrate:i,width:n,height:a,attrs:s}=e;return{level:t,bitrate:i,averageBitrate:s["AVERAGE-BANDWIDTH"]?Number.parseInt(s["AVERAGE-BANDWIDTH"],10):void 0,frameRate:void 0!==s["FRAME-RATE"]?parseFloat(s["FRAME-RATE"]):void 0,width:r?void 0:n,height:r?void 0:a}})),this.mediaInfo.firstQuality=n({},this.mediaInfo.qualities[a.firstLevel]),this.qualityTracker.setAvailableQualities(this.mediaInfo.qualities);var s=this.mediaInfo.qualities.find((e=>e.width&&e.height));s&&(this.mediaInfo.orientation=N(s.width,s.height)),l.off(e.Events.ERROR,u),t(l)})),l.once(e.Events.SUBTITLE_TRACKS_UPDATED,(()=>{!this.subtitleControls&&l.subtitleTracks.length>0?(jc.log("Creating controls for media provided subtitles:",l.subtitleTracks.map((e=>e.name)).join(", ")),this.subtitleControls=new Uc(e,l,this.eventEmitter),this.subtitleControls.setDefaultSubtitles()):Fc(l)})),l.attachMedia(this.element)}))}async internalStartPlaying(){return this.startLoad(),super.internalStartPlaying()}internalDestroy(){super.internalDestroy(),this.hls&&(this.hls.destroy(),delete this.hls)}isTechnicalSeek(){if(this.incomingAutoSeek){if(Date.now()-this.incomingAutoSeek<50)return jc.log("Seeking event associated with buffer management. Not changing state."),!0;this.incomingAutoSeek=void 0}return!1}getMediaRange(){var e,t=super.getMediaRange();return{start:(null==(e=this.mediaInfo.segmentListInfo)?void 0:e.type)===B.Live?Wc(this.firstSegmentOffset,1):0,end:Wc(t.end,1)}}applyInitialPlaybackState(e){void 0===e&&(e={});var{playbackRate:t,mute:i,volume:n,startTime:a}=e;void 0!==a&&(this.startTime=a),void 0!==t&&this.setPlaybackRate(t),void 0!==i&&(i?this.mute():this.unmute()),void 0!==n&&this.setVolume(n)}startLoad(){if(this.hls&&!this.startLoadCalled){var e;this.startLoadCalled=!0,jc.log("Start load.");var t=void 0!==this.startTime&&(null==(e=this.mediaInfo.segmentListInfo)?void 0:e.type)!==B.Live?this.startTime:-1;this.hls.startLoad(t)}}getProgramDateTimeAtPosZero(e){if(0!==e.fragments.length){var t=e.fragments[0].programDateTime,i=e.fragments[0].start;return t?t/1e3-i:void 0}jc.log("No segments to get program date/time from.")}attachHlsEvents(e,t){var i;if(t.once(e.Events.LEVEL_UPDATED,((e,t)=>{var i=this.mediaInfo.segmentListInfo;i&&(i.averageSegmentDuration=Math.round(t.details.averagetargetduration||t.details.targetduration),i.type!==B.Live&&i.type!==B.Event||(i.programDateTimeAtPosZero=this.getProgramDateTimeAtPosZero(t.details)))})),t.on(e.Events.LEVEL_UPDATED,((e,t)=>{t.details.totalduration>0&&(this.firstSegmentOffset=t.details.fragments[0].start);var i=this.mediaInfo.segmentListInfo;i&&(i.segmentListDuration=Wc(t.details.totalduration,1),i.endListPresent===t.details.live&&(i.endListPresent=!0,this.eventEmitter.emit(v.LiveStreamEnded,this.getMediaRange())))})),null!=(i=this.config)&&i.immediateQualityJumps){var n=!1;t.on(e.Events.LEVEL_SWITCHING,((e,i)=>{if(-1!==t.currentLevel)if(n)n=!1;else{var a=t.levels[t.currentLevel].width,r=i.width;jc.debug("Level switching. Video width changes from "+a+" -> "+r+"."),r>a&&(a<=0||r/a>=2)&&(jc.log("Switching level immediately!"),n=!0,t.currentLevel=i.level,t.currentLevel=-1)}}))}t.on(e.Events.LEVEL_SWITCHED,((e,t)=>{this.qualityTracker.setCurrentQualityByLevel(t.level)})),t.on(e.Events.ERROR,((t,i)=>{if(i.details===e.ErrorDetails.BUFFER_NUDGE_ON_STALL)return this.incomingAutoSeek=Date.now(),void jc.log("Incoming buffer nudge.");if(i.details===e.ErrorDetails.BUFFER_SEEK_OVER_HOLE)return this.incomingAutoSeek=Date.now(),void jc.log("Incoming seek over hole.");var n=!(this.stateMachine.is(pc.Idle)||this.stateMachine.is(pc.Starting)),a=Gc(i,e,{playbackStarted:n});a.fatal?(jc.error("Got fatal Hls error:",a,a.cause),this.fatalError=a,this.stateMachine.is(pc.Idle)||this.stateMachine.is(pc.Starting)||this.stateMachine.is(pc.Rebuffering)||this.stateMachine.is(pc.Seeking)?(jc.log("Time is not running. Changing to broken."),this.stateMachine.go(pc.Broken)):jc.log("Saving fatal error for later when time stops.")):jc.log("Got non-fatal Hls error:",a,a.cause)}))}})||Nc;function Gc(e,t,i){var{playbackStarted:n}=i,a=e.fatal,r=b.UNKNOWN_ERROR;switch(e.details){case t.ErrorDetails.FRAG_LOAD_ERROR:case t.ErrorDetails.FRAG_LOAD_TIMEOUT:case t.ErrorDetails.KEY_LOAD_TIMEOUT:case t.ErrorDetails.LEVEL_LOAD_ERROR:case t.ErrorDetails.LEVEL_LOAD_TIMEOUT:case t.ErrorDetails.MANIFEST_LOAD_ERROR:case t.ErrorDetails.MANIFEST_LOAD_TIMEOUT:r=n?b.PLAYBACK_STOPPED_NETWORK_ERROR:b.NO_PLAYBACK_NETWORK_ERROR;break;case t.ErrorDetails.FRAG_DECRYPT_ERROR:case t.ErrorDetails.FRAG_PARSING_ERROR:case t.ErrorDetails.MANIFEST_PARSING_ERROR:r=n?b.PLAYBACK_STOPPED_DECODE_ERROR:b.NO_PLAYBACK_DECODE_ERROR;break;case t.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR:r=b.UNSUPPORTED_FORMAT_ERROR;break;case t.ErrorDetails.BUFFER_APPEND_ERROR:case t.ErrorDetails.BUFFER_STALLED_ERROR:}return new k(r,new Vc(e),e.details,a)}var Kc,zc=I("HlsNativeSubtitles");class Xc extends Ac{constructor(e,t,i){super(e,t,i),this.placeholderTextTrack=void 0,this.numMissingTracks=void 0,this.destroyController=new AbortController,this.abortableAddTrackListener=void 0,zc.log(e.textTracks.length+" of "+i.length+" text tracks are present."),this.numMissingTracks=i.length-e.textTracks.length,this.numMissingTracks>0&&(this.abortableAddTrackListener=Il(Rl(e.textTracks,"addtrack",this.handleTrackAdded.bind(this)),this.destroyController.signal))}supportsAddingTracks(){return!1}addSubtitlesTrack(){throw new Error("Not supported.")}getTextTrack(e){if(this.element){for(var t=this.element.textTracks,i=0;i<t.length;++i){var n=t[i];if("subtitles"===n.kind&&n.label===e.label)return n}return this.numMissingTracks>0?(zc.log("Creating a placeholder text track ("+e.label+", "+e.language+") in anticipation of the real track."),this.placeholderTextTrack={label:e.label,language:e.language,mode:"disabled",oncuechange:null},this.placeholderTextTrack):void 0}}handleTrackAdded(e){var t=e.track,i=this.placeholderTextTrack;if(t&&t instanceof TextTrack&&"subtitles"===t.kind){var n;if(this.numMissingTracks--,this.numMissingTracks<=0&&this.element)null==(n=this.abortableAddTrackListener)||n.abort(),this.abortableAddTrackListener=void 0,zc.log("All text tracks are now present.");i&&i.label===t.label&&(zc.log("Placeholder track ("+i.label+", "+i.language+") replaced by real track"+(i.language!==t.language?" (language changed to "+t.language+"!)":"")+"."),t.mode=i.mode,t.oncuechange=i.oncuechange,this.activeTrack===i&&(this.activeTrack=t),this.placeholderTextTrack=void 0)}}destroy(){this.destroyController.abort(),super.destroy()}}var Yc,Qc,$c,Jc,Zc,ed,td,id,nd,ad,rd,sd,od,ld,ud,cd,dd,hd,gd,pd,vd,fd,md,yd={id:"Native",name:"Native adapter",tech:"HTML5",version:"n/a"},bd=I(yd.id),Td=(e=>{})(Kc=class extends Mc{constructor(e,t,i,n,a,r){super(e,t,{src:n,mediaType:a,isAudioOnly:x(a)},r),this.qualityTracker=void 0,this.rawDurationWasInfinity=void 0,this.startTime=void 0,this.qualityTracker=i,this.attachPlaybackEvents(),this.attachErrorEvents(),this.attachValueChangeEvents(),this.applyInitialPlaybackState(null!=r?r:{})}static canPlayType(e){return V(e)}static getAdapterInfo(){return yd}getAdapterInfo(){return yd}async internalPreload(e){var t,i=function(e){if(e&&"boolean"==typeof e.loadData)return e.loadData?"auto":"metadata";return}(e);if(i&&(this.element.preload=i),W(this.mediaInfo.mediaType)){var a,r=await mc(this.mediaInfo.src,{signal:this.destroyController.signal}),s=await bc(r.levels[0].url,{signal:this.destroyController.signal}),o=r.levels[0].quality,l=yc(r.levels);this.mediaInfo.firstQuality=n({},o),this.mediaInfo.isAudioOnly=r.isAudioOnly,this.mediaInfo.orientation=r.orientation,this.mediaInfo.qualities=l,this.mediaInfo.subtitles=r.subtitles,this.mediaInfo.segmentListInfo={averageSegmentDuration:s.averageSegmentDuration,endListPresent:s.fixedEnd,type:s.fixedEnd?B.OnDemand:s.fixedStart?B.Event:B.Live,segmentListDuration:s.playlistDuration,programDateTimeAtPosZero:void 0!==s.programDateTime?s.programDateTime.getTime()/1e3:void 0},l.length>0&&(this.qualityTracker.setAvailableQualities(l),"video"!==this.element.tagName.toLowerCase()||r.isAudioOnly||this.trackVideoQuality()),!this.subtitleControls&&null!=(a=this.mediaInfo.subtitles)&&a.length&&(bd.log("Creating controls for media provided subtitles:",this.mediaInfo.subtitles.map((e=>e.label)).join(", ")),this.subtitleControls=new Xc(this.element,this.eventEmitter,this.mediaInfo.subtitles),this.subtitleControls.setDefaultSubtitles())}void 0!==this.startTime&&(null==(t=this.mediaInfo.segmentListInfo)?void 0:t.type)!==B.Live&&this.applyStartTime(this.startTime);var u=Il(Rl(this.element,"loadeddata",(()=>{u.abort(),this.handleLoadedData()})),this.destroyController.signal);this.element.src=this.mediaInfo.src}handleMediaRangeChange(e){if(this.mediaInfo.segmentListInfo&&e.end>0&&(this.mediaInfo.segmentListInfo.segmentListDuration=e.end-e.start),void 0===this.rawDurationWasInfinity){var t=this.getRawDuration();"number"!=typeof t||Number.isNaN(t)||(this.rawDurationWasInfinity=!Number.isFinite(t))}else this.rawDurationWasInfinity&&Number.isFinite(this.getRawDuration())&&(this.mediaInfo.segmentListInfo&&(this.mediaInfo.segmentListInfo.endListPresent=!0,this.eventEmitter.emit(v.LiveStreamEnded,e)),this.rawDurationWasInfinity=!1);super.handleMediaRangeChange(e)}handleLoadedData(){this.attachDurationChangeEvents(),Promise.resolve().then((()=>{if(W(this.mediaInfo.mediaType))return mc(this.mediaInfo.src).then((e=>{var t,i=this.qualityTracker.getCurrentQuality();if(void 0===i)return e.levels[0].url;var n=e.levels.find((e=>e.quality.bitrate===i.bitrate));return null!=(t=null==n?void 0:n.url)?t:e.levels[0].url})).then((e=>bc(e))).then((e=>{if(void 0!==e.programDateTime&&void 0!==this.mediaInfo.segmentListInfo){var t=e.programDateTime.getTime()/1e3;this.mediaInfo.segmentListInfo.programDateTimeAtPosZero=t}}))})).then((()=>{bd.log("Faking a duration change event at loadeddata."),this.handleDurationChangeEvent()})).catch((e=>bd.error("loadeddata event handler error:",e)))}applyInitialPlaybackState(e){var{playbackRate:t,mute:i,volume:n,startTime:a}=e;void 0!==t&&this.setPlaybackRate(t),void 0!==i&&(i?this.mute():this.unmute()),void 0!==n&&this.setVolume(n),this.startTime=a}trackVideoQuality(){var e,t,i,n,a=this.element,r=0,s=0,o=0,l=!0,u=Array.from(new Set((null!=(e=this.mediaInfo.qualities)?e:[]).map((e=>e.frameRate)).filter((e=>e))));u.sort();var c=Math.floor(u.reduce(((e,t,i)=>0===i?t:Math.min(e,(u[i]-u[i-1])/2)),0)),d=!!a.getVideoPlaybackQuality&&u.length>1;d?bd.log("Frame rate check enabled. Got: "+u.join(", ")+". Snap distance: "+c+"."):bd.log("Frame rate check disabled. "+(u.length>1?"No support.":"Single frame rate."));var h=()=>{var e=!1;if(a.videoWidth===t&&a.videoHeight===i||(e=!0,l=!0,bd.log("Resolution changed from "+t+"x"+i+" to "+a.videoWidth+"x"+a.videoHeight+"."),t=a.videoWidth,i=a.videoHeight),d){var n=a.getVideoPlaybackQuality(),h=Math.round((n.totalVideoFrames-r)/(n.creationTime-s)*1e3);if(r=n.totalVideoFrames,s=n.creationTime,0===h)l=!0;else if(l)l=!1;else for(var g=0;g<u.length;++g)if(Math.abs(h-u[g])<=c){o!==u[g]&&(e=!0,bd.log("Frame rate changed from "+o+" to "+u[g]),o=u[g]);break}}e&&this.qualityTracker.setCurrentQualityByVideoProps(t,i,o>0?o:void 0)},g=()=>{h(),n||(n=Il(setInterval(h,500),this.destroyController.signal),bd.log("Tracking quality."))},p=()=>{n&&(n.abort(),n=void 0,bd.log("Stopped tracking quality."))};Il([Rl(this.element,"loadeddata",g),Rl(this.element,"play",g),Rl(this.element,"playing",g),Rl(this.element,"paused",p),Rl(this.element,"ended",p)],this.destroyController.signal)}applyStartTime(e){var t=new AbortController;wl(this.destroyController.signal,t),Il([Rl(this.element,"durationchange",(()=>{this.element.duration>0&&this.element.currentTime<e&&(bd.log("Seeking to start time (durationchange): "+e),this.seekTo(e))})),Rl(this.element,"seeking",(()=>{this.getCurrentTime()>=e&&(bd.log("Start time applied."),t.abort())})),Rl(this.element,"timeupdate",(()=>{this.getCurrentTime()>=e&&(bd.log("Start time reached."),t.abort())}))],t.signal);var i=Il(Rl(this.element,"loadeddata",(()=>{Il([Rl(this.element,"seeking",(()=>i.abort())),setTimeout((()=>{i.abort(),bd.log("Seeking to start time (loadeddata): "+e),this.seekTo(e)}),200)],i.signal)})),t.signal)}})||Kc;H("nrkno-player-scrubber",class extends gt{readyCallback(){Y(this.render(),this,{eventContext:this}),super.readyCallback()}render(){return Q(Jc||(Jc=Z(['\n      <input\n        class="nrkno-player-scrubber__input absolute reset-input-range"\n        action="','"\n        action:events="change"\n        type="range"\n        min="0"\n        max="100"\n        step="1"\n        aria-label="Spol"\n      />\n      <div class="nrkno-player-scrubber__progressbar" type="progressbar" aria-hidden="true">\n        <div class="nrkno-player-scrubber__playhead" type="playhead"></div>\n        <div class="nrkno-player-scrubber__progressbar--full" type="progressbar-full"></div>\n        <div class="nrkno-player-scrubber__progressbar--played" type="progressbar-played"></div>\n      </div>\n      <div\n        class="nrkno-player-scrubber__time nrkno-player-scrubber__time--start"\n        type="start-time"\n        aria-hidden="true"\n      ></div>\n      <div\n        class="nrkno-player-scrubber__time nrkno-player-scrubber__time--end"\n        type="end-time"\n        aria-hidden="true"\n      ></div>\n      <div\n        class="nrkno-player-scrubber__time nrkno-player-scrubber__time--playhead"\n        type="playhead-time"\n        aria-hidden="true"\n      ></div>\n      <div\n        class="nrkno-player-scrubber__time nrkno-player-scrubber__time--pointer"\n        type="pointer-time"\n        aria-hidden="true"\n      ></div>\n    '])),G.SeekTo)}}),H("nrkno-player-volume",class extends Je{constructor(){super(...arguments),this.simple=!1,this.disabled=!1,this.hideSlider=!1}static get reactiveAttributes(){return n({},super.reactiveAttributes,{simple:Boolean,hideSlider:Boolean,disabled:Boolean})}updated(e){super.updated(e),this.isConnected&&Y(this.render(),this,{eventContext:this})}render(){return Q(Yc||(Yc=Z(['\n      <button\n        class="'," ",'"\n        action="','"\n        type="mute-button"\n        aria-label="','"\n        ?disabled="','"\n      >\n        '," ","\n      </button>\n      ","\n    "])),"nrkno-player-volume__mute absolute top left nrkno-player-focus-ring"+(this.simple?"--outside":""),this.simple?"":"center-content",G.ToggleMute,this.muted?"Lyd på":"Lyd av",this.disabled,$(this.selectIcon()),this.renderLabel(),this.renderSlider())}renderLabel(){if(this.simple)return Q(Qc||(Qc=Z([" <span>","</span> "])),this.muted?"Slå på lyd":"Slå av lyd")}renderSlider(){if(!(this.simple||r.isMobile||this.disabled||this.hideSlider)){var e=this.muted?0:100*this.volume;return Q($c||($c=Z(['\n      <div\n        class="nrkno-player-volume__control nrkno-player-focus-ring absolute bottom left"\n        @mouseleave="','"\n      >\n        <input\n          class="nrkno-player-volume__input absolute reset-input-range"\n          action="','"\n          type="range"\n          min="0"\n          max="100"\n          step="10"\n          aria-label="Juster lydnivå"\n          .value="','"\n        />\n        <div class="nrkno-player-volume__slider absolute" aria-hidden="true">\n          <div class="nrkno-player-volume__slider-fill" style="height: ','%;"></div>\n          <div class="nrkno-player-volume__slider-thumb-track">\n            <div class="nrkno-player-volume__slider-thumb absolute" style="bottom: ','%;"></div>\n          </div>\n        </div>\n      </div>\n    '])),this.handleMouseLeave,G.SetVolume,this.muted?0:100*this.volume,e,e)}}handleMouseLeave(e){!this.player.focusVisible&&this.focusWithin&&this.children[0].focus()}selectIcon(){return this.muted||0==this.volume?ae:this.volume<=.33?re:this.volume>.33&&this.volume<=.66?se:this.volume>.66?oe:void 0}});function kd(e){return class extends e{constructor(){super(...arguments),this.accessibleDescription="",this.action="",this.closable=!0,this.name="",this.player=void 0,this.value="",this._previousActiveElement=null}disconnectedCallback(){document.removeEventListener("keydown",this,!0),document.removeEventListener("blur",this,!0),this.removeEventListener("click",this,!0),this._previousActiveElement=null,super.disconnectedCallback&&super.disconnectedCallback()}updating(e,t){"hidden"===e&&!1===this.hidden&&(this._previousActiveElement=document.activeElement||this.player),super.updating(e,t)}updated(e){var t;if((super.updated&&super.updated(e),this.isConnected)&&e.has("hidden"))if(this.hidden)null==(t=this._previousActiveElement)||t.focus({preventScroll:!0}),document.removeEventListener("keydown",this,!0);else if(this.addEventListener("click",this,!0),document.addEventListener("keydown",this,!0),this.accessibleDescription){var i=this.action;this.action=G.Speak,this.value=this.accessibleDescription,this.dispatchEvent(new Event("change",{cancelable:!0,bubbles:!0})),this.action=i}}handleEvent(e){var t=!1;if("keydown"===e.type){var i=e.which;9===i?document.addEventListener("blur",this,!0):27===i&&(t=!0)}else"blur"===e.type?(document.removeEventListener("blur",this,!0),this.contains(e.relatedTarget)||(t=!0)):"click"===e.type&&e.target===this&&this.closable&&(t=!0);t&&this.hide(),super.handleEvent&&super.handleEvent(e)}hide(){this.action=G.DialogHide,this.value=this.name,this.dispatchEvent(new Event("change",{cancelable:!0,bubbles:!0}))}}}var Sd,Ed={default:{interactive:!1,message:"Noe gikk galt under avspillingen."},"404 500":{interactive:!1,message:"Klarte ikke spille av klippet."}};class Pd extends(kd(q)){constructor(){super(...arguments),this.accessibleDescription="Noe gikk galt under avspilling",this.closable=!1,this.error=void 0,this.hidden=!0,this.name=K.Error}static get reactiveProperties(){return{error:Object}}updating(e,t){"error"===e&&this.error&&(this.accessibleDescription=this.getErrorObject(this.error).message)}updated(e){super.updated(e),this.isConnected&&!this.hidden&&this.error&&Y(this.render(),this,{eventContext:this})}render(){return Q(od||(od=Z([' <div class="nrkno-player-errormessage__inner">',"</div> "])),this.renderErrorMessage(this.error))}getErrorObject(e){return e instanceof k?this.mapCoreErrorToObject(e):this.mapErrorToObject(e)}renderErrorMessage(e){var t=this.getErrorObject(e);return Q(ld||(ld=Z(["\n      <span>","</span>\n      ","\n    "])),t.message,t.interactive?Q(ud||(ud=Z(["<button>Prøv igjen</button>"]))):"")}mapErrorToObject(e){var{interactive:t,message:i}=Ed.default;for(var n in Ed){var a,{interactive:r,message:s}=Ed[n];if(e.code===n||String(e.status)===n||n.includes(String(e.status))||null!=(a=e.message)&&a.includes(n)){t=r,i=s;break}}return{interactive:t,message:i}}mapCoreErrorToObject(e){var t=e.message;switch(e.type){case me.PlayerErrorTypes.PLAYBACK_STOPPED_DECODE_ERROR:case me.PlayerErrorTypes.NO_PLAYBACK_DECODE_ERROR:t="Det oppstod en feil.";break;case me.PlayerErrorTypes.PLAYBACK_STOPPED_NETWORK_ERROR:case me.PlayerErrorTypes.NO_PLAYBACK_NETWORK_ERROR:t="Avspilling gikk galt på grunn av nettverket.";break;case me.PlayerErrorTypes.UNSUPPORTED_FORMAT_ERROR:t="Nettleseren din støtter ikke avspilling av innholdet. Prøv en annen nettleser.";break;case me.PlayerErrorTypes.UNKNOWN_ERROR:t="Det oppsto en ukjent feil."}return{interactive:!1,message:t}}}class Cd extends(kd(Le(j(q)))){constructor(){super(...arguments),this.src=void 0,this.clipId=void 0,this.isCountingDown=!1,this.isEnded=!1,this.intersectionEntry=void 0,this.metadata=void 0,this.recommendedLinks=[],this.accessibleDescription="Videoforslag vises",this.countdown=!1,this.name=K.Recommend,this.hidden=!0,this.recommendations=void 0,this.recommendedOrigin="",this.shareOrigin="",this._countdownTimeoutId=void 0,this._size=2,this._unshadowProperties=void 0}static get reactiveAttributes(){return n({},super.reactiveAttributes)}static get reactiveProperties(){return n({},super.reactiveProperties,{clipId:String,src:String,isCountingDown:Boolean,isEnded:Boolean,intersectionEntry:Object,recommendations:Object,metadata:(e,t)=>{t&&(e.clipId=t.id)},recommendedLinks:Array})}get recommendationsOriginUrl(){return this.recommendations&&"string"==typeof this.recommendations.src?this.recommendations.src:this.recommendedOrigin}readyCallback(){this.player=z(this),this._unshadowProperties=this.player.shadowProperties(["intersectionEntry","isEnded","metadata","recommendedOrigin","shareOrigin","recommendations","src"],this),this.recommendations&&Array.isArray(this.recommendations.src)&&(this.recommendedLinks=this.recommendations.src)}disconnectedCallback(){var e;this.clearCountdown(),null==(e=this._unshadowProperties)||e.call(this),this.player=null,super.disconnectedCallback()}async updating(e,t){if("isEnded"===e&&this.isEnded){var i=!(!this.recommendations||!this.recommendations.countdown);this.isCountingDown=i,this.isCountingDown?this._countdownTimeoutId=setTimeout((()=>{if(document.hidden||this.intersectionEntry&&!this.intersectionEntry.isIntersecting);else{var e=this.recommendedLinks[0].id;this.player.autoplay=!0,this.player.src="nrk:"+e}this.isCountingDown=!1}),this.countdownTimeout):this._countdownTimeoutId&&clearTimeout(this._countdownTimeoutId)}if("clipId"===e&&!!this.recommendationsOriginUrl&&this.recommendationsOriginUrl)try{var n=await X(this.recommendationsOriginUrl+"/"+this.clipId+"?size="+this._size,{method:"get",mode:"cors",retry:3,timeout:5e3}),a=await n.json();this.recommendedLinks=a.map((e=>({id:e.id,title:e.title,duration:parseInt(e.duration,10),img:e.images.thumbnail.src,href:this.shareOrigin+"/"+e.id})))}catch(e){this.panic(e),this.hide()}"recommendations"===e&&this.recommendations&&Array.isArray(this.recommendations.src)&&(this.recommendedLinks=this.recommendations.src),"src"===e&&this.isCountingDown&&this.clearCountdown(),super.updating(e,t)}updated(e){this.isConnected&&(this.hidden||(this.recommendedLinks.length>0?Y(this.render(),this,{eventContext:this}):this.hide()),super.updated(e))}render(){return this.isCountingDown?this.renderCountdown():Q(cd||(cd=Z(['\n      <ul class="nrkno-player-recommended__container">\n        ','\n      </ul>\n      <button\n        class="nrkno-player-recommended__close absolute"\n        action="','"\n        aria-label="Lukk videoforslag"\n      >\n        ',"\n      </button>\n    "])),this.recommendedLinks.map(this.renderLink),G.DialogHide,$(J))}renderCountdown(){return Q(dd||(dd=Z(['\n      <h3>Neste</h3>\n      <ul class="nrkno-player-recommended__container">\n        ','\n        <div class="nrkno-player-recommended__countdown" aria-hidden="true">\n          <div></div>\n        </div>\n      </ul>\n      <div class="nrkno-player-recommended__buttons absolute">\n        <button\n          class="nrkno-player-recommended__replay-button nrkno-player-button-medium nrkno-player-focus-ring--outside absolute center-content"\n          action="','"\n          type="play-button"\n          aria-label="Spill igjen"\n          @click="','"\n        >\n          ','\n        </button>\n        <button\n          class="nrkno-player-recommended__cancel-countdown-button nrkno-player-button-medium nrkno-player-focus-ring--outside absolute center-content"\n          aria-label="Spiller av neste video om 10 sekunder. Trykk for å avbryte nedtelling"\n          autofocus\n          @click="','"\n        >\n          ',"\n        </button>\n      </div>\n    "])),this.renderLink(this.recommendedLinks[0]),G.Play,this.clearCountdown,$(ee),this.clearCountdown,$(J))}renderLink(e){var{duration:t,img:i,title:n,href:a}=e;return Q(hd||(hd=Z(['\n      <a href="','" aria-label="',". Varighet: ",'">\n        <div class="nrkno-player-recommended__thumbnail" aria-hidden="true">\n          <img class="full" alt="" src="','" />\n        </div>\n\n        <div class="nrkno-player-recommended__details" aria-hidden="true">\n          <h4 class="text-clamp">',"</h4>\n          <p>","</p>\n        </div>\n\n        ","\n      </a>\n    "])),a,n,ne(t),i,n,ie(t),$(te))}get countdownTimeout(){return this.recommendations&&this.recommendations.countdown?1e4:0}clearCountdown(){this.isCountingDown=!1,this._countdownTimeoutId&&clearTimeout(this._countdownTimeoutId)}}!function(e){e.Copy="share.copy"}(Sd||(Sd={}));class Id extends(kd(q)){constructor(){super(...arguments),this.isCopied=!1,this.metadata=void 0,this.shareId=void 0,this.shareHeading=void 0,this.hidden=!0,this.name=K.Share,this.shareOrigin="",this._unshadowProperties=void 0}static get reactiveProperties(){return n({},super.reactiveProperties,{isCopied:Boolean,metadata:(e,t)=>{t&&(e.shareId=t.id,e.shareHeading=t.heading)},shareId:String,shareHeading:String})}readyCallback(){this.player=z(this),this._unshadowProperties=this.player.shadowProperties(["metadata","shareOrigin"],this),this.player.metadata&&(this.shareId=this.player.metadata.id,this.shareHeading=this.player.metadata.heading)}disconnectedCallback(){var e;null==(e=this._unshadowProperties)||e.call(this),this.player=null,super.disconnectedCallback()}updated(e){super.updated(e),this.isConnected&&(this.hidden?this.isCopied=!1:Y(this.render(),this,{eventContext:this}))}get shareUrl(){var e=wd(this.shareOrigin,this.shareId);return this.player.isLive?e:e+"?t="+Math.floor(this.player.currentTime)}render(){return Q(gd||(gd=Z(['\n      <div class="nrkno-player-share__link-container">\n        <button\n          class="','"\n          class="nrkno-player-share__button nrkno-player-share__copy-button"\n          autofocus\n          aria-label="','"\n          @click="','"\n        >\n          '," ",'\n        </button>\n        <a\n          class="nrkno-player-share__button"\n          target="_blank"\n          href="','"\n          aria-label="Lenke til video på nrk.no"\n        >\n          Se i ny fane ','\n        </a>\n      </div>\n      <button\n        class="nrkno-player-recommended__close absolute"\n        action="','"\n        aria-label="Lukk videoforslag"\n      >\n        ',"\n      </button>\n    "])),ft({"nrkno-player-share__button":!0,"nrkno-player-share__button--copied":this.isCopied}),this.isCopied?"Videolenke kopiert!":"Kopier videolenke",this.handleButtonClick,this.isCopied?"Kopiert!":"Kopier lenke",$(this.isCopied?be:Te),this.shareUrl,$(ye),G.DialogHide,$(J))}handleButtonClick(e){var t,i,n=wd(this.shareOrigin,this.shareId);if(this.dispatchEvent((i=Sd.Copy,new CustomEvent(i,{bubbles:!0,detail:{url:n}}))),null!=(t=navigator.clipboard)&&t.writeText)navigator.clipboard.writeText(n);else{var a=document.createElement("textarea");a.readOnly=!0,a.value=n,document.body.appendChild(a),a.select();try{document.execCommand("copy")}catch(e){}finally{document.body.removeChild(a)}}this.isCopied=!0}}function wd(e,t){return void 0===t&&(t=""),e.endsWith("/")&&(e=e.slice(0,-1)),t.startsWith("/")&&(t=t.slice(1)),e+"/"+t}class Rd{constructor(){this.videoEnded=!1,this.rawLPLogger=void 0}createLinkpulseTracker(e){this.rawLPLogger=function(e){var t,i,n,a=null!=(t=null==globalThis||null==(i=globalThis.LP4)||null==(n=i.video)?void 0:n.logger)?t:void 0;if("function"==typeof a){var{videoUrl:r,videoImg:s,duration:o,title:l}=e,u=new a;return u.setVideoTitle(l),u.setVideoUrl(r),u.setVideoImg(s),u.setDuration(o),u.logLoadstart(),u}}(e)}logPlaystart(e){var t;null==(t=this.rawLPLogger)||t.logPlaystart(e)}logInitialPlaystartOnly(e){var t;(null==(t=this.rawLPLogger)||!t.getLoggedPlaystart())&&this.logPlaystart(e)}handleTimeUpdate(e,t){if(this.rawLPLogger){this.rawLPLogger.logTimeupdate(e);var i=e/t>=.95;!this.videoEnded&&i&&this.rawLPLogger.getLoggedPlaystart()&&(this.videoEnded=!0,this.rawLPLogger.logEnded(e))}}handlePlayPauseChange(e){var t,i=!e;null==(t=this.rawLPLogger)||t.setPaused(i)}}H("nrkno-player-controls",class extends qe{constructor(){super(...arguments),this.visibility=void 0,this.activeDialog=void 0}static get reactiveAttributes(){return n({},super.reactiveAttributes,{visibility:Object,activeDialog:String})}updated(e){super.updated(e),this.isConnected&&Y(this.render(),this,{eventContext:this})}updating(e){"activeDialog"===e&&this.activeDialog&&(this.active=!0)}render(){return Q(Zc||(Zc=Z(['\n      <div class="nrkno-player-controls__bar absolute left bottom">\n        <div class="flex">\n          <nrkno-player-scrubber\n            class="-scrubber nrkno-player-controls__scrubber"\n            ?disabled=',"\n            ?hidden=",'\n            ?active="','"\n          ></nrkno-player-scrubber>\n          ','\n        </div>\n\n        <div class="nrkno-player-controls__buttons absolute">\n          ','\n          <div class="flex">\n            '," "," "," ","\n            ","\n          </div>\n        </div>\n      </div>\n    "])),this.isDisabled("Scrubber"),this.isHidden("Scrubber"),this.active,this.renderLiveButton(),this.renderPlayPauseButton(),this.renderVolume(),this.renderSubtitleButton(),this.renderPipButton(),this.renderShareButton(),this.renderFullscreenButton())}renderPlayPauseButton(){return Q(ed||(ed=Z(['\n      <button\n        class="nrkno-player-playpause-button nrkno-player-button-big nrkno-player-focus-ring--outside center-content"\n        action="','"\n        type="playpause-button"\n        aria-label="','"\n        autofocus\n      >\n        ',"\n      </button>\n    "])),G.TogglePlay,this.isPlaying?"Pause":"Spill av",$(this.isPlaying?le:this.isEnded?ee:ue))}renderFullscreenButton(){var e,t,i,n,a;return Q(td||(td=Z(['\n      <button\n        class="nrkno-player-controls__fullscreen-button nrkno-player-button-small nrkno-player-focus-ring center-content"\n        action="','"\n        type="fullscreen-button"\n        aria-label="','"\n        ?disabled="','"\n        ?hidden=',"\n      >\n        ","\n      </button>\n    "])),null!=(e=this.fullscreenState)&&e.isActive?G.ExitFullscreen:G.EnterFullscreen,null!=(t=this.fullscreenState)&&t.isActive?"Avslutt fullskjerm":"Fullskjerm",this.isDisabled("Fullscreen")||null==(i=!(null!=(n=this.fullscreenState)&&n.isAvailable))||i,this.isHidden("Fullscreen"),$(null!=(a=this.fullscreenState)&&a.isActive?ce:de))}renderVolume(){return Q(id||(id=Z(['<nrkno-player-volume\n      class="-volume nrkno-player-controls__volume"\n      ?disabled=',"\n      ?hidden=","\n      ?hideslider=","\n    ></nrkno-player-volume>"])),this.isDisabled("Volume"),this.isHidden("Volume"),!!this.activeDialog)}renderSubtitleButton(){var e=this.subtitleState;if(e&&e.subtitles.length)return Q(nd||(nd=Z(['<button\n      class="nrkno-player-subtitle-button nrkno-player-button-small nrkno-player-focus-ring center-content"\n      action="','"\n      value="subtitles"\n      type="subtitle-button"\n      aria-label="','"\n      ?disabled=',"\n      ?hidden=","\n    >\n      ","\n    </button>"])),G.ToggleSubtitles,e.isShowing?"Slå av undertekster":"Slå på undertekster",this.isDisabled("Subtitles"),this.isHidden("Subtitles"),$(e.isShowing?he:ge))}renderLiveButton(){if(this.player.isLive){var e=this.isCurrentTimeLive?"":"nrkno-player-controls__live-badge--playhead-not-live";return Q(ad||(ad=Z([' <button\n      class="nrkno-player-controls__live-badge ','"\n      action="','"\n      ?disabled=',"\n      ?hidden=","\n    >\n      Direkte\n    </button>"])),e,G.SeekToLive,this.isDisabled("Live"),this.isHidden("Live"))}}renderPipButton(){var e,t,i,n,a;return Q(rd||(rd=Z(['<button\n      class="nrkno-player-pip-button nrkno-player-button-small nrkno-player-focus-ring center-content"\n      action="','"\n      type="pip-button"\n      aria-label="','"\n      ?disabled=',"\n      ?hidden=","\n    >\n      ","\n    </button>"])),null!=(e=this.pipState)&&e.isActive?G.ExitPip:G.EnterPip,null!=(t=this.pipState)&&t.isActive?"Avslutt bilde-i-bilde":"Bilde-i-bilde",this.isDisabled("PiP"),this.isHidden("PiP")||null==(i=!(null!=(n=this.pipState)&&n.isAvailable))||i,$(null!=(a=this.pipState)&&a.isActive?pe:ve))}handleButtonClick(e){var t;null==(t=document.querySelector(".nrkno-player-playpause-button"))||t.focus()}renderShareButton(){return Q(sd||(sd=Z(['\n      <button\n        @click="','"\n        class="nrkno-player-share-button nrkno-player-button-small nrkno-player-focus-ring center-content"\n        action="','"\n        type="share-button"\n        aria-label="Del video"\n        value="','"\n        ?disabled=',"\n        ?hidden=","\n      >\n        ","\n      </button>\n    "])),this.handleButtonClick,"share"===this.activeDialog?G.DialogHide:G.DialogShow,K.Share,this.isDisabled("Share"),this.isHidden("Share"),$(fe))}isDisabled(e){var t;return null==(t=this.visibility)?void 0:t.disabled.includes(e)}isHidden(e){var t;return null==(t=this.visibility)?void 0:t.hidden.includes(e)}}),H("nrkno-player-errormessage",Pd),H("nrkno-player-keyboard",Ae),H("nrkno-player-tracker",class extends fu{constructor(){super(...arguments),this.linkpulseTracker=new Rd,this.metadata=void 0,this._unshadowPropertiesNrkno=void 0}static get reactiveProperties(){return n({},super.reactiveProperties,{metadata:Object})}updating(e,t){if(super.updating(e,t),this.player&&"metadata"===e&&this.metadata){var i,n,a,r,s=this.metadata,o=null!=(i=this.player.shareOrigin)?i:"https://www.nrk.no/video/";this.linkpulseTracker.createLinkpulseTracker({duration:s.duration,title:null!=(n=null!=(a=s.heading)?a:s.id)?n:"unnamed",videoImg:null==(r=this.player)?void 0:r.poster,videoUrl:o+"/"+s.id})}}readyCallback(){super.readyCallback(),this.player&&(this.player.addEventListener(E.TimeUpdate,this),this.player.addEventListener(E.PlayingChange,this),this.player.addEventListener(E.WaitingChange,this),this.player.addEventListener(ke.Autoplay,this),this.player.addEventListener(Sd.Copy,this),this._unshadowPropertiesNrkno=this.player.shadowProperties("metadata",this))}handleEvent(e){super.handleEvent(e),this.handlePlayerEvent(e),this.handleNrknoPlayerEvent(e),this.handleShareEvent(e)}handlePlayerEvent(e){if(Se(e,E.TimeUpdate)){var t,i,n=e.detail;this.linkpulseTracker.handleTimeUpdate(n,null!=(t=null==(i=this.metadata)?void 0:i.duration)?t:0)}else if(Se(e,E.PlayingChange))this.linkpulseTracker.handlePlayPauseChange(e.detail.isPlaying);else{var a=this.player;if(!a)return;Se(e,E.WaitingChange)&&"seeking"===e.detail.reason?this.linkpulseTracker.logPlaystart(a.currentTime):Se(e,E.SessionCreated)&&this.linkpulseTracker.logInitialPlaystartOnly(a.currentTime)}}handleNrknoPlayerEvent(e){var t,i;Ee(e,ke.Autoplay)&&(null==(t=this.trackingSession)||null==(i=t.gaSender)||i.updateFields({autoplay:e.detail.isAutoplay}))}handleShareEvent(e){if(function(e,t){return e.type===t}(e,Sd.Copy)){var t,i=null==(t=this.trackingSession)?void 0:t.gaSender;if(!i)return;i.sendEvent({eventCategory:"player-interaction",eventAction:"click-share",eventLabel:"copy,"+e.detail.url})}}disconnectedCallback(){var e,t,i,n,a,r;null==(e=this.player)||e.removeEventListener(E.TimeUpdate,this),null==(t=this.player)||t.removeEventListener(E.PlayingChange,this),null==(i=this.player)||i.removeEventListener(E.WaitingChange,this),null==(n=this.player)||n.removeEventListener(ke.Autoplay,this),null==(a=this.player)||a.removeEventListener(Sd.Copy,this),null==(r=this._unshadowPropertiesNrkno)||r.call(this),super.disconnectedCallback()}}),H("nrkno-player-recommended",Cd),H("nrkno-player-share",Id),H("nrkno-player-subtitles",class extends Dt{constructor(){super(...arguments),this.cueConfig={defaultToIndentedStartAlignment:!0,indentation:3}}updated(e){super.updated(e),this.isConnected&&e.has("subtitleState")&&this.subtitleState&&Y(this.render(),this,{eventContext:this})}render(){var e;if(this.isRenderingEnabled()&&null!=(e=this.subtitleState)&&e.activeCues.length)return Q(pd||(pd=Z(["",""])),this.subtitleState.activeCues.map(((e,t)=>{var i=this.activeCuePositions[t];return Q(vd||(vd=Z(['<div class="subtitle__cue" style=',">\n        ",'\n        <span class="subtitle__text">',"</span>\n        ","\n      </div>"])),yt(i.styles),Array(i.insertLineBreaks).fill(Q(fd||(fd=Z(["<br />"])))),e.getCueAsHTML(),Array(i.appendLineBreaks).fill(Q(md||(md=Z(["<br />"])))))})))}});export{qc as HlsJsAdapter,Td as NativeAdapter,$u as PlayerCore};
