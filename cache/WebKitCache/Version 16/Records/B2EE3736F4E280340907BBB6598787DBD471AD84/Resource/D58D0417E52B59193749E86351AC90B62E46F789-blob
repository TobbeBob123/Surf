"use strict";(()=>{var M=Object.defineProperty;var h=(_,m)=>M(_,"name",{value:m,configurable:!0});(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([[4656],{14656:(_,m,l)=>{l.r(m),l.d(m,{CommandPalettePageElement:()=>a});var d=l(90420),T=l(55623),u=l(65881),P=l(86004),x=l(26850),C=l(3447),y=l(30474),D=l(43832),O=Object.defineProperty,L=Object.getOwnPropertyDescriptor,c=h((e,t,s,i)=>{for(var r=i>1?void 0:i?L(t,s):t,n=e.length-1,o;n>=0;n--)(o=e[n])&&(r=(i?o(t,s,r):o(r))||r);return i&&r&&O(t,s,r),r},"__decorateClass"),S=h((e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)},"__accessCheck"),b=h((e,t,s)=>(S(e,t,"read from private field"),s?s.call(e):t.get(e)),"__privateGet"),E=h((e,t,s)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,s)},"__privateAdd"),v=h((e,t,s,i)=>(S(e,t,"write to private field"),i?i.call(e,s):t.set(e,s),s),"__privateSet"),p,f;let a=h(class extends HTMLElement{constructor(e={}){super();this.isRoot=!1,this.pageTitle="",this.scopeId="",this.scopeType="",this.hasVisibleTip=!1,this.currentHeight=0,this.octicons={},E(this,p,void 0),this.requestsInProgress=[],E(this,f,void 0),this.tryDefaultSelection=!0,this.items={};var t;this.hidden=(t=e.hidden)!=null?t:!0,this.page=e.page,v(this,p,new x.A("","",{scope:this.scope,subjectId:this.defaultScopeId,subjectType:this.defaultScopeType}))}get providers(){var e;return((e=this.page)==null?void 0:e.providers)||[]}get prefetchedProviders(){return this.providers.filter(e=>e.prefetch)}get query(){return b(this,p)}set query(e){this.items[e.path]||(this.items[e.path]=this.currentItems.filter(t=>t.calculateScore(e.text)>0)),v(this,p,e)}get scope(){return{text:this.pageTitle,type:this.scopeType,id:this.scopeId,tokens:[]}}get defaultScopeType(){const e=(0,y.I)();return e==null?void 0:e.defaultScopeType}get defaultScopeId(){const e=(0,y.I)();return e==null?void 0:e.defaultScopeId}get selectedItem(){return this.findSelectedElement()}set selectedItem(e){const t=this.findSelectedElement();t&&(t.selected=!1),e&&(e.selected=!0,this.selectedItemChanged(e.item))}get page(){return b(this,f)}set page(e){!e||(v(this,f,e),this.pageTitle=e.title,this.scopeId=e.scopeId,this.scopeType=e.scopeType)}get groups(){return Array.from(this.querySelectorAll("command-palette-item-group"))}get visibleGroups(){return this.groups.filter(e=>!e.hidden)}get currentItems(){const e=this.items[this.query.path];return e?this.query.isBlank()?e.sort((t,s)=>s.priority-t.priority):e.sort((t,s)=>{const i=t.calculateScore(this.query.text);return s.calculateScore(this.query.text)-i||s.priority-t.priority}):[]}get firstItem(){const e=this.visibleGroups;if(e.length>0)return e[0].querySelector("command-palette-item")}get shouldSetDefaultSelection(){return this.tryDefaultSelection&&this.query.isPresent()}get isSelectedItemInvalid(){return!this.currentItems.some(e=>{var t;return e.id===((t=this.selectedItem)==null?void 0:t.itemId)})}updateSelectedItem(){this.isSelectedItemInvalid&&this.clearSelection(),this.setDefaultSelection()&&(this.selectedItem=this.firstItem)}setDefaultSelection(){const e=this.query.hasScope()||this.query.isPresent();return this.tryDefaultSelection&&e}clearSelection(){this.selectedItem=void 0}findSelectedElement(){return this.querySelector("command-palette-item[data-selected]")}findGroup(e){return this.groups.find(t=>t.groupId===e)}navigate(e){var t,s;this.tryDefaultSelection=!1;const i=e>0,r={behavior:"smooth",block:"nearest"};if(this.selectedItem){let n;if(i?n=(t=this.selectedItem)==null?void 0:t.nextElementSibling:n=(s=this.selectedItem)==null?void 0:s.previousElementSibling,n)this.selectedItem=n,this.selectedItem.scrollIntoView(r);else if(this.selectedItem){const o=this.visibleGroups[this.calculateIndex(e)];o.scrollIntoView(r),i?this.selectedItem=o.firstItem:this.selectedItem=o.lastItem}}else this.selectedItem=this.firstItem}calculateIndex(e){let t=this.visibleGroups.findIndex(r=>{var n;return r.groupId===((n=this.selectedItem)==null?void 0:n.item.group)});this.findGroup(u.O.topGroupId).firstItem===this.selectedItem&&(t=0);const s=t+e,i=this.visibleGroups.length;return(s%i+i)%i}async prefetch(){await this.fetchWithSpinner(this.prefetchedProviders.map(async e=>{!e.prefetch||await e.prefetch(this.query)}))}async fetchWithDebounce(e,t,s){return e instanceof D.j?e.element.fetchWithDebounce(t,s):e.fetch(t,s)}async fetch(e=this.providers,t={}){if(this.hidden)return;const i={...{isEmpty:!1},...t},r=this.query;await this.prefetch(),await this.fetchWithSpinner(e.map(async n=>{if(!n||!n.enabledFor(r))return;const o=await this.fetchWithDebounce(n,r,i.isEmpty);o&&(o.error&&this.fetchError(),o.octicons&&o.octicons.length>0&&this.cacheIcons(o.octicons,!0),o.results.length>0&&this.addItems(r,o.results),this.renderCurrentItems())})),this.itemsUpdated()}async fetchWithSpinner(e){this.requestsInProgress.push(e),this.loadingStateChanged(!0),await Promise.all(e),this.requestsInProgress.splice(this.requestsInProgress.indexOf(e),1),this.loadingStateChanged(this.requestsInProgress.length>0)}addItems(e,t){e.path in this.items||(this.items[e.path]=[]),this.items[e.path].push(...t)}cacheIcons(e,t=!1){for(const s of e)this.octicons[s.id]=s.svg;t&&this.dispatchEvent(new CustomEvent("command-palette-page-octicons-cached",{bubbles:!0,detail:{octicons:e}}))}buildGroups(e){const s=[u.O.topGroupId,u.O.defaultGroupId,...new Set(e.map(r=>r.group))].map(r=>`command-palette-item-group[data-group-id="${r}"]`).join(","),i=document.querySelectorAll(s);for(const r of i)this.querySelector(`command-palette-item-group[data-group-id="${r.groupId}"]`)||this.append(r.cloneNode(!0))}setGroupBorders(){if(this.visibleGroups.length>0){this.visibleGroups[0].classList.remove("border-top");for(const e of this.visibleGroups)this.visibleGroups.indexOf(e)===0?(e.classList.remove("border-top"),e.header&&(e.classList.remove("py-2"),e.classList.add("mb-2"),this.hasVisibleTip?e.classList.remove("mt-3"):e.classList.add("mt-3"))):(e.classList.add("border-top"),e.header&&(e.classList.remove("mb-2","mt-3"),e.classList.add("py-2")))}}createItemElementAndRender(e,t,s){const i=new T.F;return i.setItemAttributes(e),i.render(t,s),i}renderCurrentItems(){this.reset();const e=this.currentItems,t=[];if(e&&e.length>0){this.buildGroups(e);for(const s of e){if(t.indexOf(s.id)>=0)continue;const i=s.calculateScore(this.query.text)+s.priority;let r=s.group||u.O.defaultGroupId;e.indexOf(s)===0&&i>a.TopResultThreshold&&(r="top");const n=this.createItemElementAndRender(s,!1,this.query.text),o=this.querySelector(`command-palette-item-group[data-group-id="${r}"]`);if(!o.atLimitForScopeType(this.scopeType)){if(o.push(n),t.push(s.id),s.icon)if(s.icon.type==="octicon"){const g=this.octicons[s.icon.id],I=this.octicons["dash-color-fg-muted"];n.renderOcticon(g||I)}else s.icon.type==="avatar"&&n.renderAvatar(s.icon.url,s.icon.alt);else n.iconElement.hidden=!0;n.addEventListener("mousemove",g=>{var I;(g.movementX!==0||g.movementY!==0)&&((I=this.selectedItem)==null?void 0:I.itemId)!==n.itemId&&(this.tryDefaultSelection=!1,this.selectedItem=n)})}}this.shouldSetDefaultSelection&&(this.selectedItem=this.firstItem),this.recomputeStyles(),this.updateSelectedItem()}}recomputeStyles(){this.setGroupBorders(),this.setMaxHeight()}get maximumHeight(){const s=window.innerHeight*.5;return Math.min(s,475)}get innerContentHeight(){let e=0;for(const t of this.children){const s=t,i=getComputedStyle(s),r=parseInt(i.marginTop.replace("px",""),10),n=parseInt(i.marginBottom.replace("px",""),10),o=s.offsetHeight+r+n;s.offsetHeight>0&&(e+=o)}return e}setMaxHeight(){const t=this.maximumHeight*.9,s=Math.round(Math.min(this.maximumHeight,this.innerContentHeight));Math.abs(this.currentHeight-s)>t?this.classList.add("no-transition"):this.classList.remove("no-transition"),this.setAttribute("style",`max-height:${s}px; min-height:${s}px;`),this.currentHeight=s}selectedItemChanged(e){const t=new CustomEvent("selectedItemChanged",{bubbles:!0,cancelable:!0,detail:{item:e,isDefaultSelection:this.tryDefaultSelection}});return this.dispatchEvent(t)}loadingStateChanged(e){const t=new CustomEvent("loadingStateChanged",{bubbles:!0,cancelable:!0,detail:{loading:e}});return this.dispatchEvent(t)}fetchError(){const e=new CustomEvent("pageFetchError",{bubbles:!0,cancelable:!0});return this.dispatchEvent(e)}itemsUpdated(){const e=this.currentItems,t=e.filter(i=>i.group===u.O.footerGroupId||u.O.helpGroupIds.includes(i.group));if(e.length-t.length===0&&this.requestsInProgress.length>0)return;const s=new CustomEvent("itemsUpdated",{bubbles:!0,detail:{items:e,queryPath:this.query.immutableCopy().path}});return this.dispatchEvent(s)}reactivate(e){this.query=e,this.hidden=!1,this.tryDefaultSelection=!0,this.recomputeStyles(),this.fetch()}reset(){this.tryDefaultSelection=!0,this.innerHTML=""}connectedCallback(){this.classList.add("rounded-bottom-2","page-stack-transition-height"),this.getAttribute("data-targets")||this.setAttribute("data-targets","command-palette-page-stack.pages"),this.setAttribute("style","max-height:400px;"),this.page||(this.page=new P.j({title:this.pageTitle,scopeId:this.scopeId,scopeType:this.scopeType}))}clearItems(){this.items={},this.reset()}},"CommandPalettePageElement");p=new WeakMap,f=new WeakMap,a.TopResultThreshold=6.5,c([d.Lj],a.prototype,"isRoot",2),c([d.Lj],a.prototype,"pageTitle",2),c([d.Lj],a.prototype,"scopeId",2),c([d.Lj],a.prototype,"scopeType",2),c([d.Lj],a.prototype,"hasVisibleTip",2),c([(0,C.D)(10)],a.prototype,"renderCurrentItems",1),a=c([d.Ih],a)}}]);})();

//# sourceMappingURL=4656-3c28fe920ff2.js.map